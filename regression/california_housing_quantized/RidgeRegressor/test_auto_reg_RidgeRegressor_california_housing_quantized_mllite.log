       longitude  latitude  ...  ocean_proximity    target
0              1         8  ...                0  452600.0
1              1         7  ...                0  358500.0
2              1         7  ...                0  352100.0
3              1         7  ...                0  341300.0
4              1         7  ...                0  342200.0
...          ...       ...  ...              ...       ...
20635          3         9  ...                0   78100.0
20636          3         9  ...                0   77100.0
20637          3         9  ...                0   92300.0
20638          3         9  ...                0   84700.0
20639          3         9  ...                0   89400.0

[20640 rows x 10 columns]
MLLITE_MODEL_SET_OPTIONS RidgeRegressor None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeRegressor { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeRegressor { ,   , }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeRegressor None
('OPERATION_START', 'TRAINING')
[[ 1.  8.  8.  0.  0.  0.  0.  9.  0.]
 [ 1.  7.  3.  8.  8.  8.  8.  9.  0.]
 [ 1.  7. 10.  2.  1.  1.  1.  9.  0.]
 [ 1.  7. 10.  1.  1.  1.  1.  8.  0.]
 [ 1.  7. 10.  3.  2.  1.  2.  5.  0.]] [452600. 358500. 352100. 341300. 342200.]
MLLITE_FIT_USING_MODEL mllite_ridge_reg.RidgeRegressor_ff4_ff4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_REGRESSOR_FIT' 1 2
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_REGRESSOR_FIT' 2 2
('OPERATION_END_ELAPSED', 0.039, 'TRAINING')
{ ,   , }
{ ,   , }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W14", "signature" : "ff4_ff4"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 20640, "dataset_features" : 9 },
	"equations" : {
			"intercept" : 270145.000000,
			"coeffs" : [ -23239.255859, -23913.384766, 5888.641113, -489.675140, 10710.183594, -16661.726562, 8505.788086, 24954.556641, 0.000000 ]
		}
}
WRITING_JSON_CODE 'logs/auto_tests/regression/RidgeRegressor/mllite.RidgeRegressor_california_housing_quantized.json'

MLLITE_MODEL_SET_OPTIONS RidgeRegressor None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeRegressor { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeRegressor { ,   , }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeRegressor None
MLLITE_RELOADING_MODEL mllite_ridge_reg.RidgeRegressor_ff4_ff4
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W14", "signature" : "ff4_ff4"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 20640, "dataset_features" : 9 },
	"equations" : {
			"intercept" : 270145.000000,
			"coeffs" : [ -23239.255859, -23913.384766, 5888.641113, -489.675140, 10710.183594, -16661.726562, 8505.788086, 24954.556641, 0.000000 ]
		}
}
BEAUTIFIED_JSON_START
{
	"dataset" : 	{
		"dataset_features" : 9,
		"dataset_rows" : 20640
	},
	"equations" : 	{
		"coeffs" : [ -23239.255859, -23913.384766, 5888.641113, -489.67514, 10710.183594, -16661.726562, 8505.788086, 24954.556641, 0.0 ],
		"intercept" : 270145.0
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_ff4", "version" : "2024-W14" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
[327298.8   338285.56  364564.38  ...  40630.35   55014.547  64102.117]
('OPERATION_END_ELAPSED', 0.006, 'PREDICT')
('OPERATION_START', 'PREDICT')
[327298.8   338285.56  364564.38  ...  40630.35   55014.547  64102.117]
('OPERATION_END_ELAPSED', 0.005, 'PREDICT')
MODEL_PERFS {'class_name': 'mllite.RidgeRegressor', 'model_name': 'RidgeRegressor', 'options': None, 'dataset': 'california_housing_quantized', 'size': 20640, 'mse': 5802039300.0, 'mae': 57877.332, 'mape': 0.3370525, 'r2': 0.5642643746861667}
WRITING_PERF_CODE 'logs/auto_tests/regression/RidgeRegressor/mllite.RidgeRegressor_california_housing_quantized.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeRegressor', 'model_name': 'RidgeRegressor', 'options': None, 'dataset': 'california_housing_quantized', 'training_time_in_sec': 0.039, 'prediction_time_in_sec': 0.005}

MODEL_EXPLANATION_START
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 0 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 1 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 2 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 3 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 4 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 5 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 6 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 7 9
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_REGRESSION_EXPLAINER' 8 9
{
   "Contributions" : {
      "X_0" : [ 2504.351074 ],
      "X_1" : [ -5804.144531 ],
      "X_2" : [ 1224.202515 ],
      "X_3" : [ 422.108765 ],
      "X_4" : [ -8414.148438 ],
      "X_5" : [ 11359.990234 ],
      "X_6" : [ -7621.843262 ],
      "X_7" : [ -1200.589722 ],
      "X_8" : [ 0.000000 ]   
   },
   "Most_Contributive_Features" : {
      "y" : [ 5, 4, 6, 1, 0, 2, 7, 3 ]
   }
}
WRITING_EXPLAIN_CODE 'logs/auto_tests/regression/RidgeRegressor/mllite.RidgeRegressor_california_housing_quantized_explain.json'

MODEL_EXPLANATION_END
WRITING_SQL_CODE 'logs/auto_tests/regression/RidgeRegressor/mllite.RidgeRegressor_california_housing_quantized_duckdb.sql'



SQL_OUT_PUT_FIRST_LINES_START ('california_housing_quantized', 'RidgeRegressor', 'duckdb')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8"
  FROM "california_housing_quantized" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT
  t."index" AS "index",
   270145.000000 + -23239.255859 * t."X_0" + -23913.384766 * t."X_1" + 5888.641113 * t."X_2" + -489.675140 * t."X_3" + 10710.183594 * t."X_4" + -16661.726562 * t."X_5" + 8505.788086 * t."X_6" + 24954.556641 * t."X_7" + 0.000000 * t."X_8" AS "Estimator"
  FROM model_input AS t
 )
SELECT
  model_scores_cte."index" as "index",
  model_scores_cte."Estimator" as "Estimator"
FROM  model_scores_cte

SQL_OUT_PUT_FIRST_LINES_END ('california_housing_quantized', 'RidgeRegressor', 'duckdb')
SQL_OUT_PUT_LAST_LINES_START ('california_housing_quantized', 'RidgeRegressor', 'duckdb')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8"
  FROM "california_housing_quantized" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT
  t."index" AS "index",
   270145.000000 + -23239.255859 * t."X_0" + -23913.384766 * t."X_1" + 5888.641113 * t."X_2" + -489.675140 * t."X_3" + 10710.183594 * t."X_4" + -16661.726562 * t."X_5" + 8505.788086 * t."X_6" + 24954.556641 * t."X_7" + 0.000000 * t."X_8" AS "Estimator"
  FROM model_input AS t
 )
SELECT
  model_scores_cte."index" as "index",
  model_scores_cte."Estimator" as "Estimator"
FROM  model_scores_cte

SQL_OUT_PUT_LAST_LINES_END ('california_housing_quantized', 'RidgeRegressor', 'duckdb') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 20640 entries, 0 to 20639
Data columns (total 9 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     20640 non-null  float32
 1   X_1     20640 non-null  float32
 2   X_2     20640 non-null  float32
 3   X_3     20640 non-null  float32
 4   X_4     20640 non-null  float32
 5   X_5     20640 non-null  float32
 6   X_6     20640 non-null  float32
 7   X_7     20640 non-null  float32
 8   X_8     20640 non-null  float32
dtypes: float32(9)
memory usage: 886.9 KB
       X_0  X_1   X_2  X_3  X_4  X_5  X_6  X_7  X_8
index                                              
0      1.0  8.0   8.0  0.0  0.0  0.0  0.0  9.0  0.0
1      1.0  7.0   3.0  8.0  8.0  8.0  8.0  9.0  0.0
2      1.0  7.0  10.0  2.0  1.0  1.0  1.0  9.0  0.0
3      1.0  7.0  10.0  1.0  1.0  1.0  1.0  8.0  0.0
4      1.0  7.0  10.0  3.0  2.0  1.0  2.0  5.0  0.0
...    ...  ...   ...  ...  ...  ...  ...  ...  ...
20635  3.0  9.0   4.0  3.0  3.0  2.0  3.0  0.0  0.0
20636  3.0  9.0   2.0  0.0  0.0  0.0  0.0  2.0  0.0
20637  3.0  9.0   2.0  5.0  5.0  3.0  5.0  0.0  0.0
20638  3.0  9.0   2.0  4.0  4.0  2.0  3.0  1.0  0.0
20639  3.0  9.0   1.0  6.0  7.0  6.0  6.0  2.0  0.0

[20640 rows x 9 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 2 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   index      20640 non-null  int64  
 1   Estimator  20640 non-null  float64
dtypes: float64(1), int64(1)
memory usage: 322.6 KB
       index      Estimator
0          0  327298.812500
1          1  338285.562500
2          2  364564.375000
3          3  340099.500000
4          4  283472.437500
...      ...            ...
20635  20635   31616.765625
20636  20636   46893.160156
20637  20637   40630.351562
20638  20638   55014.546875
20639  20639   64102.117188

[20640 rows x 2 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Estimator'], dtype='object')
MLLITE_REG_SQL_L1_ERROR ('california_housing_quantized', 'RidgeRegressor') Estimator 0.0
       index  SQL_Estimator   Py_Estimator  SQL_Error
20624  20624   92837.796875   92837.796875        0.0
20625  20625  199393.843750  199393.843750        0.0
20626  20626   57469.656250   57469.656250        0.0
20627  20627   60070.437500   60070.437500        0.0
20628  20628   78390.687500   78390.687500        0.0
20629  20629   52297.023438   52297.023438        0.0
20630  20630  119812.718750  119812.718750        0.0
20631  20631  123986.062500  123986.062500        0.0
20632  20632   96966.937500   96966.937500        0.0
20633  20633   90167.968750   90167.968750        0.0
20634  20634  156036.171875  156036.171875        0.0
20635  20635   31616.765625   31616.765625        0.0
20636  20636   46893.160156   46893.160156        0.0
20637  20637   40630.351562   40630.351562        0.0
20638  20638   55014.546875   55014.546875        0.0
20639  20639   64102.117188   64102.117188        0.0
MLLITE_REG_SQL_EXECUTION_STATUS ('california_housing_quantized', 'RidgeRegressor', 'Success')
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/regression/RidgeRegressor/mllite.RidgeRegressor_california_housing_quantized_sqlite.sql'



SQL_OUT_PUT_FIRST_LINES_START ('california_housing_quantized', 'RidgeRegressor', 'sqlite')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8"
  FROM "california_housing_quantized" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT
  t."index" AS "index",
   270145.000000 + -23239.255859 * t."X_0" + -23913.384766 * t."X_1" + 5888.641113 * t."X_2" + -489.675140 * t."X_3" + 10710.183594 * t."X_4" + -16661.726562 * t."X_5" + 8505.788086 * t."X_6" + 24954.556641 * t."X_7" + 0.000000 * t."X_8" AS "Estimator"
  FROM model_input AS t
 )
SELECT
  model_scores_cte."index" as "index",
  model_scores_cte."Estimator" as "Estimator"
FROM  model_scores_cte

SQL_OUT_PUT_FIRST_LINES_END ('california_housing_quantized', 'RidgeRegressor', 'sqlite')
SQL_OUT_PUT_LAST_LINES_START ('california_housing_quantized', 'RidgeRegressor', 'sqlite')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8"
  FROM "california_housing_quantized" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT
  t."index" AS "index",
   270145.000000 + -23239.255859 * t."X_0" + -23913.384766 * t."X_1" + 5888.641113 * t."X_2" + -489.675140 * t."X_3" + 10710.183594 * t."X_4" + -16661.726562 * t."X_5" + 8505.788086 * t."X_6" + 24954.556641 * t."X_7" + 0.000000 * t."X_8" AS "Estimator"
  FROM model_input AS t
 )
SELECT
  model_scores_cte."index" as "index",
  model_scores_cte."Estimator" as "Estimator"
FROM  model_scores_cte

SQL_OUT_PUT_LAST_LINES_END ('california_housing_quantized', 'RidgeRegressor', 'sqlite') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 20640 entries, 0 to 20639
Data columns (total 9 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     20640 non-null  float32
 1   X_1     20640 non-null  float32
 2   X_2     20640 non-null  float32
 3   X_3     20640 non-null  float32
 4   X_4     20640 non-null  float32
 5   X_5     20640 non-null  float32
 6   X_6     20640 non-null  float32
 7   X_7     20640 non-null  float32
 8   X_8     20640 non-null  float32
dtypes: float32(9)
memory usage: 886.9 KB
       X_0  X_1   X_2  X_3  X_4  X_5  X_6  X_7  X_8
index                                              
0      1.0  8.0   8.0  0.0  0.0  0.0  0.0  9.0  0.0
1      1.0  7.0   3.0  8.0  8.0  8.0  8.0  9.0  0.0
2      1.0  7.0  10.0  2.0  1.0  1.0  1.0  9.0  0.0
3      1.0  7.0  10.0  1.0  1.0  1.0  1.0  8.0  0.0
4      1.0  7.0  10.0  3.0  2.0  1.0  2.0  5.0  0.0
...    ...  ...   ...  ...  ...  ...  ...  ...  ...
20635  3.0  9.0   4.0  3.0  3.0  2.0  3.0  0.0  0.0
20636  3.0  9.0   2.0  0.0  0.0  0.0  0.0  2.0  0.0
20637  3.0  9.0   2.0  5.0  5.0  3.0  5.0  0.0  0.0
20638  3.0  9.0   2.0  4.0  4.0  2.0  3.0  1.0  0.0
20639  3.0  9.0   1.0  6.0  7.0  6.0  6.0  2.0  0.0

[20640 rows x 9 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 2 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   index      20640 non-null  int64  
 1   Estimator  20640 non-null  float64
dtypes: float64(1), int64(1)
memory usage: 322.6 KB
       index      Estimator
0          0  327298.804686
1          1  338285.543711
2          2  364564.366516
3          3  340099.485015
4          4  283472.436492
...      ...            ...
20635  20635   31616.770477
20636  20636   46893.165037
20637  20637   40630.354769
20638  20638   55014.553346
20639  20639   64102.127386

[20640 rows x 2 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Estimator'], dtype='object')
MLLITE_REG_SQL_L1_ERROR ('california_housing_quantized', 'RidgeRegressor') Estimator 0.009014213423656145
       index  SQL_Estimator   Py_Estimator  SQL_Error
20624  20624   92837.801240   92837.796875   0.004365
20625  20625  199393.853025  199393.843750   0.009275
20626  20626   57469.668118   57469.656250   0.011868
20627  20627   60070.439452   60070.437500   0.001952
20628  20628   78390.700808   78390.687500   0.013308
20629  20629   52297.020424   52297.023438  -0.003013
20630  20630  119812.727484  119812.718750   0.008734
20631  20631  123986.067815  123986.062500   0.005315
20632  20632   96966.941196   96966.937500   0.003696
20633  20633   90167.983034   90167.968750   0.014284
20634  20634  156036.189731  156036.171875   0.017856
20635  20635   31616.770477   31616.765625   0.004852
20636  20636   46893.165037   46893.160156   0.004881
20637  20637   40630.354769   40630.351562   0.003206
20638  20638   55014.553346   55014.546875   0.006471
20639  20639   64102.127386   64102.117188   0.010198
MLLITE_REG_SQL_EXECUTION_STATUS ('california_housing_quantized', 'RidgeRegressor', 'Success')
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
