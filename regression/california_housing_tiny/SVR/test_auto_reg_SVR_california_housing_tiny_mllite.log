    longitude  latitude  ...  ocean_proximity    target
0     -121.91     36.63  ...              0.0  279200.0
1     -121.43     38.66  ...              0.0   81100.0
2     -121.58     39.50  ...              0.0   57600.0
3     -120.24     39.35  ...              0.0  180800.0
4     -122.02     38.37  ...              0.0  198000.0
5     -122.01     37.18  ...              0.0  318700.0
6     -117.70     33.50  ...              0.0  245400.0
7     -117.41     33.96  ...              0.0  112700.0
8     -122.45     37.67  ...              0.0  246400.0
9     -122.73     38.44  ...              0.0  145000.0
10    -121.92     37.48  ...              0.0  264400.0
11    -122.44     37.78  ...              0.0  346200.0
12    -118.29     33.93  ...              0.0  111200.0
13    -121.79     38.00  ...              0.0  124700.0
14    -116.96     33.73  ...              0.0   87000.0
15    -121.31     38.26  ...              0.0   88300.0

[16 rows x 10 columns]
MLLITE_MODEL_SET_OPTIONS SVR None
MLLITE_MODEL_OPTIONS_DEFAULT SVR { "max_iter" : 128 }
MLLITE_MODEL_OPTIONS_AFTER_SETTING SVR { ,  "max_iter" : 128  , }
MLLITE_MODEL_JSON_AFTER_SETTING SVR None
('OPERATION_START', 'TRAINING')
[[-1.2191e+02  3.6630e+01  4.2000e+01  8.1700e+02  1.9400e+02  3.9100e+02
   1.9300e+02  2.1776e+00  0.0000e+00]
 [-1.2143e+02  3.8660e+01  3.5000e+01  1.8140e+03  3.6700e+02  1.0760e+03
   3.7200e+02  2.7179e+00  0.0000e+00]
 [-1.2158e+02  3.9500e+01  2.9000e+01  1.9470e+03  3.8300e+02  9.2500e+02
   3.3700e+02  2.1658e+00  0.0000e+00]
 [-1.2024e+02  3.9350e+01  8.0000e+00  4.1950e+03  7.2500e+02  2.9100e+02
   1.1500e+02  3.4792e+00  0.0000e+00]
 [-1.2202e+02  3.8370e+01  1.6000e+01  2.4950e+03  3.3100e+02  1.1180e+03
   3.3800e+02  6.4894e+00  0.0000e+00]] [279200.  81100.  57600. 180800. 198000.]
MLLITE_FIT_USING_MODEL mllite_svm_reg.SVR_ff4_ff4
PROGRESS_REPORT_ELAPSED_TOTAL 'SVM_REGRESSOR_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'SVM_REGRESSOR_FIT' 2 4
PROGRESS_REPORT_ELAPSED_TOTAL 'SVM_REGRESSOR_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'SVM_REGRESSOR_FIT' 4 4
('OPERATION_END_ELAPSED', 0.006, 'TRAINING')
{ ,  "max_iter" : 128  , }
{ ,  "max_iter" : 128  , }
{
	"metadata" : { "model" : "Vapnik_SVR_RBF", "version" : "2024-W12", "signature" : "ff4_ff4"},
	"options" : {"svm_type" : "epsilon_svr", "kernel" : "rbf", "degree" : 3, "gamma" : 0.000000, "coef0" : 0.000000, "cache_size" : 300, "tol" : 0.001000, "nu" : 0.500000, "epsilon" : 0.100000, "shrinking" : 0, "probability" : 0, "C" : 1.000000, "max_iter" : 128, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 16, "dataset_features" : 9 },
	"svm_model" : {
	"classes" : 2,
	"L" : 16,
	"SupportVectors" : {
		"SV_00" : [ -121.910004, 36.630001, 42.000000, 817.000000, 194.000000, 391.000000, 193.000000, 2.177600, 0.000000 ],
		"SV_01" : [ -121.430000, 38.660000, 35.000000, 1814.000000, 367.000000, 1076.000000, 372.000000, 2.717900, 0.000000 ],
		"SV_02" : [ -121.580002, 39.500000, 29.000000, 1947.000000, 383.000000, 925.000000, 337.000000, 2.165800, 0.000000 ],
		"SV_03" : [ -120.239998, 39.349998, 8.000000, 4195.000000, 725.000000, 291.000000, 115.000000, 3.479200, 0.000000 ],
		"SV_04" : [ -122.019997, 38.369999, 16.000000, 2495.000000, 331.000000, 1118.000000, 338.000000, 6.489400, 0.000000 ],
		"SV_05" : [ -122.010002, 37.180000, 37.000000, 3852.000000, 652.000000, 1534.000000, 567.000000, 5.859600, 0.000000 ],
		"SV_06" : [ -117.699997, 33.500000, 4.000000, 2351.000000, 445.000000, 834.000000, 397.000000, 5.567700, 0.000000 ],
		"SV_07" : [ -117.410004, 33.959999, 27.000000, 2341.000000, 418.000000, 1272.000000, 415.000000, 3.020800, 0.000000 ],
		"SV_08" : [ -122.449997, 37.669998, 36.000000, 1664.000000, 326.000000, 963.000000, 322.000000, 4.781300, 0.000000 ],
		"SV_09" : [ -122.730003, 38.439999, 35.000000, 1120.000000, 297.000000, 659.000000, 274.000000, 2.382400, 0.000000 ],
		"SV_10" : [ -121.919998, 37.480000, 23.000000, 4314.000000, 676.000000, 1972.000000, 623.000000, 5.381300, 0.000000 ],
		"SV_11" : [ -122.440002, 37.779999, 52.000000, 1118.000000, 279.000000, 514.000000, 284.000000, 2.419600, 0.000000 ],
		"SV_12" : [ -118.290001, 33.930000, 32.000000, 1815.000000, 488.000000, 1715.000000, 475.000000, 1.724400, 0.000000 ],
		"SV_13" : [ -121.790001, 38.000000, 34.000000, 3090.000000, 593.000000, 1588.000000, 566.000000, 3.611800, 0.000000 ],
		"SV_14" : [ -116.959999, 33.730000, 20.000000, 4735.000000, 973.000000, 2306.000000, 904.000000, 3.069000, 0.000000 ],
		"SV_15" : [ -121.309998, 38.259998, 22.000000, 1768.000000, 396.000000, 1005.000000, 420.000000, 1.884600, 0.000000 ]
	},
	"SupportVectorsCoefs" : {
		"SV_coef_0" : [ 1.000000, -1.000000, -1.000000, 1.000000, 1.000000, 1.000000, 1.000000, -1.000000, 1.000000, -1.000000, 1.000000, 1.000000, -1.000000, -1.000000, -1.000000, -1.000000 ]
	},
	"rho" : [ -162899.875000 ],
	"nSV" : [ 16 ],
	"probA" : [ ],
	"probB" : [ ],
	"n_iter" : [ 8 ]
}
}
WRITING_JSON_CODE 'logs/auto_tests/regression/SVR/mllite.SVR_california_housing_tiny.json'

MLLITE_MODEL_SET_OPTIONS SVR None
MLLITE_MODEL_OPTIONS_DEFAULT SVR { "max_iter" : 128 }
MLLITE_MODEL_OPTIONS_AFTER_SETTING SVR { ,  "max_iter" : 128  , }
MLLITE_MODEL_JSON_AFTER_SETTING SVR None
MLLITE_RELOADING_MODEL mllite_svm_reg.SVR_ff4_ff4
{
	"metadata" : { "model" : "Vapnik_SVR_RBF", "version" : "2024-W12", "signature" : "ff4_ff4"},
	"options" : {"svm_type" : "epsilon_svr", "kernel" : "rbf", "degree" : 3, "gamma" : 0.000000, "coef0" : 0.000000, "cache_size" : 300, "tol" : 0.001000, "nu" : 0.500000, "epsilon" : 0.100000, "shrinking" : 0, "probability" : 0, "C" : 1.000000, "max_iter" : 128, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 16, "dataset_features" : 9 },
	"svm_model" : {
	"classes" : 2,
	"L" : 16,
	"SupportVectors" : {
		"SV_00" : [ -121.910004, 36.630001, 42.000000, 817.000000, 194.000000, 391.000000, 193.000000, 2.177600, 0.000000 ],
		"SV_01" : [ -121.430000, 38.660000, 35.000000, 1814.000000, 367.000000, 1076.000000, 372.000000, 2.717900, 0.000000 ],
		"SV_02" : [ -121.580002, 39.500000, 29.000000, 1947.000000, 383.000000, 925.000000, 337.000000, 2.165800, 0.000000 ],
		"SV_03" : [ -120.239998, 39.349998, 8.000000, 4195.000000, 725.000000, 291.000000, 115.000000, 3.479200, 0.000000 ],
		"SV_04" : [ -122.019997, 38.369999, 16.000000, 2495.000000, 331.000000, 1118.000000, 338.000000, 6.489400, 0.000000 ],
		"SV_05" : [ -122.010002, 37.180000, 37.000000, 3852.000000, 652.000000, 1534.000000, 567.000000, 5.859600, 0.000000 ],
		"SV_06" : [ -117.699997, 33.500000, 4.000000, 2351.000000, 445.000000, 834.000000, 397.000000, 5.567700, 0.000000 ],
		"SV_07" : [ -117.410004, 33.959999, 27.000000, 2341.000000, 418.000000, 1272.000000, 415.000000, 3.020800, 0.000000 ],
		"SV_08" : [ -122.449997, 37.669998, 36.000000, 1664.000000, 326.000000, 963.000000, 322.000000, 4.781300, 0.000000 ],
		"SV_09" : [ -122.730003, 38.439999, 35.000000, 1120.000000, 297.000000, 659.000000, 274.000000, 2.382400, 0.000000 ],
		"SV_10" : [ -121.919998, 37.480000, 23.000000, 4314.000000, 676.000000, 1972.000000, 623.000000, 5.381300, 0.000000 ],
		"SV_11" : [ -122.440002, 37.779999, 52.000000, 1118.000000, 279.000000, 514.000000, 284.000000, 2.419600, 0.000000 ],
		"SV_12" : [ -118.290001, 33.930000, 32.000000, 1815.000000, 488.000000, 1715.000000, 475.000000, 1.724400, 0.000000 ],
		"SV_13" : [ -121.790001, 38.000000, 34.000000, 3090.000000, 593.000000, 1588.000000, 566.000000, 3.611800, 0.000000 ],
		"SV_14" : [ -116.959999, 33.730000, 20.000000, 4735.000000, 973.000000, 2306.000000, 904.000000, 3.069000, 0.000000 ],
		"SV_15" : [ -121.309998, 38.259998, 22.000000, 1768.000000, 396.000000, 1005.000000, 420.000000, 1.884600, 0.000000 ]
	},
	"SupportVectorsCoefs" : {
		"SV_coef_0" : [ 1.000000, -1.000000, -1.000000, 1.000000, 1.000000, 1.000000, 1.000000, -1.000000, 1.000000, -1.000000, 1.000000, 1.000000, -1.000000, -1.000000, -1.000000, -1.000000 ]
	},
	"rho" : [ -162899.875000 ],
	"nSV" : [ 16 ],
	"probA" : [ ],
	"probB" : [ ],
	"n_iter" : [ 8 ]
}
}
BEAUTIFIED_JSON_START
{
	"dataset" : 	{
		"dataset_features" : 9,
		"dataset_rows" : 16
	},
	"metadata" :  { "model" : "Vapnik_SVR_RBF", "signature" : "ff4_ff4", "version" : "2024-W12" },
	"options" :  { "C" : 1.0, "cache_size" : 300, "coef0" : 0.0, "degree" : 3, "epsilon" : 0.1, "gamma" : 0.0, "kernel" : "rbf", "max_iter" : 128, "nu" : 0.5, "probability" : 0, "random_state" : 1789, "shrinking" : 0, "svm_type" : "epsilon_svr", "tol" : 0.001 },
	"svm_model" : 	{
		"L" : 16,
		"SupportVectors" : 	{
			"SV_00" : [ -121.910004, 36.630001, 42.0, 817.0, 194.0, 391.0, 193.0, 2.1776, 0.0 ],
			"SV_01" : [ -121.43, 38.66, 35.0, 1814.0, 367.0, 1076.0, 372.0, 2.7179, 0.0 ],
			"SV_02" : [ -121.580002, 39.5, 29.0, 1947.0, 383.0, 925.0, 337.0, 2.1658, 0.0 ],
			"SV_03" : [ -120.239998, 39.349998, 8.0, 4195.0, 725.0, 291.0, 115.0, 3.4792, 0.0 ],
			"SV_04" : [ -122.019997, 38.369999, 16.0, 2495.0, 331.0, 1118.0, 338.0, 6.4894, 0.0 ],
			"SV_05" : [ -122.010002, 37.18, 37.0, 3852.0, 652.0, 1534.0, 567.0, 5.8596, 0.0 ],
			"SV_06" : [ -117.699997, 33.5, 4.0, 2351.0, 445.0, 834.0, 397.0, 5.5677, 0.0 ],
			"SV_07" : [ -117.410004, 33.959999, 27.0, 2341.0, 418.0, 1272.0, 415.0, 3.0208, 0.0 ],
			"SV_08" : [ -122.449997, 37.669998, 36.0, 1664.0, 326.0, 963.0, 322.0, 4.7813, 0.0 ],
			"SV_09" : [ -122.730003, 38.439999, 35.0, 1120.0, 297.0, 659.0, 274.0, 2.3824, 0.0 ],
			"SV_10" : [ -121.919998, 37.48, 23.0, 4314.0, 676.0, 1972.0, 623.0, 5.3813, 0.0 ],
			"SV_11" : [ -122.440002, 37.779999, 52.0, 1118.0, 279.0, 514.0, 284.0, 2.4196, 0.0 ],
			"SV_12" : [ -118.290001, 33.93, 32.0, 1815.0, 488.0, 1715.0, 475.0, 1.7244, 0.0 ],
			"SV_13" : [ -121.790001, 38.0, 34.0, 3090.0, 593.0, 1588.0, 566.0, 3.6118, 0.0 ],
			"SV_14" : [ -116.959999, 33.73, 20.0, 4735.0, 973.0, 2306.0, 904.0, 3.069, 0.0 ],
			"SV_15" : [ -121.309998, 38.259998, 22.0, 1768.0, 396.0, 1005.0, 420.0, 1.8846, 0.0 ]
		},
		"SupportVectorsCoefs" : 	{
			"SV_coef_0" : [ 1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0 ]
		},
		"classes" : 2,
		"nSV" : [ 16 ],
		"n_iter" : [ 8 ],
		"probA" : [  ],
		"probB" : [  ],
		"rho" : [ -162899.875 ]
	}
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
[162899.4  162899.   162899.12 162900.77 162899.3  162900.08 162899.36
 162899.11 162899.03 162899.2  162900.14 162899.28 162898.7  162899.47
 162900.1  162899.02]
('OPERATION_END_ELAPSED', 0.001, 'PREDICT')
('OPERATION_START', 'PREDICT')
[162899.88 162899.88 162899.88 162899.88 162899.88 162899.88 162899.88
 162899.88 162899.88 162899.88 162899.88 162899.88 162899.88 162899.88
 162899.88 162899.88]
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
MODEL_PERFS {'class_name': 'mllite.SVR', 'model_name': 'SVR', 'options': None, 'dataset': 'california_housing_tiny', 'size': 16, 'mse': 8319321000.0, 'mae': 79468.52, 'mape': 0.5415127, 'r2': -0.03830279377195178}
WRITING_PERF_CODE 'logs/auto_tests/regression/SVR/mllite.SVR_california_housing_tiny.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.SVR', 'model_name': 'SVR', 'options': None, 'dataset': 'california_housing_tiny', 'training_time_in_sec': 0.006, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/regression/SVR/mllite.SVR_california_housing_tiny.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 )
,"SV_data" AS
 ( SELECT 
   "Values"."sv_idx" AS "sv_idx",
   "Values"."coeff" AS "coeff",
   "Values"."sv_0" AS "sv_0",
   "Values"."sv_1" AS "sv_1",
   "Values"."sv_2" AS "sv_2",
   "Values"."sv_3" AS "sv_3",
   "Values"."sv_4" AS "sv_4",
   "Values"."sv_5" AS "sv_5",
   "Values"."sv_6" AS "sv_6",
   "Values"."sv_7" AS "sv_7",
   "Values"."sv_8" AS "sv_8"
  FROM
  (
     SELECT 0 AS "sv_idx", 1.000000 AS "coeff", -121.910004 AS "sv_0", 36.630001 AS "sv_1", 42.000000 AS "sv_2", 817.000000 AS "sv_3", 194.000000 AS "sv_4", 391.000000 AS "sv_5", 193.000000 AS "sv_6", 2.177600 AS "sv_7",
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
d" AS
 ( SELECT
    dp."index" as "index",
    dp."dot_product" AS "Estimator"
   FROM
    (SELECT
      full_join_data_sv."index" AS "index",
      sum(CAST(full_join_data_sv.dot_prod AS FLOAT)) - -162899.875000 AS dot_product
     FROM
       (SELECT
          model_input."index" AS "index",
          "SV_data"."coeff" *  exp(min(max(-32.0, -0.000000 * (power(model_input."X_0" - "SV_data".sv_0, 2) + power(model_input."X_1" - "SV_data".sv_1, 2) + power(model_input."X_2" - "SV_data".sv_2, 2) + power(model_input."X_3" - "SV_data".sv_3, 2) + power(model_input."X_4" - "SV_data".sv_4, 2) + power(model_input."X_5" - "SV_data".sv_5, 2) + power(model_input."X_6" - "SV_data".sv_6, 2) + power(model_input."X_7" - "SV_data".sv_7, 2) + power(model_input."X_8" - "SV_data".sv_8, 2))), 32.0))  AS "dot_prod" 
        FROM
          model_input, "SV_data"
       ) AS full_join_data_sv
     GROUP BY full_join_data_sv."index"
    ) AS dp )
SELECT
  t."index" as "index",
  t."Estimator" as "Estimator"
FROM "Kernel_DotProd" AS t

SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 16 entries, 0 to 15
Data columns (total 9 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     16 non-null     float32
 1   X_1     16 non-null     float32
 2   X_2     16 non-null     float32
 3   X_3     16 non-null     float32
 4   X_4     16 non-null     float32
 5   X_5     16 non-null     float32
 6   X_6     16 non-null     float32
 7   X_7     16 non-null     float32
 8   X_8     16 non-null     float32
dtypes: float32(9)
memory usage: 704.0 bytes
              X_0        X_1   X_2     X_3    X_4     X_5    X_6     X_7  X_8
index                                                                        
0     -121.910004  36.630001  42.0   817.0  194.0   391.0  193.0  2.1776  0.0
1     -121.430000  38.660000  35.0  1814.0  367.0  1076.0  372.0  2.7179  0.0
2     -121.580002  39.500000  29.0  1947.0  383.0   925.0  337.0  2.1658  0.0
3     -120.239998  39.349998   8.0  4195.0  725.0   291.0  115.0  3.4792  0.0
4     -122.019997  38.369999  16.0  2495.0  331.0  1118.0  338.0  6.4894  0.0
5     -122.010002  37.180000  37.0  3852.0  652.0  1534.0  567.0  5.8596  0.0
6     -117.699997  33.500000   4.0  2351.0  445.0   834.0  397.0  5.5677  0.0
7     -117.410004  33.959999  27.0  2341.0  418.0  1272.0  415.0  3.0208  0.0
8     -122.449997  37.669998  36.0  1664.0  326.0   963.0  322.0  4.7813  0.0
9     -122.730003  38.439999  35.0  1120.0  297.0   659.0  274.0  2.3824  0.0
10    -121.919998  37.480000  23.0  4314.0  676.0  1972.0  623.0  5.3813  0.0
11    -122.440002  37.779999  52.0  1118.0  279.0   514.0  284.0  2.4196  0.0
12    -118.290001  33.930000  32.0  1815.0  488.0  1715.0  475.0  1.7244  0.0
13    -121.790001  38.000000  34.0  3090.0  593.0  1588.0  566.0  3.6118  0.0
14    -116.959999  33.730000  20.0  4735.0  973.0  2306.0  904.0  3.0690  0.0
15    -121.309998  38.259998  22.0  1768.0  396.0  1005.0  420.0  1.8846  0.0
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 16 entries, 0 to 15
Data columns (total 2 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   index      16 non-null     int64  
 1   Estimator  16 non-null     float64
dtypes: float64(1), int64(1)
memory usage: 388.0 bytes
    index   Estimator
0       0  162899.875
1       1  162899.875
2       2  162899.875
3       3  162899.875
4       4  162899.875
5       5  162899.875
6       6  162899.875
7       7  162899.875
8       8  162899.875
9       9  162899.875
10     10  162899.875
11     11  162899.875
12     12  162899.875
13     13  162899.875
14     14  162899.875
15     15  162899.875
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Estimator'], dtype='object')
    index  SQL_Estimator   Py_Estimator
0       0     162899.875  162899.406250
1       1     162899.875  162899.000000
2       2     162899.875  162899.125000
3       3     162899.875  162900.765625
4       4     162899.875  162899.296875
5       5     162899.875  162900.078125
6       6     162899.875  162899.359375
7       7     162899.875  162899.109375
8       8     162899.875  162899.031250
9       9     162899.875  162899.203125
10     10     162899.875  162900.140625
11     11     162899.875  162899.281250
12     12     162899.875  162898.703125
13     13     162899.875  162899.468750
14     14     162899.875  162900.093750
15     15     162899.875  162899.015625
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
