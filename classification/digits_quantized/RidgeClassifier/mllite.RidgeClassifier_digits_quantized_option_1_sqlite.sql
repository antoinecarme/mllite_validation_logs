WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9", CAST("ADS"."X_10" AS FLOAT) AS "X_10", CAST("ADS"."X_11" AS FLOAT) AS "X_11", CAST("ADS"."X_12" AS FLOAT) AS "X_12", CAST("ADS"."X_13" AS FLOAT) AS "X_13", CAST("ADS"."X_14" AS FLOAT) AS "X_14", CAST("ADS"."X_15" AS FLOAT) AS "X_15", CAST("ADS"."X_16" AS FLOAT) AS "X_16", CAST("ADS"."X_17" AS FLOAT) AS "X_17", CAST("ADS"."X_18" AS FLOAT) AS "X_18", CAST("ADS"."X_19" AS FLOAT) AS "X_19", CAST("ADS"."X_20" AS FLOAT) AS "X_20", CAST("ADS"."X_21" AS FLOAT) AS "X_21", CAST("ADS"."X_22" AS FLOAT) AS "X_22", CAST("ADS"."X_23" AS FLOAT) AS "X_23", CAST("ADS"."X_24" AS FLOAT) AS "X_24", CAST("ADS"."X_25" AS FLOAT) AS "X_25", CAST("ADS"."X_26" AS FLOAT) AS "X_26", CAST("ADS"."X_27" AS FLOAT) AS "X_27", CAST("ADS"."X_28" AS FLOAT) AS "X_28", CAST("ADS"."X_29" AS FLOAT) AS "X_29", CAST("ADS"."X_30" AS FLOAT) AS "X_30", CAST("ADS"."X_31" AS FLOAT) AS "X_31", CAST("ADS"."X_32" AS FLOAT) AS "X_32", CAST("ADS"."X_33" AS FLOAT) AS "X_33", CAST("ADS"."X_34" AS FLOAT) AS "X_34", CAST("ADS"."X_35" AS FLOAT) AS "X_35", CAST("ADS"."X_36" AS FLOAT) AS "X_36", CAST("ADS"."X_37" AS FLOAT) AS "X_37", CAST("ADS"."X_38" AS FLOAT) AS "X_38", CAST("ADS"."X_39" AS FLOAT) AS "X_39", CAST("ADS"."X_40" AS FLOAT) AS "X_40", CAST("ADS"."X_41" AS FLOAT) AS "X_41", CAST("ADS"."X_42" AS FLOAT) AS "X_42", CAST("ADS"."X_43" AS FLOAT) AS "X_43", CAST("ADS"."X_44" AS FLOAT) AS "X_44", CAST("ADS"."X_45" AS FLOAT) AS "X_45", CAST("ADS"."X_46" AS FLOAT) AS "X_46", CAST("ADS"."X_47" AS FLOAT) AS "X_47", CAST("ADS"."X_48" AS FLOAT) AS "X_48", CAST("ADS"."X_49" AS FLOAT) AS "X_49", CAST("ADS"."X_50" AS FLOAT) AS "X_50", CAST("ADS"."X_51" AS FLOAT) AS "X_51", CAST("ADS"."X_52" AS FLOAT) AS "X_52", CAST("ADS"."X_53" AS FLOAT) AS "X_53", CAST("ADS"."X_54" AS FLOAT) AS "X_54", CAST("ADS"."X_55" AS FLOAT) AS "X_55", CAST("ADS"."X_56" AS FLOAT) AS "X_56", CAST("ADS"."X_57" AS FLOAT) AS "X_57", CAST("ADS"."X_58" AS FLOAT) AS "X_58", CAST("ADS"."X_59" AS FLOAT) AS "X_59", CAST("ADS"."X_60" AS FLOAT) AS "X_60", CAST("ADS"."X_61" AS FLOAT) AS "X_61", CAST("ADS"."X_62" AS FLOAT) AS "X_62", CAST("ADS"."X_63" AS FLOAT) AS "X_63"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -6.282175 + 0.000000 * t."X_0" + -0.057921 * t."X_1" + 0.090951 * t."X_2" + -0.068693 * t."X_3" + 0.050642 * t."X_4" + 0.027481 * t."X_5" + -0.117448 * t."X_6" + 0.279948 * t."X_7" + -0.342737 * t."X_8" + -0.252907 * t."X_9" + 0.002172 * t."X_10" + -0.097190 * t."X_11" + 0.098254 * t."X_12" + -0.009747 * t."X_13" + 0.049870 * t."X_14" + 0.045221 * t."X_15" + 0.310307 * t."X_16" + 0.193322 * t."X_17" + -0.308649 * t."X_18" + 0.195843 * t."X_19" + 0.067870 * t."X_20" + 0.041922 * t."X_21" + 0.028797 * t."X_22" + -0.035589 * t."X_23" + -0.494370 * t."X_24" + 1.117070 * t."X_25" + -0.834127 * t."X_26" + 0.454351 * t."X_27" + -0.170156 * t."X_28" + 0.143217 * t."X_29" + -0.061117 * t."X_30" + -0.253699 * t."X_31" + 0.000000 * t."X_32" + 1.117123 * t."X_33" + -0.824433 * t."X_34" + 0.425208 * t."X_35" + -0.121046 * t."X_36" + 0.226332 * t."X_37" + -0.204320 * t."X_38" + 0.000000 * t."X_39" + 0.105540 * t."X_40" + -0.837974 * t."X_41" + 1.175140 * t."X_42" + -1.093832 * t."X_43" + 0.545509 * t."X_44" + -0.173944 * t."X_45" + 0.164368 * t."X_46" + 0.307374 * t."X_47" + 0.085588 * t."X_48" + 0.013200 * t."X_49" + 0.005415 * t."X_50" + 0.452766 * t."X_51" + -0.247898 * t."X_52" + -0.091431 * t."X_53" + 0.142924 * t."X_54" + 0.125892 * t."X_55" + 0.937624 * t."X_56" + 0.202429 * t."X_57" + 0.104744 * t."X_58" + 0.102014 * t."X_59" + 0.016262 * t."X_60" + -0.199229 * t."X_61" + 0.022944 * t."X_62" + 0.036877 * t."X_63" AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.543952 + 0.000000 * t."X_0" + 0.103196 * t."X_1" + 0.318924 * t."X_2" + 0.132978 * t."X_3" + -0.054325 * t."X_4" + 0.061790 * t."X_5" + 0.001763 * t."X_6" + -0.037949 * t."X_7" + 0.398188 * t."X_8" + -0.525368 * t."X_9" + 0.501172 * t."X_10" + -0.031586 * t."X_11" + -0.113954 * t."X_12" + 0.123029 * t."X_13" + -0.093096 * t."X_14" + 0.026501 * t."X_15" + -0.198910 * t."X_16" + -0.297620 * t."X_17" + 0.051883 * t."X_18" + -0.129484 * t."X_19" + 0.106056 * t."X_20" + 0.040302 * t."X_21" + 0.057477 * t."X_22" + 0.088514 * t."X_23" + 0.519966 * t."X_24" + 0.049175 * t."X_25" + 0.114929 * t."X_26" + 0.030350 * t."X_27" + -0.108486 * t."X_28" + -0.117737 * t."X_29" + -0.068014 * t."X_30" + 0.113453 * t."X_31" + 0.000000 * t."X_32" + -0.334907 * t."X_33" + 0.123510 * t."X_34" + -0.118489 * t."X_35" + 0.017431 * t."X_36" + -0.026077 * t."X_37" + 0.044893 * t."X_38" + 0.000000 * t."X_39" + -0.112908 * t."X_40" + 0.200967 * t."X_41" + -0.310066 * t."X_42" + 0.341905 * t."X_43" + -0.249880 * t."X_44" + 0.011965 * t."X_45" + -0.020161 * t."X_46" + -0.050036 * t."X_47" + 0.010142 * t."X_48" + 0.086508 * t."X_49" + -0.345626 * t."X_50" + 0.167211 * t."X_51" + 0.167282 * t."X_52" + 0.111063 * t."X_53" + -0.033999 * t."X_54" + -0.076273 * t."X_55" + -0.492583 * t."X_56" + -0.006612 * t."X_57" + 0.076757 * t."X_58" + -0.760030 * t."X_59" + 0.298279 * t."X_60" + -0.125722 * t."X_61" + 0.052293 * t."X_62" + 0.004003 * t."X_63" AS "Score_1",
   CAST(NULL AS FLOAT) AS "Proba_1",
   CAST(NULL AS FLOAT) AS "LogProba_1",
   -2.312550 + 0.000000 * t."X_0" + 0.030670 * t."X_1" + -0.173619 * t."X_2" + -0.377249 * t."X_3" + -0.083745 * t."X_4" + 0.029895 * t."X_5" + 0.050117 * t."X_6" + -0.122494 * t."X_7" + -0.217887 * t."X_8" + 0.525793 * t."X_9" + -0.605060 * t."X_10" + -0.246498 * t."X_11" + 0.023347 * t."X_12" + -0.168869 * t."X_13" + -0.000966 * t."X_14" + -0.102214 * t."X_15" + -0.081148 * t."X_16" + 0.555119 * t."X_17" + -0.067838 * t."X_18" + 0.192016 * t."X_19" + -0.150114 * t."X_20" + -0.026895 * t."X_21" + -0.054417 * t."X_22" + 0.228743 * t."X_23" + 0.156728 * t."X_24" + -1.041385 * t."X_25" + 0.801205 * t."X_26" + -0.460026 * t."X_27" + 0.216646 * t."X_28" + 0.089666 * t."X_29" + 0.118839 * t."X_30" + -0.133821 * t."X_31" + 0.000000 * t."X_32" + -0.448386 * t."X_33" + 0.069308 * t."X_34" + -0.037197 * t."X_35" + 0.009280 * t."X_36" + -0.034330 * t."X_37" + 0.138892 * t."X_38" + 0.000000 * t."X_39" + 0.051020 * t."X_40" + 0.535454 * t."X_41" + -0.486100 * t."X_42" + 0.279667 * t."X_43" + -0.185064 * t."X_44" + 0.309893 * t."X_45" + -0.220082 * t."X_46" + -0.063824 * t."X_47" + -0.636510 * t."X_48" + -0.140736 * t."X_49" + 0.380115 * t."X_50" + 0.650841 * t."X_51" + -0.077391 * t."X_52" + -0.031975 * t."X_53" + -0.201939 * t."X_54" + 0.082504 * t."X_55" + -0.065813 * t."X_56" + -0.149762 * t."X_57" + -0.342146 * t."X_58" + 1.046398 * t."X_59" + -0.239644 * t."X_60" + 0.409932 * t."X_61" + -0.166827 * t."X_62" + -0.172885 * t."X_63" AS "Score_2",
   CAST(NULL AS FLOAT) AS "Proba_2",
   CAST(NULL AS FLOAT) AS "LogProba_2",
   5.073037 + 0.000000 * t."X_0" + 0.008814 * t."X_1" + -0.439224 * t."X_2" + -0.224066 * t."X_3" + 0.075410 * t."X_4" + -0.172707 * t."X_5" + 0.112572 * t."X_6" + -0.227429 * t."X_7" + -0.255332 * t."X_8" + 0.608235 * t."X_9" + -0.557463 * t."X_10" + 0.038259 * t."X_11" + 0.157020 * t."X_12" + -0.158112 * t."X_13" + 0.027477 * t."X_14" + -0.098860 * t."X_15" + 0.096512 * t."X_16" + 0.154014 * t."X_17" + 0.140628 * t."X_18" + 0.010308 * t."X_19" + 0.056230 * t."X_20" + -0.194251 * t."X_21" + -0.072266 * t."X_22" + -0.164782 * t."X_23" + 0.143551 * t."X_24" + -1.439654 * t."X_25" + 1.136392 * t."X_26" + -0.755303 * t."X_27" + 0.294527 * t."X_28" + -0.021921 * t."X_29" + 0.170419 * t."X_30" + -0.001336 * t."X_31" + 0.000000 * t."X_32" + -0.400677 * t."X_33" + -0.054895 * t."X_34" + 0.243010 * t."X_35" + -0.059317 * t."X_36" + -0.162507 * t."X_37" + 0.107936 * t."X_38" + 0.000000 * t."X_39" + 0.420713 * t."X_40" + 0.515369 * t."X_41" + -0.343049 * t."X_42" + -0.517710 * t."X_43" + 0.215785 * t."X_44" + -0.004205 * t."X_45" + -0.078440 * t."X_46" + -0.025554 * t."X_47" + -0.242509 * t."X_48" + -0.239510 * t."X_49" + 0.478015 * t."X_50" + -0.274344 * t."X_51" + -0.101460 * t."X_52" + -0.064153 * t."X_53" + -0.138818 * t."X_54" + -0.090262 * t."X_55" + 0.149232 * t."X_56" + -0.082487 * t."X_57" + -0.487625 * t."X_58" + 1.214193 * t."X_59" + -0.418718 * t."X_60" + 0.333403 * t."X_61" + -0.091373 * t."X_62" + -0.140803 * t."X_63" AS "Score_3",
   CAST(NULL AS FLOAT) AS "Proba_3",
   CAST(NULL AS FLOAT) AS "LogProba_3",
   -3.327538 + 0.000000 * t."X_0" + 0.055155 * t."X_1" + 0.342641 * t."X_2" + 0.387181 * t."X_3" + -0.030950 * t."X_4" + 0.100018 * t."X_5" + -0.125413 * t."X_6" + 0.158461 * t."X_7" + 0.330564 * t."X_8" + -0.323603 * t."X_9" + 0.678307 * t."X_10" + 0.225536 * t."X_11" + -0.134751 * t."X_12" + 0.221171 * t."X_13" + 0.032919 * t."X_14" + 0.077558 * t."X_15" + 0.018079 * t."X_16" + -0.877504 * t."X_17" + 0.209664 * t."X_18" + -0.304929 * t."X_19" + 0.053187 * t."X_20" + 0.160441 * t."X_21" + 0.054524 * t."X_22" + 0.018859 * t."X_23" + -0.084096 * t."X_24" + 1.235906 * t."X_25" + -1.102875 * t."X_26" + 0.774537 * t."X_27" + -0.293058 * t."X_28" + -0.045326 * t."X_29" + -0.154714 * t."X_30" + 0.137063 * t."X_31" + 0.000000 * t."X_32" + 1.376017 * t."X_33" + -0.574055 * t."X_34" + -0.089163 * t."X_35" + -0.008527 * t."X_36" + 0.095151 * t."X_37" + -0.181098 * t."X_38" + 0.000000 * t."X_39" + -0.611693 * t."X_40" + -0.779493 * t."X_41" + 0.337057 * t."X_42" + 0.873643 * t."X_43" + -0.325816 * t."X_44" + -0.052722 * t."X_45" + 0.143129 * t."X_46" + 0.051796 * t."X_47" + 0.642325 * t."X_48" + 0.302921 * t."X_49" + -0.608932 * t."X_50" + -0.568626 * t."X_51" + 0.236644 * t."X_52" + 0.079197 * t."X_53" + 0.223009 * t."X_54" + -0.006500 * t."X_55" + -0.295370 * t."X_56" + 0.051725 * t."X_57" + 0.350528 * t."X_58" + -1.255888 * t."X_59" + 0.352939 * t."X_60" + -0.376527 * t."X_61" + 0.189280 * t."X_62" + 0.240723 * t."X_63" AS "Score_4",
   CAST(NULL AS FLOAT) AS "Proba_4",
   CAST(NULL AS FLOAT) AS "LogProba_4",
   -3.968048 + 0.000000 * t."X_0" + 0.049122 * t."X_1" + -0.549698 * t."X_2" + -0.133379 * t."X_3" + 0.044154 * t."X_4" + -0.080883 * t."X_5" + -0.047743 * t."X_6" + 0.169345 * t."X_7" + -0.307232 * t."X_8" + 0.398160 * t."X_9" + -0.546001 * t."X_10" + -0.027465 * t."X_11" + 0.126981 * t."X_12" + -0.119484 * t."X_13" + 0.086937 * t."X_14" + -0.006870 * t."X_15" + -0.078466 * t."X_16" + 0.083286 * t."X_17" + -0.080438 * t."X_18" + 0.315900 * t."X_19" + -0.245336 * t."X_20" + -0.018597 * t."X_21" + -0.134631 * t."X_22" + -0.148311 * t."X_23" + -0.946818 * t."X_24" + 1.273139 * t."X_25" + -0.912991 * t."X_26" + 0.153886 * t."X_27" + 0.117767 * t."X_28" + 0.206895 * t."X_29" + 0.033009 * t."X_30" + -0.144961 * t."X_31" + 0.000000 * t."X_32" + -0.501833 * t."X_33" + 0.645875 * t."X_34" + 0.050663 * t."X_35" + 0.014475 * t."X_36" + 0.016672 * t."X_37" + -0.107642 * t."X_38" + 0.000000 * t."X_39" + 0.099805 * t."X_40" + 0.299974 * t."X_41" + -0.556397 * t."X_42" + 0.022271 * t."X_43" + 0.041648 * t."X_44" + 0.051068 * t."X_45" + 0.114891 * t."X_46" + 0.089292 * t."X_47" + -0.015600 * t."X_48" + -0.058732 * t."X_49" + 0.481506 * t."X_50" + -0.056438 * t."X_51" + -0.143452 * t."X_52" + -0.084850 * t."X_53" + -0.138528 * t."X_54" + 0.098426 * t."X_55" + 0.408751 * t."X_56" + -0.044198 * t."X_57" + -0.090259 * t."X_58" + 1.198328 * t."X_59" + -0.426418 * t."X_60" + 0.289816 * t."X_61" + 0.004926 * t."X_62" + -0.103392 * t."X_63" AS "Score_5",
   CAST(NULL AS FLOAT) AS "Proba_5",
   CAST(NULL AS FLOAT) AS "LogProba_5",
   -3.075563 + 0.000000 * t."X_0" + 0.099930 * t."X_1" + 0.468913 * t."X_2" + 0.116537 * t."X_3" + -0.043640 * t."X_4" + 0.149348 * t."X_5" + -0.025982 * t."X_6" + 0.044777 * t."X_7" + 0.231852 * t."X_8" + -0.484336 * t."X_9" + 0.595536 * t."X_10" + -0.059380 * t."X_11" + -0.125167 * t."X_12" + 0.139010 * t."X_13" + -0.055654 * t."X_14" + 0.107742 * t."X_15" + 0.143956 * t."X_16" + -0.330081 * t."X_17" + 0.065249 * t."X_18" + -0.174025 * t."X_19" + 0.119387 * t."X_20" + 0.022379 * t."X_21" + 0.100016 * t."X_22" + 0.177691 * t."X_23" + 0.300009 * t."X_24" + 0.219283 * t."X_25" + -0.299983 * t."X_26" + 0.332719 * t."X_27" + -0.201056 * t."X_28" + -0.042534 * t."X_29" + -0.205718 * t."X_30" + -0.030680 * t."X_31" + 0.000000 * t."X_32" + 0.592049 * t."X_33" + -0.099183 * t."X_34" + -0.166335 * t."X_35" + 0.010472 * t."X_36" + 0.121021 * t."X_37" + -0.033826 * t."X_38" + 0.000000 * t."X_39" + -0.185133 * t."X_40" + -0.646837 * t."X_41" + 0.647390 * t."X_42" + -0.083441 * t."X_43" + 0.027355 * t."X_44" + -0.098150 * t."X_45" + 0.035020 * t."X_46" + -0.084634 * t."X_47" + 0.154647 * t."X_48" + 0.130675 * t."X_49" + -0.419038 * t."X_50" + 0.327227 * t."X_51" + 0.041279 * t."X_52" + 0.068727 * t."X_53" + 0.211493 * t."X_54" + -0.026554 * t."X_55" + 0.044468 * t."X_56" + 0.052719 * t."X_57" + 0.230762 * t."X_58" + -1.079588 * t."X_59" + 0.442844 * t."X_60" + -0.323376 * t."X_61" + 0.036821 * t."X_62" + 0.094893 * t."X_63" AS "Score_6",
   CAST(NULL AS FLOAT) AS "Proba_6",
   CAST(NULL AS FLOAT) AS "LogProba_6",
   1.307917 + 0.000000 * t."X_0" + -0.005529 * t."X_1" + 0.126144 * t."X_2" + -0.034724 * t."X_3" + -0.046547 * t."X_4" + 0.030143 * t."X_5" + 0.074017 * t."X_6" + -0.168596 * t."X_7" + 0.347427 * t."X_8" + -0.130808 * t."X_9" + 0.245841 * t."X_10" + -0.029497 * t."X_11" + -0.047800 * t."X_12" + 0.048686 * t."X_13" + -0.039389 * t."X_14" + -0.017464 * t."X_15" + -0.112664 * t."X_16" + -0.083584 * t."X_17" + 0.166801 * t."X_18" + -0.186969 * t."X_19" + 0.027512 * t."X_20" + 0.048360 * t."X_21" + 0.046177 * t."X_22" + 0.115444 * t."X_23" + 0.606295 * t."X_24" + -0.966678 * t."X_25" + 0.525376 * t."X_26" + -0.185482 * t."X_27" + 0.033070 * t."X_28" + -0.150010 * t."X_29" + 0.034219 * t."X_30" + 0.005956 * t."X_31" + 0.000000 * t."X_32" + 0.156680 * t."X_33" + 0.110424 * t."X_34" + -0.176180 * t."X_35" + 0.013681 * t."X_36" + -0.098158 * t."X_37" + 0.085745 * t."X_38" + 0.000000 * t."X_39" + -0.053249 * t."X_40" + 0.067808 * t."X_41" + -0.270809 * t."X_42" + 0.418085 * t."X_43" + -0.313088 * t."X_44" + 0.125390 * t."X_45" + -0.096406 * t."X_46" + -0.093592 * t."X_47" + -0.074049 * t."X_48" + 0.128832 * t."X_49" + -0.450801 * t."X_50" + 0.197514 * t."X_51" + 0.068991 * t."X_52" + 0.040466 * t."X_53" + -0.048803 * t."X_54" + -0.072841 * t."X_55" + -0.424195 * t."X_56" + -0.060076 * t."X_57" + 0.167962 * t."X_58" + -0.331997 * t."X_59" + 0.125948 * t."X_60" + 0.050983 * t."X_61" + -0.025670 * t."X_62" + 0.024108 * t."X_63" AS "Score_7",
   CAST(NULL AS FLOAT) AS "Proba_7",
   CAST(NULL AS FLOAT) AS "LogProba_7",
   0.379625 + 0.000000 * t."X_0" + -0.118057 * t."X_1" + 0.059731 * t."X_2" + 0.012771 * t."X_3" + 0.035093 * t."X_4" + -0.020464 * t."X_5" + 0.062867 * t."X_6" + -0.107737 * t."X_7" + -0.080586 * t."X_8" + 0.034032 * t."X_9" + -0.096446 * t."X_10" + 0.056535 * t."X_11" + -0.007070 * t."X_12" + -0.002504 * t."X_13" + -0.004766 * t."X_14" + -0.017376 * t."X_15" + 0.015093 * t."X_16" + 0.327907 * t."X_17" + -0.046450 * t."X_18" + -0.030636 * t."X_19" + -0.012039 * t."X_20" + -0.046265 * t."X_21" + 0.001989 * t."X_22" + 0.027884 * t."X_23" + 0.045408 * t."X_24" + -0.503421 * t."X_25" + 0.378824 * t."X_26" + -0.119348 * t."X_27" + 0.057410 * t."X_28" + -0.010895 * t."X_29" + 0.018125 * t."X_30" + 0.162668 * t."X_31" + 0.000000 * t."X_32" + -0.564910 * t."X_33" + 0.308932 * t."X_34" + -0.252163 * t."X_35" + 0.121852 * t."X_36" + -0.083922 * t."X_37" + 0.088833 * t."X_38" + 0.000000 * t."X_39" + 0.011862 * t."X_40" + 0.122972 * t."X_41" + 0.087501 * t."X_42" + 0.242927 * t."X_43" + -0.032102 * t."X_44" + -0.002209 * t."X_45" + -0.088576 * t."X_46" + -0.133523 * t."X_47" + -0.002932 * t."X_48" + -0.134710 * t."X_49" + 0.275181 * t."X_50" + -0.468352 * t."X_51" + 0.057453 * t."X_52" + 0.024950 * t."X_53" + -0.009069 * t."X_54" + 0.001141 * t."X_55" + -0.194552 * t."X_56" + 0.020623 * t."X_57" + -0.137397 * t."X_58" + 0.020603 * t."X_59" + -0.080330 * t."X_60" + -0.003421 * t."X_61" + -0.048710 * t."X_62" + 0.068161 * t."X_63" AS "Score_8",
   CAST(NULL AS FLOAT) AS "Proba_8",
   CAST(NULL AS FLOAT) AS "LogProba_8",
   3.661365 + 0.000000 * t."X_0" + -0.165382 * t."X_1" + -0.244769 * t."X_2" + 0.188639 * t."X_3" + 0.053905 * t."X_4" + -0.124617 * t."X_5" + 0.015247 * t."X_6" + 0.011676 * t."X_7" + -0.104262 * t."X_8" + 0.150813 * t."X_9" + -0.218070 * t."X_10" + 0.171284 * t."X_11" + 0.023140 * t."X_12" + -0.073185 * t."X_13" + -0.003336 * t."X_14" + -0.014238 * t."X_15" + -0.112759 * t."X_16" + 0.275148 * t."X_17" + -0.130850 * t."X_18" + 0.111979 * t."X_19" + -0.022753 * t."X_20" + -0.027399 * t."X_21" + -0.027660 * t."X_22" + -0.308453 * t."X_23" + -0.246680 * t."X_24" + 0.056560 * t."X_25" + 0.193253 * t."X_26" + -0.225686 * t."X_27" + 0.053335 * t."X_28" + -0.051349 * t."X_29" + 0.114945 * t."X_30" + 0.145360 * t."X_31" + 0.000000 * t."X_32" + -0.991186 * t."X_33" + 0.294543 * t."X_34" + 0.120634 * t."X_35" + 0.001707 * t."X_36" + -0.054184 * t."X_37" + 0.060591 * t."X_38" + 0.000000 * t."X_39" + 0.274047 * t."X_40" + 0.521767 * t."X_41" + -0.280667 * t."X_42" + -0.483519 * t."X_43" + 0.275651 * t."X_44" + -0.167090 * t."X_45" + 0.046256 * t."X_46" + 0.002697 * t."X_47" + 0.078892 * t."X_48" + -0.088449 * t."X_49" + 0.204170 * t."X_50" + -0.427796 * t."X_51" + -0.001449 * t."X_52" + -0.051991 * t."X_53" + -0.006275 * t."X_54" + -0.035535 * t."X_55" + -0.067556 * t."X_56" + 0.015639 * t."X_57" + 0.126672 * t."X_58" + -0.154016 * t."X_59" + -0.071168 * t."X_60" + -0.055853 * t."X_61" + 0.026312 * t."X_62" + -0.051681 * t."X_63" AS "Score_9",
   CAST(NULL AS FLOAT) AS "Proba_9",
   CAST(NULL AS FLOAT) AS "LogProba_9"
  FROM model_input AS t
 ),
soft_max_orig_cte AS 
( SELECT t."index" AS "index", 
   t."Score_0" AS "Score_0",
   t."Proba_0" AS "Proba_0",
   t."LogProba_0" AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Proba_1" AS "Proba_1",
   t."LogProba_1" AS "LogProba_1",
   t."Score_2" AS "Score_2",
   t."Proba_2" AS "Proba_2",
   t."LogProba_2" AS "LogProba_2",
   t."Score_3" AS "Score_3",
   t."Proba_3" AS "Proba_3",
   t."LogProba_3" AS "LogProba_3",
   t."Score_4" AS "Score_4",
   t."Proba_4" AS "Proba_4",
   t."LogProba_4" AS "LogProba_4",
   t."Score_5" AS "Score_5",
   t."Proba_5" AS "Proba_5",
   t."LogProba_5" AS "LogProba_5",
   t."Score_6" AS "Score_6",
   t."Proba_6" AS "Proba_6",
   t."LogProba_6" AS "LogProba_6",
   t."Score_7" AS "Score_7",
   t."Proba_7" AS "Proba_7",
   t."LogProba_7" AS "LogProba_7",
   t."Score_8" AS "Score_8",
   t."Proba_8" AS "Proba_8",
   t."LogProba_8" AS "LogProba_8",
   t."Score_9" AS "Score_9",
   t."Proba_9" AS "Proba_9",
   t."LogProba_9" AS "LogProba_9",
   CAST(NULL AS BIGINT) AS "Decision",
   CAST(NULL AS FLOAT) AS "DecisionProba",
   MAX( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7", t."Score_8", t."Score_9" ) AS "Greatest_Score"
  FROM
    model_scores_cte AS t
),
soft_max_cte_with_exp_deltas AS 
( SELECT t1."index" as "index",
    t1."Proba_0" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_0" AS "Exp_Score_0",
    t1."Proba_1" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_1" AS "Exp_Score_1",
    t1."Proba_2" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_2" AS "Exp_Score_2",
    t1."Proba_3" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_3" AS "Exp_Score_3",
    t1."Proba_4" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_4" AS "Exp_Score_4",
    t1."Proba_5" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_5" AS "Exp_Score_5",
    t1."Proba_6" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_6" AS "Exp_Score_6",
    t1."Proba_7" AS "Proba_7",
    t1."Score_7" AS "Score_7",
    t1."Exp_Score_7" AS "Exp_Score_7",
    t1."Proba_8" AS "Proba_8",
    t1."Score_8" AS "Score_8",
    t1."Exp_Score_8" AS "Exp_Score_8",
    t1."Proba_9" AS "Proba_9",
    t1."Score_9" AS "Score_9",
    t1."Exp_Score_9" AS "Exp_Score_9",
    ( t1."Exp_Score_0" + t1."Exp_Score_1" + t1."Exp_Score_2" + t1."Exp_Score_3" + t1."Exp_Score_4" + t1."Exp_Score_5" + t1."Exp_Score_6" + t1."Exp_Score_7" + t1."Exp_Score_8" + t1."Exp_Score_9" ) AS "Sum_Exp"
  FROM
   ( SELECT t."index" as "index",
        t."Proba_0" AS "Proba_0",
        t."Score_0" AS "Score_0",
        t."Proba_1" AS "Proba_1",
        t."Score_1" AS "Score_1",
        t."Proba_2" AS "Proba_2",
        t."Score_2" AS "Score_2",
        t."Proba_3" AS "Proba_3",
        t."Score_3" AS "Score_3",
        t."Proba_4" AS "Proba_4",
        t."Score_4" AS "Score_4",
        t."Proba_5" AS "Proba_5",
        t."Score_5" AS "Score_5",
        t."Proba_6" AS "Proba_6",
        t."Score_6" AS "Score_6",
        t."Proba_7" AS "Proba_7",
        t."Score_7" AS "Score_7",
        t."Proba_8" AS "Proba_8",
        t."Score_8" AS "Score_8",
        t."Proba_9" AS "Proba_9",
        t."Score_9" AS "Score_9",
        EXP(t."Score_0" - t."Greatest_Score") as "Exp_Score_0",
        EXP(t."Score_1" - t."Greatest_Score") as "Exp_Score_1",
        EXP(t."Score_2" - t."Greatest_Score") as "Exp_Score_2",
        EXP(t."Score_3" - t."Greatest_Score") as "Exp_Score_3",
        EXP(t."Score_4" - t."Greatest_Score") as "Exp_Score_4",
        EXP(t."Score_5" - t."Greatest_Score") as "Exp_Score_5",
        EXP(t."Score_6" - t."Greatest_Score") as "Exp_Score_6",
        EXP(t."Score_7" - t."Greatest_Score") as "Exp_Score_7",
        EXP(t."Score_8" - t."Greatest_Score") as "Exp_Score_8",
        EXP(t."Score_9" - t."Greatest_Score") as "Exp_Score_9"
    FROM
       soft_max_orig_cte AS t
  ) AS t1
),
soft_max_cte AS 
( SELECT t1."index" AS "index",
    t1."Exp_Score_0" / t1."Sum_Exp" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_1" / t1."Sum_Exp" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_2" / t1."Sum_Exp" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_3" / t1."Sum_Exp" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_4" / t1."Sum_Exp" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_5" / t1."Sum_Exp" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_6" / t1."Sum_Exp" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_7" / t1."Sum_Exp" AS "Proba_7",
    t1."Score_7" AS "Score_7",
    t1."Exp_Score_8" / t1."Sum_Exp" AS "Proba_8",
    t1."Score_8" AS "Score_8",
    t1."Exp_Score_9" / t1."Sum_Exp" AS "Proba_9",
    t1."Score_9" AS "Score_9"
 FROM 
   soft_max_cte_with_exp_deltas as t1
),
arg_max_cte_with_max_proba AS 
( SELECT t."index" AS "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    t."Proba_8" AS "Proba_8",
    t."Score_8" AS "Score_8",
    t."Proba_9" AS "Proba_9",
    t."Score_9" AS "Score_9",
    MAX( t."Proba_0", t."Proba_1", t."Proba_2", t."Proba_3", t."Proba_4", t."Proba_5", t."Proba_6", t."Proba_7", t."Proba_8", t."Proba_9" ) AS "Max_Proba",
    MAX( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7", t."Score_8", t."Score_9" ) AS "Max_Score"
  FROM
     "soft_max_cte" AS t
),
arg_max_cte_with_max_proba_idx AS 
( SELECT t."index" as "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    t."Proba_8" AS "Proba_8",
    t."Score_8" AS "Score_8",
    t."Proba_9" AS "Proba_9",
    t."Score_9" AS "Score_9",
    CASE WHEN(t."Proba_0" = t."Max_Proba") THEN 0 else NULL END AS "max_idx_0",
    CASE WHEN(t."Proba_1" = t."Max_Proba") THEN 1 else NULL END AS "max_idx_1",
    CASE WHEN(t."Proba_2" = t."Max_Proba") THEN 2 else NULL END AS "max_idx_2",
    CASE WHEN(t."Proba_3" = t."Max_Proba") THEN 3 else NULL END AS "max_idx_3",
    CASE WHEN(t."Proba_4" = t."Max_Proba") THEN 4 else NULL END AS "max_idx_4",
    CASE WHEN(t."Proba_5" = t."Max_Proba") THEN 5 else NULL END AS "max_idx_5",
    CASE WHEN(t."Proba_6" = t."Max_Proba") THEN 6 else NULL END AS "max_idx_6",
    CASE WHEN(t."Proba_7" = t."Max_Proba") THEN 7 else NULL END AS "max_idx_7",
    CASE WHEN(t."Proba_8" = t."Max_Proba") THEN 8 else NULL END AS "max_idx_8",
    CASE WHEN(t."Proba_9" = t."Max_Proba") THEN 9 else NULL END AS "max_idx_9",
    t."Max_Proba" AS "Max_Proba",
    t."Max_Score" AS "Max_Score"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Proba_2" AS "Proba_2",
     t."Score_2" AS "Score_2",
     t."Proba_3" AS "Proba_3",
     t."Score_3" AS "Score_3",
     t."Proba_4" AS "Proba_4",
     t."Score_4" AS "Score_4",
     t."Proba_5" AS "Proba_5",
     t."Score_5" AS "Score_5",
     t."Proba_6" AS "Proba_6",
     t."Score_6" AS "Score_6",
     t."Proba_7" AS "Proba_7",
     t."Score_7" AS "Score_7",
     t."Proba_8" AS "Proba_8",
     t."Score_8" AS "Score_8",
     t."Proba_9" AS "Proba_9",
     t."Score_9" AS "Score_9",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1", t."max_idx_2", t."max_idx_3", t."max_idx_4", t."max_idx_5", t."max_idx_6", t."max_idx_7", t."max_idx_8", t."max_idx_9" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."Score_4" AS "Score_4",
  arg_max_cte."Proba_4" AS "Proba_4",
  CASE WHEN (arg_max_cte."Proba_4" IS NULL OR arg_max_cte."Proba_4" > 0.0) THEN LN( arg_max_cte."Proba_4" ) ELSE -1.79769313486231e+308 END AS "LogProba_4",
  arg_max_cte."Score_5" AS "Score_5",
  arg_max_cte."Proba_5" AS "Proba_5",
  CASE WHEN (arg_max_cte."Proba_5" IS NULL OR arg_max_cte."Proba_5" > 0.0) THEN LN( arg_max_cte."Proba_5" ) ELSE -1.79769313486231e+308 END AS "LogProba_5",
  arg_max_cte."Score_6" AS "Score_6",
  arg_max_cte."Proba_6" AS "Proba_6",
  CASE WHEN (arg_max_cte."Proba_6" IS NULL OR arg_max_cte."Proba_6" > 0.0) THEN LN( arg_max_cte."Proba_6" ) ELSE -1.79769313486231e+308 END AS "LogProba_6",
  arg_max_cte."Score_7" AS "Score_7",
  arg_max_cte."Proba_7" AS "Proba_7",
  CASE WHEN (arg_max_cte."Proba_7" IS NULL OR arg_max_cte."Proba_7" > 0.0) THEN LN( arg_max_cte."Proba_7" ) ELSE -1.79769313486231e+308 END AS "LogProba_7",
  arg_max_cte."Score_8" AS "Score_8",
  arg_max_cte."Proba_8" AS "Proba_8",
  CASE WHEN (arg_max_cte."Proba_8" IS NULL OR arg_max_cte."Proba_8" > 0.0) THEN LN( arg_max_cte."Proba_8" ) ELSE -1.79769313486231e+308 END AS "LogProba_8",
  arg_max_cte."Score_9" AS "Score_9",
  arg_max_cte."Proba_9" AS "Proba_9",
  CASE WHEN (arg_max_cte."Proba_9" IS NULL OR arg_max_cte."Proba_9" > 0.0) THEN LN( arg_max_cte."Proba_9" ) ELSE -1.79769313486231e+308 END AS "LogProba_9",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte