WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9", CAST("ADS"."X_10" AS FLOAT) AS "X_10", CAST("ADS"."X_11" AS FLOAT) AS "X_11", CAST("ADS"."X_12" AS FLOAT) AS "X_12", CAST("ADS"."X_13" AS FLOAT) AS "X_13", CAST("ADS"."X_14" AS FLOAT) AS "X_14", CAST("ADS"."X_15" AS FLOAT) AS "X_15", CAST("ADS"."X_16" AS FLOAT) AS "X_16", CAST("ADS"."X_17" AS FLOAT) AS "X_17", CAST("ADS"."X_18" AS FLOAT) AS "X_18", CAST("ADS"."X_19" AS FLOAT) AS "X_19", CAST("ADS"."X_20" AS FLOAT) AS "X_20", CAST("ADS"."X_21" AS FLOAT) AS "X_21", CAST("ADS"."X_22" AS FLOAT) AS "X_22", CAST("ADS"."X_23" AS FLOAT) AS "X_23", CAST("ADS"."X_24" AS FLOAT) AS "X_24", CAST("ADS"."X_25" AS FLOAT) AS "X_25", CAST("ADS"."X_26" AS FLOAT) AS "X_26", CAST("ADS"."X_27" AS FLOAT) AS "X_27", CAST("ADS"."X_28" AS FLOAT) AS "X_28", CAST("ADS"."X_29" AS FLOAT) AS "X_29", CAST("ADS"."X_30" AS FLOAT) AS "X_30", CAST("ADS"."X_31" AS FLOAT) AS "X_31", CAST("ADS"."X_32" AS FLOAT) AS "X_32", CAST("ADS"."X_33" AS FLOAT) AS "X_33", CAST("ADS"."X_34" AS FLOAT) AS "X_34", CAST("ADS"."X_35" AS FLOAT) AS "X_35", CAST("ADS"."X_36" AS FLOAT) AS "X_36", CAST("ADS"."X_37" AS FLOAT) AS "X_37", CAST("ADS"."X_38" AS FLOAT) AS "X_38", CAST("ADS"."X_39" AS FLOAT) AS "X_39", CAST("ADS"."X_40" AS FLOAT) AS "X_40", CAST("ADS"."X_41" AS FLOAT) AS "X_41", CAST("ADS"."X_42" AS FLOAT) AS "X_42", CAST("ADS"."X_43" AS FLOAT) AS "X_43", CAST("ADS"."X_44" AS FLOAT) AS "X_44", CAST("ADS"."X_45" AS FLOAT) AS "X_45", CAST("ADS"."X_46" AS FLOAT) AS "X_46", CAST("ADS"."X_47" AS FLOAT) AS "X_47", CAST("ADS"."X_48" AS FLOAT) AS "X_48", CAST("ADS"."X_49" AS FLOAT) AS "X_49", CAST("ADS"."X_50" AS FLOAT) AS "X_50", CAST("ADS"."X_51" AS FLOAT) AS "X_51", CAST("ADS"."X_52" AS FLOAT) AS "X_52", CAST("ADS"."X_53" AS FLOAT) AS "X_53", CAST("ADS"."X_54" AS FLOAT) AS "X_54", CAST("ADS"."X_55" AS FLOAT) AS "X_55", CAST("ADS"."X_56" AS FLOAT) AS "X_56", CAST("ADS"."X_57" AS FLOAT) AS "X_57", CAST("ADS"."X_58" AS FLOAT) AS "X_58", CAST("ADS"."X_59" AS FLOAT) AS "X_59", CAST("ADS"."X_60" AS FLOAT) AS "X_60", CAST("ADS"."X_61" AS FLOAT) AS "X_61", CAST("ADS"."X_62" AS FLOAT) AS "X_62", CAST("ADS"."X_63" AS FLOAT) AS "X_63"
  FROM "digits_tiny" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -40253.796875 + 0.000000 * t."X_0" + 19683.875000 * t."X_1" + -1647.265747 * t."X_2" + 1225.496826 * t."X_3" + 988.603699 * t."X_4" + 1006.010986 * t."X_5" + -383.621002 * t."X_6" + 61.354042 * t."X_7" + 0.000000 * t."X_8" + 3118.747559 * t."X_9" + 95.935593 * t."X_10" + -424.743866 * t."X_11" + -117.846367 * t."X_12" + -698.725830 * t."X_13" + -800.310486 * t."X_14" + 1129.293335 * t."X_15" + 0.000000 * t."X_16" + -3943.364014 * t."X_17" + 4328.140625 * t."X_18" + -469.984467 * t."X_19" + -69.189400 * t."X_20" + -1076.982178 * t."X_21" + -503.085266 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + -2112.563965 * t."X_25" + -593.884583 * t."X_26" + 779.098206 * t."X_27" + -3977.593018 * t."X_28" + 377.303314 * t."X_29" + -4586.909668 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + -652.238342 * t."X_33" + -272.895203 * t."X_34" + 2354.678223 * t."X_35" + 273.443207 * t."X_36" + -1560.732422 * t."X_37" + 826.850830 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + 251.650589 * t."X_41" + -1231.217407 * t."X_42" + 1807.259644 * t."X_43" + 870.811890 * t."X_44" + -168.866867 * t."X_45" + -433.812958 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + -5841.065918 * t."X_49" + 3249.945801 * t."X_50" + 842.438782 * t."X_51" + -621.339111 * t."X_52" + -252.550690 * t."X_53" + 808.264954 * t."X_54" + -793.390259 * t."X_55" + 0.000000 * t."X_56" + 20984.123047 * t."X_57" + 562.500732 * t."X_58" + -2086.145020 * t."X_59" + 1728.324219 * t."X_60" + -143.609772 * t."X_61" + 504.040497 * t."X_62" + -436.092590 * t."X_63" AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   -29925.437500 + 0.000000 * t."X_0" + -14701.732422 * t."X_1" + 7774.279785 * t."X_2" + -212.867950 * t."X_3" + 341.969574 * t."X_4" + 1116.889404 * t."X_5" + 888.231628 * t."X_6" + 1007.760010 * t."X_7" + 0.000000 * t."X_8" + -1513.895508 * t."X_9" + -907.973816 * t."X_10" + 214.559647 * t."X_11" + -215.266388 * t."X_12" + 133.959412 * t."X_13" + 249.424377 * t."X_14" + 3629.335449 * t."X_15" + 0.000000 * t."X_16" + 1740.750732 * t."X_17" + -1341.782471 * t."X_18" + 4188.003906 * t."X_19" + -152.929413 * t."X_20" + 960.770874 * t."X_21" + 414.951385 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + 3383.196777 * t."X_25" + -1110.561890 * t."X_26" + -777.211487 * t."X_27" + 1979.572754 * t."X_28" + -3146.848389 * t."X_29" + 2932.113770 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + 53.799931 * t."X_33" + -583.590149 * t."X_34" + -483.448883 * t."X_35" + -526.335083 * t."X_36" + 672.262207 * t."X_37" + -147.966873 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + 258.313843 * t."X_41" + -173.030014 * t."X_42" + -926.054443 * t."X_43" + -560.212952 * t."X_44" + 195.596817 * t."X_45" + 1388.704712 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + -39.270603 * t."X_49" + -1436.332397 * t."X_50" + 1260.712280 * t."X_51" + -671.307983 * t."X_52" + 647.168884 * t."X_53" + -373.948914 * t."X_54" + -14126.086914 * t."X_55" + 0.000000 * t."X_56" + -14037.071289 * t."X_57" + -575.431946 * t."X_58" + 1178.026489 * t."X_59" + -743.699341 * t."X_60" + 1183.755371 * t."X_61" + -1375.624512 * t."X_62" + -2430.598145 * t."X_63" AS "Score_1",
   CAST(NULL AS FLOAT) AS "Proba_1",
   CAST(NULL AS FLOAT) AS "LogProba_1",
   37163.000000 + 0.000000 * t."X_0" + -10203.621094 * t."X_1" + -4332.174805 * t."X_2" + 1792.921021 * t."X_3" + -814.590332 * t."X_4" + -952.391113 * t."X_5" + 438.642273 * t."X_6" + -1980.280273 * t."X_7" + 0.000000 * t."X_8" + 903.727295 * t."X_9" + -306.581329 * t."X_10" + -251.528503 * t."X_11" + 638.005737 * t."X_12" + 798.274719 * t."X_13" + 2290.522217 * t."X_14" + -5606.143555 * t."X_15" + 0.000000 * t."X_16" + 2642.596191 * t."X_17" + -3309.871582 * t."X_18" + 899.325439 * t."X_19" + 279.064667 * t."X_20" + -285.005920 * t."X_21" + -708.696716 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + 903.727905 * t."X_25" + 975.227478 * t."X_26" + -76.860992 * t."X_27" + -1673.809692 * t."X_28" + 26.195042 * t."X_29" + -1270.877563 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + -807.617798 * t."X_33" + 159.803375 * t."X_34" + -676.332336 * t."X_35" + -127.822632 * t."X_36" + 740.126160 * t."X_37" + 4.115818 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + -1407.504272 * t."X_41" + -342.669983 * t."X_42" + -1049.742676 * t."X_43" + 98.973572 * t."X_44" + 1074.978271 * t."X_45" + 232.753769 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + 4519.818848 * t."X_49" + 142.326126 * t."X_50" + -106.945923 * t."X_51" + -158.702789 * t."X_52" + -53.976261 * t."X_53" + -9.841842 * t."X_54" + 5910.976074 * t."X_55" + 0.000000 * t."X_56" + -9731.886719 * t."X_57" + 1803.872437 * t."X_58" + 191.214951 * t."X_59" + -1113.807129 * t."X_60" + 628.235535 * t."X_61" + -896.714844 * t."X_62" + 1400.517090 * t."X_63" AS "Score_2",
   CAST(NULL AS FLOAT) AS "Proba_2",
   CAST(NULL AS FLOAT) AS "LogProba_2",
   52035.457031 + 0.000000 * t."X_0" + -9052.252930 * t."X_1" + 2467.692627 * t."X_2" + -821.236450 * t."X_3" + 64.632103 * t."X_4" + -49.078522 * t."X_5" + 86.218552 * t."X_6" + -720.706055 * t."X_7" + 0.000000 * t."X_8" + -2432.872559 * t."X_9" + 1392.755615 * t."X_10" + -59.137115 * t."X_11" + -501.091339 * t."X_12" + 467.051941 * t."X_13" + 26.495905 * t."X_14" + -1842.855591 * t."X_15" + 0.000000 * t."X_16" + 1944.281982 * t."X_17" + -3043.020264 * t."X_18" + -697.357300 * t."X_19" + 31.708441 * t."X_20" + 45.805801 * t."X_21" + -123.819992 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + 2107.486816 * t."X_25" + 637.177856 * t."X_26" + -354.980957 * t."X_27" + 1021.640808 * t."X_28" + -903.378540 * t."X_29" + 1923.368530 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + 293.247375 * t."X_33" + 97.138107 * t."X_34" + -654.974487 * t."X_35" + -5.418335 * t."X_36" + 417.869171 * t."X_37" + -583.029053 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + -461.739899 * t."X_41" + 611.542236 * t."X_42" + -229.722549 * t."X_43" + -484.513367 * t."X_44" + -756.286133 * t."X_45" + -25.747761 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + 3717.816162 * t."X_49" + -808.455811 * t."X_50" + -1030.300415 * t."X_51" + 61.705521 * t."X_52" + -845.223022 * t."X_53" + -513.286438 * t."X_54" + -34.855335 * t."X_55" + 0.000000 * t."X_56" + -8638.495117 * t."X_57" + -1285.312256 * t."X_58" + 499.621185 * t."X_59" + -163.577850 * t."X_60" + -312.572144 * t."X_61" + 64.586594 * t."X_62" + -87.397888 * t."X_63" AS "Score_3",
   CAST(NULL AS FLOAT) AS "Proba_3",
   CAST(NULL AS FLOAT) AS "LogProba_3",
   43883.226562 + 0.000000 * t."X_0" + 6183.941406 * t."X_1" + -6113.265137 * t."X_2" + 2582.040283 * t."X_3" + -833.886902 * t."X_4" + -615.521484 * t."X_5" + 37.627193 * t."X_6" + -193.014847 * t."X_7" + 0.000000 * t."X_8" + -412.553955 * t."X_9" + -1176.313599 * t."X_10" + -187.390045 * t."X_11" + -366.496338 * t."X_12" + 821.200867 * t."X_13" + 300.394135 * t."X_14" + -257.587158 * t."X_15" + 0.000000 * t."X_16" + 2481.689453 * t."X_17" + -324.403931 * t."X_18" + 1159.189331 * t."X_19" + 10.918359 * t."X_20" + 1189.535400 * t."X_21" + 319.511841 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + -3.309302 * t."X_25" + 88.318398 * t."X_26" + 254.072464 * t."X_27" + -1355.510498 * t."X_28" + -1717.575806 * t."X_29" + -1511.506470 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + -2672.489746 * t."X_33" + -254.228394 * t."X_34" + 277.410370 * t."X_35" + -44.007687 * t."X_36" + -551.276123 * t."X_37" + 163.593842 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + 1432.044922 * t."X_41" + -88.444649 * t."X_42" + -718.446960 * t."X_43" + -202.023621 * t."X_44" + 140.109650 * t."X_45" + 257.812408 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + -3573.107666 * t."X_49" + -807.213562 * t."X_50" + -1161.282593 * t."X_51" + -181.136627 * t."X_52" + -169.026901 * t."X_53" + 733.237671 * t."X_54" + 1722.571167 * t."X_55" + 0.000000 * t."X_56" + 6677.423828 * t."X_57" + 1895.530640 * t."X_58" + -517.860107 * t."X_59" + 872.453369 * t."X_60" + -140.699219 * t."X_61" + -44.707848 * t."X_62" + 351.585419 * t."X_63" AS "Score_4",
   CAST(NULL AS FLOAT) AS "Proba_4",
   CAST(NULL AS FLOAT) AS "LogProba_4",
   137235.250000 + 0.000000 * t."X_0" + -9187.819336 * t."X_1" + -11338.010742 * t."X_2" + -1783.378784 * t."X_3" + -669.686951 * t."X_4" + -1741.682495 * t."X_5" + -898.355591 * t."X_6" + -1089.115356 * t."X_7" + 0.000000 * t."X_8" + 1270.743042 * t."X_9" + 356.018799 * t."X_10" + -193.649445 * t."X_11" + 423.301727 * t."X_12" + -286.995697 * t."X_13" + -595.933411 * t."X_14" + -7354.994629 * t."X_15" + 0.000000 * t."X_16" + 2980.948730 * t."X_17" + -2881.329590 * t."X_18" + -2377.052002 * t."X_19" + 376.589203 * t."X_20" + -173.029831 * t."X_21" + 8.833610 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + -667.738403 * t."X_25" + -192.185776 * t."X_26" + 1173.886230 * t."X_27" + -1414.871826 * t."X_28" + 1901.403687 * t."X_29" + 221.587814 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + -1010.673096 * t."X_33" + 227.292587 * t."X_34" + -839.054993 * t."X_35" + -342.140045 * t."X_36" + -489.237274 * t."X_37" + 981.348877 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + -1520.817871 * t."X_41" + 300.311981 * t."X_42" + -1895.840576 * t."X_43" + -831.493591 * t."X_44" + 255.894424 * t."X_45" + 809.251648 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + 12518.868164 * t."X_49" + -3313.745117 * t."X_50" + -545.396240 * t."X_51" + 1511.704956 * t."X_52" + 3235.078857 * t."X_53" + 3019.854004 * t."X_54" + 9654.937500 * t."X_55" + 0.000000 * t."X_56" + -8189.823730 * t."X_57" + 1831.879150 * t."X_58" + 1507.270386 * t."X_59" + -2699.121094 * t."X_60" + -3722.702148 * t."X_61" + 2656.966797 * t."X_62" + 2178.615479 * t."X_63" AS "Score_5",
   CAST(NULL AS FLOAT) AS "Proba_5",
   CAST(NULL AS FLOAT) AS "LogProba_5",
   -7467.562012 + 0.000000 * t."X_0" + 18471.867188 * t."X_1" + -2123.979248 * t."X_2" + -763.306091 * t."X_3" + 215.605179 * t."X_4" + 751.760681 * t."X_5" + 246.096741 * t."X_6" + 1113.065308 * t."X_7" + 0.000000 * t."X_8" + 1667.207520 * t."X_9" + 406.088470 * t."X_10" + -316.973633 * t."X_11" + -454.235931 * t."X_12" + -50.247849 * t."X_13" + -787.948730 * t."X_14" + 3949.926514 * t."X_15" + 0.000000 * t."X_16" + -2023.649292 * t."X_17" + 3300.280518 * t."X_18" + -861.378479 * t."X_19" + -115.127846 * t."X_20" + 23.880745 * t."X_21" + -396.901459 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + -1820.868408 * t."X_25" + -743.229004 * t."X_26" + -462.463287 * t."X_27" + 2279.643555 * t."X_28" + -1502.640137 * t."X_29" + 1691.349854 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + 1518.547607 * t."X_33" + -589.736633 * t."X_34" + -298.717102 * t."X_35" + 26.672478 * t."X_36" + 376.446289 * t."X_37" + -1376.475342 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + 1968.494995 * t."X_41" + 221.352127 * t."X_42" + 164.366852 * t."X_43" + 87.972412 * t."X_44" + -1280.175171 * t."X_45" + -183.429001 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + -6346.088379 * t."X_49" + 171.150131 * t."X_50" + 164.122101 * t."X_51" + 330.628052 * t."X_52" + 15.842085 * t."X_53" + 233.907669 * t."X_54" + 176.803925 * t."X_55" + 0.000000 * t."X_56" + 19320.908203 * t."X_57" + -7.110055 * t."X_58" + -676.081909 * t."X_59" + 1000.847168 * t."X_60" + -355.755249 * t."X_61" + 542.912903 * t."X_62" + -113.862999 * t."X_63" AS "Score_6",
   CAST(NULL AS FLOAT) AS "Proba_6",
   CAST(NULL AS FLOAT) AS "LogProba_6",
   -192676.218750 + 0.000000 * t."X_0" + -1194.268066 * t."X_1" + 15312.724609 * t."X_2" + -2019.669067 * t."X_3" + 707.353455 * t."X_4" + 484.012299 * t."X_5" + -414.839691 * t."X_6" + 1800.937744 * t."X_7" + 0.000000 * t."X_8" + -2601.102539 * t."X_9" + 140.070145 * t."X_10" + 1218.863770 * t."X_11" + 593.629211 * t."X_12" + -1184.517822 * t."X_13" + -682.645081 * t."X_14" + 6353.024902 * t."X_15" + 0.000000 * t."X_16" + -5823.254395 * t."X_17" + 3271.986816 * t."X_18" + -1840.747437 * t."X_19" + -361.034149 * t."X_20" + -684.974915 * t."X_21" + 989.206299 * t."X_22" + 0.000000 * t."X_23" + 0.000000 * t."X_24" + -1789.930664 * t."X_25" + 939.137695 * t."X_26" + -535.539856 * t."X_27" + 3140.926758 * t."X_28" + 4965.541504 * t."X_29" + 600.873108 * t."X_30" + 0.000000 * t."X_31" + 0.000000 * t."X_32" + 3277.424072 * t."X_33" + 1216.215698 * t."X_34" + 320.438202 * t."X_35" + 745.608398 * t."X_36" + 394.542542 * t."X_37" + 131.561676 * t."X_38" + 0.000000 * t."X_39" + 0.000000 * t."X_40" + -520.441162 * t."X_41" + 702.155884 * t."X_42" + 2848.180664 * t."X_43" + 1020.486267 * t."X_44" + 538.748596 * t."X_45" + -2045.532471 * t."X_46" + 0.000000 * t."X_47" + 0.000000 * t."X_48" + -4956.969727 * t."X_49" + 2802.324951 * t."X_50" + 576.652405 * t."X_51" + -271.552216 * t."X_52" + -2577.312744 * t."X_53" + -3898.187012 * t."X_54" + -2510.957031 * t."X_55" + 0.000000 * t."X_56" + -6385.175781 * t."X_57" + -4225.927246 * t."X_58" + -96.046013 * t."X_59" + 1118.582153 * t."X_60" + 2863.345947 * t."X_61" + -1451.458374 * t."X_62" + -862.766235 * t."X_63" AS "Score_7",
   CAST(NULL AS FLOAT) AS "Proba_7",
   CAST(NULL AS FLOAT) AS "LogProba_7"
  FROM model_input AS t
 ),
soft_max_orig_cte AS 
( SELECT t."index" AS "index", 
   t."Score_0" AS "Score_0",
   t."Proba_0" AS "Proba_0",
   t."LogProba_0" AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Proba_1" AS "Proba_1",
   t."LogProba_1" AS "LogProba_1",
   t."Score_2" AS "Score_2",
   t."Proba_2" AS "Proba_2",
   t."LogProba_2" AS "LogProba_2",
   t."Score_3" AS "Score_3",
   t."Proba_3" AS "Proba_3",
   t."LogProba_3" AS "LogProba_3",
   t."Score_4" AS "Score_4",
   t."Proba_4" AS "Proba_4",
   t."LogProba_4" AS "LogProba_4",
   t."Score_5" AS "Score_5",
   t."Proba_5" AS "Proba_5",
   t."LogProba_5" AS "LogProba_5",
   t."Score_6" AS "Score_6",
   t."Proba_6" AS "Proba_6",
   t."LogProba_6" AS "LogProba_6",
   t."Score_7" AS "Score_7",
   t."Proba_7" AS "Proba_7",
   t."LogProba_7" AS "LogProba_7",
   CAST(NULL AS BIGINT) AS "Decision",
   CAST(NULL AS FLOAT) AS "DecisionProba",
   GREATEST( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7" ) AS "Greatest_Score"
  FROM
    model_scores_cte AS t
),
soft_max_cte_with_exp_deltas AS 
( SELECT t1."index" as "index",
    t1."Proba_0" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_0" AS "Exp_Score_0",
    t1."Proba_1" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_1" AS "Exp_Score_1",
    t1."Proba_2" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_2" AS "Exp_Score_2",
    t1."Proba_3" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_3" AS "Exp_Score_3",
    t1."Proba_4" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_4" AS "Exp_Score_4",
    t1."Proba_5" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_5" AS "Exp_Score_5",
    t1."Proba_6" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_6" AS "Exp_Score_6",
    t1."Proba_7" AS "Proba_7",
    t1."Score_7" AS "Score_7",
    t1."Exp_Score_7" AS "Exp_Score_7",
    ( t1."Exp_Score_0" + t1."Exp_Score_1" + t1."Exp_Score_2" + t1."Exp_Score_3" + t1."Exp_Score_4" + t1."Exp_Score_5" + t1."Exp_Score_6" + t1."Exp_Score_7" ) AS "Sum_Exp"
  FROM
   ( SELECT t."index" as "index",
        t."Proba_0" AS "Proba_0",
        t."Score_0" AS "Score_0",
        t."Proba_1" AS "Proba_1",
        t."Score_1" AS "Score_1",
        t."Proba_2" AS "Proba_2",
        t."Score_2" AS "Score_2",
        t."Proba_3" AS "Proba_3",
        t."Score_3" AS "Score_3",
        t."Proba_4" AS "Proba_4",
        t."Score_4" AS "Score_4",
        t."Proba_5" AS "Proba_5",
        t."Score_5" AS "Score_5",
        t."Proba_6" AS "Proba_6",
        t."Score_6" AS "Score_6",
        t."Proba_7" AS "Proba_7",
        t."Score_7" AS "Score_7",
        EXP(t."Score_0" - t."Greatest_Score") as "Exp_Score_0",
        EXP(t."Score_1" - t."Greatest_Score") as "Exp_Score_1",
        EXP(t."Score_2" - t."Greatest_Score") as "Exp_Score_2",
        EXP(t."Score_3" - t."Greatest_Score") as "Exp_Score_3",
        EXP(t."Score_4" - t."Greatest_Score") as "Exp_Score_4",
        EXP(t."Score_5" - t."Greatest_Score") as "Exp_Score_5",
        EXP(t."Score_6" - t."Greatest_Score") as "Exp_Score_6",
        EXP(t."Score_7" - t."Greatest_Score") as "Exp_Score_7"
    FROM
       soft_max_orig_cte AS t
  ) AS t1
),
soft_max_cte AS 
( SELECT t1."index" AS "index",
    t1."Exp_Score_0" / t1."Sum_Exp" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_1" / t1."Sum_Exp" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_2" / t1."Sum_Exp" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_3" / t1."Sum_Exp" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_4" / t1."Sum_Exp" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_5" / t1."Sum_Exp" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_6" / t1."Sum_Exp" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_7" / t1."Sum_Exp" AS "Proba_7",
    t1."Score_7" AS "Score_7"
 FROM 
   soft_max_cte_with_exp_deltas as t1
),
arg_max_cte_with_max_proba AS 
( SELECT t."index" AS "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    GREATEST( t."Proba_0", t."Proba_1", t."Proba_2", t."Proba_3", t."Proba_4", t."Proba_5", t."Proba_6", t."Proba_7" ) AS "Max_Proba",
    GREATEST( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7" ) AS "Max_Score"
  FROM
     "soft_max_cte" AS t
),
arg_max_cte_with_max_proba_idx AS 
( SELECT t."index" as "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    CASE WHEN(t."Proba_0" = t."Max_Proba") THEN 0 else NULL END AS "max_idx_0",
    CASE WHEN(t."Proba_1" = t."Max_Proba") THEN 1 else NULL END AS "max_idx_1",
    CASE WHEN(t."Proba_2" = t."Max_Proba") THEN 2 else NULL END AS "max_idx_2",
    CASE WHEN(t."Proba_3" = t."Max_Proba") THEN 3 else NULL END AS "max_idx_3",
    CASE WHEN(t."Proba_4" = t."Max_Proba") THEN 4 else NULL END AS "max_idx_4",
    CASE WHEN(t."Proba_5" = t."Max_Proba") THEN 5 else NULL END AS "max_idx_5",
    CASE WHEN(t."Proba_6" = t."Max_Proba") THEN 6 else NULL END AS "max_idx_6",
    CASE WHEN(t."Proba_7" = t."Max_Proba") THEN 7 else NULL END AS "max_idx_7",
    t."Max_Proba" AS "Max_Proba",
    t."Max_Score" AS "Max_Score"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Proba_2" AS "Proba_2",
     t."Score_2" AS "Score_2",
     t."Proba_3" AS "Proba_3",
     t."Score_3" AS "Score_3",
     t."Proba_4" AS "Proba_4",
     t."Score_4" AS "Score_4",
     t."Proba_5" AS "Proba_5",
     t."Score_5" AS "Score_5",
     t."Proba_6" AS "Proba_6",
     t."Score_6" AS "Score_6",
     t."Proba_7" AS "Proba_7",
     t."Score_7" AS "Score_7",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1", t."max_idx_2", t."max_idx_3", t."max_idx_4", t."max_idx_5", t."max_idx_6", t."max_idx_7" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."Score_4" AS "Score_4",
  arg_max_cte."Proba_4" AS "Proba_4",
  CASE WHEN (arg_max_cte."Proba_4" IS NULL OR arg_max_cte."Proba_4" > 0.0) THEN LN( arg_max_cte."Proba_4" ) ELSE -1.79769313486231e+308 END AS "LogProba_4",
  arg_max_cte."Score_5" AS "Score_5",
  arg_max_cte."Proba_5" AS "Proba_5",
  CASE WHEN (arg_max_cte."Proba_5" IS NULL OR arg_max_cte."Proba_5" > 0.0) THEN LN( arg_max_cte."Proba_5" ) ELSE -1.79769313486231e+308 END AS "LogProba_5",
  arg_max_cte."Score_6" AS "Score_6",
  arg_max_cte."Proba_6" AS "Proba_6",
  CASE WHEN (arg_max_cte."Proba_6" IS NULL OR arg_max_cte."Proba_6" > 0.0) THEN LN( arg_max_cte."Proba_6" ) ELSE -1.79769313486231e+308 END AS "LogProba_6",
  arg_max_cte."Score_7" AS "Score_7",
  arg_max_cte."Proba_7" AS "Proba_7",
  CASE WHEN (arg_max_cte."Proba_7" IS NULL OR arg_max_cte."Proba_7" > 0.0) THEN LN( arg_max_cte."Proba_7" ) ELSE -1.79769313486231e+308 END AS "LogProba_7",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte