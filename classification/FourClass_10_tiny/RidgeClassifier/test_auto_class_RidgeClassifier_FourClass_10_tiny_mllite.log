         X_0       X_1       X_2  ...       X_8       X_9  target
0  -1.050659  0.920640 -0.455125  ... -0.010797 -1.586949       2
1   1.869880 -2.312190 -1.153852  ... -1.648043  2.109906       3
2  -0.124049  0.768644 -1.040184  ...  1.247335 -1.413962       1
3   0.928858 -1.177375  0.542731  ...  0.485529  1.106564       0
4  -1.598324  1.482463  1.664691  ...  1.816533  0.637000       3
5  -1.750210  1.576099  0.286503  ... -2.267550  1.213184       0
6   0.476411  0.555172  2.004011  ...  0.821823  0.485550       3
7  -0.049861  1.019062 -0.239901  ...  0.642133  0.460004       1
8  -0.649409  1.030112  0.590313  ... -0.635514  0.255228       0
9   0.914030 -0.385815  2.120265  ... -0.152956 -0.427271       2
10 -1.979466  2.354344 -0.380747  ...  2.837784  0.027100       3
11 -1.368644  0.716127  0.307297  ...  1.172710  1.728196       1
12  1.184632 -1.691100 -0.781676  ... -1.114233  0.622367       3
13 -1.728087  2.393295  0.055107  ...  0.248741  1.048002       1
14 -0.128543  1.029262 -1.338428  ... -0.885099  0.307255       2
15  0.420960  0.508218  0.792587  ...  0.458008  1.340859       2

[16 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-1.0506592   0.92064023 -0.4551253  -0.05012989 -0.19162714  0.5843286
   0.9430313   1.0213077  -0.01079692 -1.5869486 ]
 [ 1.86988    -2.3121896  -1.1538523   1.292078   -1.061729    2.0429258
   1.284271   -1.3353989  -1.6480426   2.1099062 ]
 [-0.1240493   0.7686444  -1.040184   -1.0419097  -0.5159428   1.4802165
  -1.7200696   0.34235197  1.2473352  -1.4139622 ]
 [ 0.9288579  -1.1773754   0.5427306   1.248167   -0.7323589   0.6922126
   0.362028   -0.05373104  0.48552942  1.1065644 ]
 [-1.5983242   1.4824632   1.6646907  -0.7911312  -0.3269162  -0.07355959
  -3.3526254  -1.3474813   1.8165325   0.6370003 ]] [2 3 1 0 3]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 6 6
('OPERATION_END_ELAPSED', 0.012, 'TRAINING')
{ ,   }
{ ,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 16, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.473434,
			"coeffs" : [ -0.134872, 0.014711, 0.100101, 0.060697, -0.076689, -0.166755, 0.093890, -0.155452, -0.195004, -0.009150 ]
		},
		"class_1" : {
			"intercept" : -0.652669,
			"coeffs" : [ -0.019153, 0.075403, -0.137828, -0.013920, -0.104139, 0.107722, 0.009723, 0.393580, 0.186228, 0.132176 ]
		},
		"class_2" : {
			"intercept" : 0.412964,
			"coeffs" : [ 0.157958, -0.125283, -0.228915, 0.078264, 0.560754, -0.731915, 0.044269, 0.008193, -0.030522, -0.233614 ]
		},
		"class_3" : {
			"intercept" : -1.286860,
			"coeffs" : [ -0.003933, 0.035169, 0.266642, -0.125041, -0.379927, 0.790948, -0.147882, -0.246321, 0.039298, 0.110588 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_tiny.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 16, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.473434,
			"coeffs" : [ -0.134872, 0.014711, 0.100101, 0.060697, -0.076689, -0.166755, 0.093890, -0.155452, -0.195004, -0.009150 ]
		},
		"class_1" : {
			"intercept" : -0.652669,
			"coeffs" : [ -0.019153, 0.075403, -0.137828, -0.013920, -0.104139, 0.107722, 0.009723, 0.393580, 0.186228, 0.132176 ]
		},
		"class_2" : {
			"intercept" : 0.412964,
			"coeffs" : [ 0.157958, -0.125283, -0.228915, 0.078264, 0.560754, -0.731915, 0.044269, 0.008193, -0.030522, -0.233614 ]
		},
		"class_3" : {
			"intercept" : -1.286860,
			"coeffs" : [ -0.003933, 0.035169, 0.266642, -0.125041, -0.379927, 0.790948, -0.147882, -0.246321, 0.039298, 0.110588 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1, 2, 3 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 16
	},
	"equations" : 	{
		"class_0" : 	{
			"coeffs" : [ -0.134872, 0.014711, 0.100101, 0.060697, -0.076689, -0.166755, 0.09389, -0.155452, -0.195004, -0.00915 ],
			"intercept" : -0.473434
		},
		"class_1" : 	{
			"coeffs" : [ -0.019153, 0.075403, -0.137828, -0.01392, -0.104139, 0.107722, 0.009723, 0.39358, 0.186228, 0.132176 ],
			"intercept" : -0.652669
		},
		"class_2" : 	{
			"coeffs" : [ 0.157958, -0.125283, -0.228915, 0.078264, 0.560754, -0.731915, 0.044269, 0.008193, -0.030522, -0.233614 ],
			"intercept" : 0.412964
		},
		"class_3" : 	{
			"coeffs" : [ -0.003933, 0.035169, 0.266642, -0.125041, -0.379927, 0.790948, -0.147882, -0.246321, 0.039298, 0.110588 ],
			"intercept" : -1.28686
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.2174 0.2892 0.4045 0.0889]
 [0.2184 0.1316 0.1086 0.5414]
 [0.1028 0.3437 0.1808 0.3727]
 [0.224  0.2541 0.2508 0.2712]
 [0.2062 0.1531 0.136  0.5047]
 [0.5373 0.1045 0.1623 0.1959]
 [0.1345 0.2767 0.1243 0.4644]
 [0.1255 0.3386 0.3437 0.1921]
 [0.2877 0.1873 0.355  0.17  ]
 [0.1929 0.0467 0.629  0.1314]
 [0.1032 0.2658 0.1432 0.4878]
 [0.1789 0.3757 0.0831 0.3624]
 [0.189  0.1552 0.1657 0.4902]
 [0.2053 0.6038 0.1264 0.0645]
 [0.1484 0.2433 0.4874 0.1209]
 [0.2146 0.1925 0.3748 0.2181]]
(16, 4)
(16, 4) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_tiny', 'size': 16, 'accuracy': 0.75, 'auc': 1.0}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_tiny.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_tiny', 'training_time_in_sec': 0.012, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_tiny.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.473434 + -0.134872 * X_0 + 0.014711 * X_1 + 0.100101 * X_2 + 0.060697 * X_3 + -0.076689 * X_4 + -0.166755 * X_5 + 0.093890 * X_6 + -0.155452 * X_7 + -0.195004 * X_8 + -0.009150 * X_9 AS "Score_0", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "LogProba_0",
   -0.652669 + -0.019153 * X_0 + 0.075403 * X_1 + -0.137828 * X_2 + -0.013920 * X_3 + -0.104139 * X_4 + 0.107722 * X_5 + 0.009723 * X_6 + 0.393580 * X_7 + 0.186228 * X_8 + 0.132176 * X_9 AS "Score_1", CAST(NULL AS FLO
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
   WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2"
   WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
         X_0       X_1       X_2       X_3  ...       X_7       X_8       X_9  KEY
0  -1.050659  0.920640 -0.455125 -0.050130  ...  1.021308 -0.010797 -1.586949    0
1   1.869880 -2.312190 -1.153852  1.292078  ... -1.335399 -1.648043  2.109906    1
2  -0.124049  0.768644 -1.040184 -1.041910  ...  0.342352  1.247335 -1.413962    2
3   0.928858 -1.177375  0.542731  1.248167  ... -0.053731  0.485529  1.106564    3
4  -1.598324  1.482463  1.664691 -0.791131  ... -1.347481  1.816532  0.637000    4
5  -1.750210  1.576099  0.286503 -1.740885  ... -1.160993 -2.267550  1.213184    5
6   0.476411  0.555172  2.004011 -1.439637  ...  0.803645  0.821823  0.485550    6
7  -0.049861  1.019062 -0.239901 -1.762634  ...  0.600685  0.642133  0.460004    7
8  -0.649409  1.030112  0.590313 -1.432318  ... -0.064296 -0.635514  0.255228    8
9   0.914030 -0.385815  2.120265 -1.074814  ... -1.398672 -0.152956 -0.427271    9
10 -1.979466  2.354344 -0.380747 -1.758169  ... -1.103278  2.837784  0.027100   10
11 -1.368644  0.716127  0.307297  0.899080  ...  0.215110  1.172710  1.728197   11
12  1.184632 -1.691100 -0.781676  1.327282  ... -0.742383 -1.114233  0.622367   12
13 -1.728087  2.393295  0.055107 -1.740847  ...  2.200070  0.248741  1.048002   13
14 -0.128543  1.029262 -1.338428 -2.145117  ...  0.340163 -0.885099  0.307255   14
15  0.420960  0.508218  0.792587 -1.824423  ... -0.576551  0.458008  1.340859   15

[16 rows x 11 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
    index   Score_0   Proba_0  ...  LogProba_3  Decision  DecisionProba
0       0 -0.503128  0.217365  ...   -2.420457         2       0.404509
1       1 -0.425725  0.218398  ...   -0.613660         3       0.541366
2       2 -1.265041  0.102784  ...   -0.987020         3       0.372686
3       3 -0.607671  0.223956  ...   -1.305016         3       0.271168
4       4 -0.545470  0.206159  ...   -0.683718         3       0.504737
5       5  0.460965  0.537337  ...   -1.630291         0       0.537337
6       6 -0.970310  0.134532  ...   -0.766941         3       0.464432
7       7 -1.106412  0.125515  ...   -1.649604         2       0.343723
8       8 -0.313861  0.287660  ...   -1.771799         2       0.355031
9       9 -0.344923  0.192931  ...   -2.029845         2       0.628969
10     10 -1.206626  0.103210  ...   -0.717788         3       0.487830
11     11 -0.670375  0.178863  ...   -1.015073         1       0.375668
12     12 -0.656125  0.188975  ...   -0.712993         3       0.490175
13     13 -0.359233  0.205275  ...   -2.740772         1       0.603757
14     14 -0.869633  0.148407  ...   -2.112787         2       0.487358
15     15 -0.616419  0.214571  ...   -1.522796         2       0.374793

[16 rows x 15 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Score_2', 'Proba_2', 'LogProba_2', 'Score_3', 'Proba_3',
       'LogProba_3', 'Decision', 'DecisionProba'],
      dtype='object')
    index   Score_0  SQL_Proba_0  ...  Py_Proba_2  Py_Proba_3  Py_Decision
0       0 -0.503128     0.217365  ...    0.404509    0.088881            2
1       1 -0.425725     0.218398  ...    0.108636    0.541366            3
2       2 -1.265041     0.102784  ...    0.180821    0.372685            3
3       3 -0.607671     0.223956  ...    0.250811    0.271168            3
4       4 -0.545470     0.206159  ...    0.136006    0.504737            3
5       5  0.460965     0.537337  ...    0.162294    0.195873            0
6       6 -0.970310     0.134532  ...    0.124314    0.464432            3
7       7 -1.106412     0.125515  ...    0.343723    0.192126            2
8       8 -0.313861     0.287660  ...    0.355031    0.170027            2
9       9 -0.344923     0.192931  ...    0.628968    0.131356            2
10     10 -1.206626     0.103210  ...    0.143205    0.487830            3
11     11 -0.670375     0.178863  ...    0.083094    0.362376            1
12     12 -0.656125     0.188975  ...    0.165693    0.490175            3
13     13 -0.359233     0.205275  ...    0.126448    0.064520            1
14     14 -0.869633     0.148407  ...    0.487358    0.120900            2
15     15 -0.616419     0.214571  ...    0.374794    0.218101            2

[16 rows x 20 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
