READING_CSV FourClass_10_original ['data/original/FourClass_10.csv']
           X_0       X_1       X_2  ...       X_8       X_9  target
0    -1.104915  0.852920  0.507679  ... -1.472978 -1.793182       0
1     1.845877 -1.230132  0.868872  ...  0.362403 -0.619445       3
2    -2.837179  1.477195  0.565303  ...  1.102744  1.483759       1
3    -0.817915  0.349464 -0.778337  ... -0.344547 -0.450057       3
4     2.867865 -1.912016  0.005109  ... -0.616466 -0.572385       0
...        ...       ...       ...  ...       ...       ...     ...
1019 -2.095001  1.294078 -1.552071  ... -3.931552 -1.074179       2
1020 -1.743265  0.891375  1.671782  ... -0.360963  0.011059       3
1021 -1.760887  1.921145  0.350258  ...  2.763857 -0.710372       3
1022 -1.134328  1.876722  2.781903  ...  2.604618  0.626265       3
1023 -0.770972  1.261518  1.808595  ... -1.336243  0.434694       2

[1024 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-1.10491490e+00  8.52919877e-01  5.07678568e-01 -3.81407499e-01
  -6.32111073e-01  6.43055558e-01  1.64998901e+00  4.79870588e-01
  -1.47297835e+00 -1.79318225e+00]
 [ 1.84587657e+00 -1.23013234e+00  8.68871808e-01 -1.36471283e+00
   1.38019109e+00 -6.07883871e-01 -4.83270741e+00 -3.81645823e+00
   3.62403333e-01 -6.19445145e-01]
 [-2.83717918e+00  1.47719467e+00  5.65303147e-01  1.38211691e+00
   1.26869273e+00 -1.04379274e-01  2.91604996e-01 -1.22561082e-02
   1.10274434e+00  1.48375893e+00]
 [-8.17914605e-01  3.49463820e-01 -7.78337240e-01  3.11694108e-02
   1.09836125e+00 -2.34135496e-03 -4.48572785e-01 -1.05435896e+00
  -3.44547480e-01 -4.50056911e-01]
 [ 2.86786485e+00 -1.91201603e+00  5.10907173e-03 -8.97717237e-01
  -4.13689524e-01  1.13818514e+00 -1.69676435e+00 -1.53572273e+00
  -6.16465807e-01 -5.72385132e-01]] [0 3 1 3 0]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 6 6
('OPERATION_END_ELAPSED', 0.02, 'TRAINING')
{ ,   }
{ ,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W14", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.476820,
			"coeffs" : [ -0.080516, -0.023581, 0.019267, 0.120748, -0.023388, -0.024345, -0.008040, -0.117158, 0.013197, -0.034930 ]
		},
		"class_1" : {
			"intercept" : -0.468939,
			"coeffs" : [ 0.083195, 0.035626, 0.001254, -0.049244, 0.027638, -0.010272, -0.011532, 0.242909, 0.184741, 0.040190 ]
		},
		"class_2" : {
			"intercept" : -0.549862,
			"coeffs" : [ 0.070768, 0.013034, -0.009926, -0.169575, -0.036088, -0.002820, 0.041183, 0.022116, -0.193116, -0.008953 ]
		},
		"class_3" : {
			"intercept" : -0.504380,
			"coeffs" : [ -0.073481, -0.025128, -0.010595, 0.098029, 0.031839, 0.037437, -0.021588, -0.147879, -0.004793, 0.003692 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_original.json'

RELOADING_MODEL_FROM_JSON_START ('FourClass_10_original', 'RidgeClassifier')
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W14", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.476820,
			"coeffs" : [ -0.080516, -0.023581, 0.019267, 0.120748, -0.023388, -0.024345, -0.008040, -0.117158, 0.013197, -0.034930 ]
		},
		"class_1" : {
			"intercept" : -0.468939,
			"coeffs" : [ 0.083195, 0.035626, 0.001254, -0.049244, 0.027638, -0.010272, -0.011532, 0.242909, 0.184741, 0.040190 ]
		},
		"class_2" : {
			"intercept" : -0.549862,
			"coeffs" : [ 0.070768, 0.013034, -0.009926, -0.169575, -0.036088, -0.002820, 0.041183, 0.022116, -0.193116, -0.008953 ]
		},
		"class_3" : {
			"intercept" : -0.504380,
			"coeffs" : [ -0.073481, -0.025128, -0.010595, 0.098029, 0.031839, 0.037437, -0.021588, -0.147879, -0.004793, 0.003692 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1, 2, 3 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 1024
	},
	"equations" : 	{
		"class_0" : 	{
			"coeffs" : [ -0.080516, -0.023581, 0.019267, 0.120748, -0.023388, -0.024345, -0.00804, -0.117158, 0.013197, -0.03493 ],
			"intercept" : -0.47682
		},
		"class_1" : 	{
			"coeffs" : [ 0.083195, 0.035626, 0.001254, -0.049244, 0.027638, -0.010272, -0.011532, 0.242909, 0.184741, 0.04019 ],
			"intercept" : -0.468939
		},
		"class_2" : 	{
			"coeffs" : [ 0.070768, 0.013034, -0.009926, -0.169575, -0.036088, -0.00282, 0.041183, 0.022116, -0.193116, -0.008953 ],
			"intercept" : -0.549862
		},
		"class_3" : 	{
			"coeffs" : [ -0.073481, -0.025128, -0.010595, 0.098029, 0.031839, 0.037437, -0.021588, -0.147879, -0.004793, 0.003692 ],
			"intercept" : -0.50438
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W14" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
RELOADING_MODEL_FROM_JSON_END ('FourClass_10_original', 'RidgeClassifier')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.001, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.001, 'PREDICT')
[[0.2506 0.1837 0.3431 0.2226]
 [0.2996 0.1312 0.2093 0.3599]
 [0.3205 0.2482 0.111  0.3203]
 ...
 [0.3299 0.2658 0.1227 0.2816]
 [0.2209 0.4219 0.1387 0.2185]
 [0.2123 0.1716 0.3806 0.2355]]
(1024, 4)
(1024, 4) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_original', 'size': 1024, 'accuracy': 0.5771484375, 'auc': 0.8119532588526955}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_original.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_original', 'training_time_in_sec': 0.02, 'prediction_time_in_sec': 0.001}

MODEL_EXPLANATION_START
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 0 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 1 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 2 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 3 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 4 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 5 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 6 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 7 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 8 10
PROGRESS_REPORT_ELAPSED_TOTAL 'MONTE_CARLO_CLASSIFICATION_EXPLAINER' 9 10
{
   "Contributions" : {
      "X_0" : [ -0.000939, 0.001458, -0.000374, -0.000145 ],
      "X_1" : [ 0.000428, -0.000977, 0.000389, 0.000159 ],
      "X_2" : [ 0.000360, -0.000031, -0.000008, -0.000321 ],
      "X_3" : [ 0.005612, -0.002253, -0.007576, 0.004217 ],
      "X_4" : [ -0.000050, -0.000294, 0.000752, -0.000408 ],
      "X_5" : [ -0.002262, -0.000593, -0.000313, 0.003168 ],
      "X_6" : [ -0.000915, -0.000506, 0.004222, -0.002802 ],
      "X_7" : [ -0.010979, 0.023199, 0.002560, -0.014780 ],
      "X_8" : [ 0.000514, 0.007336, -0.007697, -0.000153 ],
      "X_9" : [ 0.000336, -0.000336, 0.000035, -0.000035 ]   
   },
   "Most_Contributive_Features_By_Class" : {
      "class_0" : [ 7, 3, 5, 0, 6, 8, 1, 2, 9, 4 ],
      "class_1" : [ 7, 8, 3, 0, 1, 5, 6, 9, 4, 2 ],
      "class_2" : [ 8, 3, 6, 7, 4, 1, 0, 5, 9, 2 ],
      "class_3" : [ 7, 3, 5, 6, 4, 2, 1, 8, 0, 9 ]
   }
}
WRITING_EXPLAIN_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_original_explain.json'

MODEL_EXPLANATION_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_original_duckdb.sql'



SQL_OUT_PUT_FIRST_LINES_START ('FourClass_10_original', 'RidgeClassifier', 'duckdb')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "FourClass_10_original" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.476820 + -0.080516 * t."X_0" + -0.023581 * t."X_1" + 0.019267 * t."X_2" + 0.120748 * t."X_3" + -0.023388 * t."X_4" + -0.024345 * t."X_5" + -0.008040 * t."X_6" + -0.117158 * t."X_7" + 0.013197 * t."X_8" + -0.034930 * t."X_9" AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   -0.468939 + 0.083195 * t."X_0" + 0.035626 * t."X_1" + 0.001254 * t."X_2" + -0.049244 * t."X_3" + 0.027638 * t."X_4" + -0.010272 * t."X_5" + -0.011532 * t."X_6" + 0.242909 * t
SQL_OUT_PUT_FIRST_LINES_END ('FourClass_10_original', 'RidgeClassifier', 'duckdb')
SQL_OUT_PUT_LAST_LINES_START ('FourClass_10_original', 'RidgeClassifier', 'duckdb')
ore_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('FourClass_10_original', 'RidgeClassifier', 'duckdb') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 1024 entries, 0 to 1023
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     1024 non-null   float32
 1   X_1     1024 non-null   float32
 2   X_2     1024 non-null   float32
 3   X_3     1024 non-null   float32
 4   X_4     1024 non-null   float32
 5   X_5     1024 non-null   float32
 6   X_6     1024 non-null   float32
 7   X_7     1024 non-null   float32
 8   X_8     1024 non-null   float32
 9   X_9     1024 non-null   float32
dtypes: float32(10)
memory usage: 48.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -1.104915  0.852920  0.507679  ...  0.479871 -1.472978 -1.793182
1      1.845877 -1.230132  0.868872  ... -3.816458  0.362403 -0.619445
2     -2.837179  1.477195  0.565303  ... -0.012256  1.102744  1.483759
3     -0.817915  0.349464 -0.778337  ... -1.054359 -0.344547 -0.450057
4      2.867865 -1.912016  0.005109  ... -1.535723 -0.616466 -0.572385
...         ...       ...       ...  ...       ...       ...       ...
1019  -2.095001  1.294078 -1.552071  ...  1.112683 -3.931551 -1.074179
1020  -1.743265  0.891375  1.671782  ...  0.265348 -0.360963  0.011059
1021  -1.760887  1.921145  0.350258  ... -1.772515  2.763857 -0.710372
1022  -1.134328  1.876722  2.781903  ... -0.109672  2.604619  0.626265
1023  -0.770972  1.261518  1.808595  ... -0.898929 -1.336243  0.434694

[1024 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1024 entries, 0 to 1023
Data columns (total 15 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          1024 non-null   int64  
 1   Score_0        1024 non-null   float64
 2   Proba_0        1024 non-null   float64
 3   LogProba_0     1024 non-null   float64
 4   Score_1        1024 non-null   float64
 5   Proba_1        1024 non-null   float64
 6   LogProba_1     1024 non-null   float64
 7   Score_2        1024 non-null   float64
 8   Proba_2        1024 non-null   float64
 9   LogProba_2     1024 non-null   float64
 10  Score_3        1024 non-null   float64
 11  Proba_3        1024 non-null   float64
 12  LogProba_3     1024 non-null   float64
 13  Decision       1024 non-null   int64  
 14  DecisionProba  1024 non-null   float64
dtypes: float64(13), int64(2)
memory usage: 120.1 KB
      index   Score_0   Proba_0  ...  LogProba_3  Decision  DecisionProba
0         0 -0.471403  0.250574  ...   -1.502182         2       0.343069
1         1 -0.249558  0.299637  ...   -1.021854         3       0.359927
2         2 -0.170750  0.320517  ...   -1.138396         0       0.320517
3         3 -0.317763  0.292020  ...   -1.154453         3       0.315230
4         4 -0.583552  0.224829  ...   -1.369978         2       0.334051
...     ...       ...       ...  ...         ...       ...            ...
1019   1019 -0.638527  0.187257  ...   -1.594224         2       0.496283
1020   1020 -0.311401  0.298064  ...   -1.271115         0       0.298064
1021   1021 -0.159013  0.329945  ...   -1.267372         0       0.329945
1022   1022 -0.542809  0.220882  ...   -1.520896         1       0.421865
1023   1023 -0.618575  0.212318  ...   -1.446076         2       0.380593

[1024 rows x 15 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Score_2', 'Proba_2', 'LogProba_2', 'Score_3', 'Proba_3',
       'LogProba_3', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_2  Py_Proba_3  Py_Decision
1008   1008 -0.197743     0.324381  ...    0.215762    0.305082            0
1009   1009 -0.830411     0.168551  ...    0.249344    0.178341            1
1010   1010 -0.213130     0.322590  ...    0.161430    0.281377            0
1011   1011 -0.926945     0.143458  ...    0.407737    0.122372            2
1012   1012 -0.720362     0.186861  ...    0.207035    0.177545            1
1013   1013 -1.385881     0.070460  ...    0.519115    0.068082            2
1014   1014 -0.317199     0.278570  ...    0.112106    0.302675            1
1015   1015 -0.580987     0.217310  ...    0.410356    0.195281            2
1016   1016 -0.212924     0.288328  ...    0.285953    0.349690            3
1017   1017 -0.414454     0.245776  ...    0.410315    0.234169            2
1018   1018 -0.545772     0.234769  ...    0.333491    0.217750            2
1019   1019 -0.638527     0.187257  ...    0.496282    0.203066            2
1020   1020 -0.311401     0.298064  ...    0.208970    0.280519            0
1021   1021 -0.159013     0.329945  ...    0.122707    0.281571            0
1022   1022 -0.542809     0.220882  ...    0.138737    0.218516            1
1023   1023 -0.618575     0.212318  ...    0.380593    0.235492            2

[16 rows x 20 columns]
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_0', 'SQL_Proba_0') 2.879439488686204e-07
      Py_Proba_0  SQL_Proba_0   SQL_Error_0
1008    0.324381     0.324381  2.120471e-08
1009    0.168551     0.168551  1.254119e-07
1010    0.322589     0.322590 -4.707242e-07
1011    0.143459     0.143458  4.104302e-07
1012    0.186861     0.186861  8.706902e-08
1013    0.070460     0.070460  6.048725e-07
1014    0.278570     0.278570 -1.830221e-07
1015    0.217310     0.217310  1.467898e-07
1016    0.288328     0.288328 -6.420440e-07
1017    0.245776     0.245776  3.518134e-07
1018    0.234769     0.234769 -3.566387e-08
1019    0.187257     0.187257  7.319441e-07
1020    0.298064     0.298064  2.222372e-07
1021    0.329945     0.329945 -5.190374e-07
1022    0.220882     0.220882  1.515196e-07
1023    0.212318     0.212318  2.233270e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_1', 'SQL_Proba_1') 2.5896585129957044e-07
      Py_Proba_1  SQL_Proba_1   SQL_Error_1
1008    0.154775     0.154776 -3.472660e-07
1009    0.403764     0.403764 -1.115772e-07
1010    0.234605     0.234605  3.094748e-08
1011    0.326433     0.326433 -1.856177e-07
1012    0.428559     0.428559  6.845961e-08
1013    0.342343     0.342343  1.709731e-07
1014    0.306649     0.306649 -4.430975e-09
1015    0.177054     0.177054 -2.600568e-07
1016    0.076030     0.076030 -1.296993e-08
1017    0.109739     0.109739 -2.192913e-07
1018    0.213990     0.213990  2.018541e-07
1019    0.113394     0.113394 -1.050585e-07
1020    0.212447     0.212448 -3.201379e-07
1021    0.265777     0.265777 -1.303453e-07
1022    0.421865     0.421865 -6.732562e-07
1023    0.171596     0.171597 -5.479000e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_2', 'SQL_Proba_2') 2.828598091591546e-07
      Py_Proba_2  SQL_Proba_2   SQL_Error_2
1008    0.215762     0.215762  2.895342e-07
1009    0.249344     0.249344  1.065573e-07
1010    0.161430     0.161429  3.819865e-07
1011    0.407737     0.407737 -3.235828e-07
1012    0.207035     0.207035 -3.352045e-07
1013    0.519115     0.519116 -7.247604e-07
1014    0.112106     0.112106  2.377784e-07
1015    0.410356     0.410356  1.621777e-07
1016    0.285953     0.285952  9.235199e-07
1017    0.410315     0.410315 -2.907667e-07
1018    0.333491     0.333491 -2.867953e-09
1019    0.496282     0.496283 -4.841328e-07
1020    0.208970     0.208970  2.141045e-08
1021    0.122707     0.122707  3.473612e-07
1022    0.138737     0.138737  4.415698e-07
1023    0.380593     0.380593  5.296415e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_3', 'SQL_Proba_3') 1.5128245451292315e-07
      Py_Proba_3  SQL_Proba_3   SQL_Error_3
1008    0.305082     0.305082  1.557364e-07
1009    0.178341     0.178341 -2.097990e-07
1010    0.281377     0.281376  5.779024e-08
1011    0.122372     0.122372  1.658255e-07
1012    0.177545     0.177545  1.349724e-07
1013    0.068082     0.068082  3.832174e-08
1014    0.302675     0.302675 -6.522645e-08
1015    0.195281     0.195281 -9.361423e-08
1016    0.349690     0.349690 -2.759565e-07
1017    0.234169     0.234169  1.135410e-07
1018    0.217750     0.217750 -1.186188e-07
1019    0.203066     0.203066 -1.129506e-07
1020    0.280519     0.280519  6.158912e-08
1021    0.281571     0.281571  4.286814e-07
1022    0.218516     0.218516  1.397714e-07
1023    0.235492     0.235493 -1.603650e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('FourClass_10_original', 'RidgeClassifier', 'duckdb', 'Success')
      Py_Decision  SQL_Decision
1008            0             0
1009            1             1
1010            0             0
1011            2             2
1012            1             1
1013            2             2
1014            1             1
1015            2             2
1016            3             3
1017            2             2
1018            2             2
1019            2             2
1020            0             0
1021            0             0
1022            1             1
1023            2             2
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_original_sqlite.sql'



SQL_OUT_PUT_FIRST_LINES_START ('FourClass_10_original', 'RidgeClassifier', 'sqlite')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "FourClass_10_original" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.476820 + -0.080516 * t."X_0" + -0.023581 * t."X_1" + 0.019267 * t."X_2" + 0.120748 * t."X_3" + -0.023388 * t."X_4" + -0.024345 * t."X_5" + -0.008040 * t."X_6" + -0.117158 * t."X_7" + 0.013197 * t."X_8" + -0.034930 * t."X_9" AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   -0.468939 + 0.083195 * t."X_0" + 0.035626 * t."X_1" + 0.001254 * t."X_2" + -0.049244 * t."X_3" + 0.027638 * t."X_4" + -0.010272 * t."X_5" + -0.011532 * t."X_6" + 0.242909 * t
SQL_OUT_PUT_FIRST_LINES_END ('FourClass_10_original', 'RidgeClassifier', 'sqlite')
SQL_OUT_PUT_LAST_LINES_START ('FourClass_10_original', 'RidgeClassifier', 'sqlite')
ore_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('FourClass_10_original', 'RidgeClassifier', 'sqlite') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 1024 entries, 0 to 1023
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     1024 non-null   float32
 1   X_1     1024 non-null   float32
 2   X_2     1024 non-null   float32
 3   X_3     1024 non-null   float32
 4   X_4     1024 non-null   float32
 5   X_5     1024 non-null   float32
 6   X_6     1024 non-null   float32
 7   X_7     1024 non-null   float32
 8   X_8     1024 non-null   float32
 9   X_9     1024 non-null   float32
dtypes: float32(10)
memory usage: 48.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -1.104915  0.852920  0.507679  ...  0.479871 -1.472978 -1.793182
1      1.845877 -1.230132  0.868872  ... -3.816458  0.362403 -0.619445
2     -2.837179  1.477195  0.565303  ... -0.012256  1.102744  1.483759
3     -0.817915  0.349464 -0.778337  ... -1.054359 -0.344547 -0.450057
4      2.867865 -1.912016  0.005109  ... -1.535723 -0.616466 -0.572385
...         ...       ...       ...  ...       ...       ...       ...
1019  -2.095001  1.294078 -1.552071  ...  1.112683 -3.931551 -1.074179
1020  -1.743265  0.891375  1.671782  ...  0.265348 -0.360963  0.011059
1021  -1.760887  1.921145  0.350258  ... -1.772515  2.763857 -0.710372
1022  -1.134328  1.876722  2.781903  ... -0.109672  2.604619  0.626265
1023  -0.770972  1.261518  1.808595  ... -0.898929 -1.336243  0.434694

[1024 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1024 entries, 0 to 1023
Data columns (total 15 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          1024 non-null   int64  
 1   Score_0        1024 non-null   float64
 2   Proba_0        1024 non-null   float64
 3   LogProba_0     1024 non-null   float64
 4   Score_1        1024 non-null   float64
 5   Proba_1        1024 non-null   float64
 6   LogProba_1     1024 non-null   float64
 7   Score_2        1024 non-null   float64
 8   Proba_2        1024 non-null   float64
 9   LogProba_2     1024 non-null   float64
 10  Score_3        1024 non-null   float64
 11  Proba_3        1024 non-null   float64
 12  LogProba_3     1024 non-null   float64
 13  Decision       1024 non-null   int64  
 14  DecisionProba  1024 non-null   float64
dtypes: float64(13), int64(2)
memory usage: 120.1 KB
      index   Score_0   Proba_0  ...  LogProba_3  Decision  DecisionProba
0         0 -0.471403  0.250574  ...   -1.502182         2       0.343069
1         1 -0.249558  0.299637  ...   -1.021854         3       0.359927
2         2 -0.170750  0.320517  ...   -1.138396         0       0.320517
3         3 -0.317763  0.292020  ...   -1.154453         3       0.315230
4         4 -0.583553  0.224829  ...   -1.369978         2       0.334051
...     ...       ...       ...  ...         ...       ...            ...
1019   1019 -0.638527  0.187257  ...   -1.594224         2       0.496283
1020   1020 -0.311401  0.298064  ...   -1.271115         0       0.298064
1021   1021 -0.159013  0.329945  ...   -1.267372         0       0.329945
1022   1022 -0.542809  0.220882  ...   -1.520896         1       0.421865
1023   1023 -0.618575  0.212318  ...   -1.446076         2       0.380593

[1024 rows x 15 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Score_2', 'Proba_2', 'LogProba_2', 'Score_3', 'Proba_3',
       'LogProba_3', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_2  Py_Proba_3  Py_Decision
1008   1008 -0.197743     0.324381  ...    0.215762    0.305082            0
1009   1009 -0.830411     0.168551  ...    0.249344    0.178341            1
1010   1010 -0.213130     0.322590  ...    0.161430    0.281377            0
1011   1011 -0.926945     0.143458  ...    0.407737    0.122372            2
1012   1012 -0.720362     0.186861  ...    0.207035    0.177545            1
1013   1013 -1.385881     0.070460  ...    0.519115    0.068082            2
1014   1014 -0.317199     0.278570  ...    0.112106    0.302675            1
1015   1015 -0.580987     0.217310  ...    0.410356    0.195281            2
1016   1016 -0.212924     0.288328  ...    0.285953    0.349690            3
1017   1017 -0.414454     0.245776  ...    0.410315    0.234169            2
1018   1018 -0.545772     0.234769  ...    0.333491    0.217750            2
1019   1019 -0.638527     0.187257  ...    0.496282    0.203066            2
1020   1020 -0.311401     0.298064  ...    0.208970    0.280519            0
1021   1021 -0.159013     0.329945  ...    0.122707    0.281571            0
1022   1022 -0.542809     0.220882  ...    0.138737    0.218516            1
1023   1023 -0.618575     0.212318  ...    0.380593    0.235492            2

[16 rows x 20 columns]
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_0', 'SQL_Proba_0') 2.8737685917996317e-07
      Py_Proba_0  SQL_Proba_0   SQL_Error_0
1008    0.324381     0.324381  3.558522e-08
1009    0.168551     0.168551  1.229318e-07
1010    0.322589     0.322590 -4.625510e-07
1011    0.143459     0.143458  4.173417e-07
1012    0.186861     0.186861  9.363427e-08
1013    0.070460     0.070460  6.071100e-07
1014    0.278570     0.278570 -1.883098e-07
1015    0.217310     0.217310  1.509668e-07
1016    0.288328     0.288328 -6.401361e-07
1017    0.245776     0.245776  3.727835e-07
1018    0.234769     0.234769 -5.089947e-08
1019    0.187257     0.187257  7.403468e-07
1020    0.298064     0.298064  2.331663e-07
1021    0.329945     0.329945 -5.155664e-07
1022    0.220882     0.220882  1.426516e-07
1023    0.212318     0.212318  2.322367e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_1', 'SQL_Proba_1') 2.58317015915763e-07
      Py_Proba_1  SQL_Proba_1   SQL_Error_1
1008    0.154775     0.154776 -3.565416e-07
1009    0.403764     0.403764 -1.074052e-07
1010    0.234605     0.234605  1.961529e-08
1011    0.326433     0.326433 -1.888102e-07
1012    0.428559     0.428559  8.452905e-08
1013    0.342343     0.342343  1.871866e-07
1014    0.306649     0.306649 -5.844905e-09
1015    0.177054     0.177054 -2.629678e-07
1016    0.076030     0.076030 -1.672512e-08
1017    0.109739     0.109739 -2.190838e-07
1018    0.213990     0.213990  1.930796e-07
1019    0.113394     0.113394 -1.094967e-07
1020    0.212447     0.212448 -3.267770e-07
1021    0.265777     0.265777 -1.331555e-07
1022    0.421865     0.421865 -6.667095e-07
1023    0.171596     0.171597 -5.512099e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_2', 'SQL_Proba_2') 2.80782175071278e-07
      Py_Proba_2  SQL_Proba_2   SQL_Error_2
1008    0.215762     0.215762  2.811630e-07
1009    0.249344     0.249344  1.041643e-07
1010    0.161430     0.161429  3.867738e-07
1011    0.407737     0.407737 -3.280942e-07
1012    0.207035     0.207035 -3.398856e-07
1013    0.519115     0.519116 -7.430130e-07
1014    0.112106     0.112106  2.469308e-07
1015    0.410356     0.410356  1.587741e-07
1016    0.285953     0.285952  9.213136e-07
1017    0.410315     0.410315 -3.227673e-07
1018    0.333491     0.333491 -1.019826e-08
1019    0.496282     0.496283 -5.099190e-07
1020    0.208970     0.208970  1.831946e-08
1021    0.122707     0.122707  3.358122e-07
1022    0.138737     0.138737  4.272431e-07
1023    0.380593     0.380593  5.285911e-07
MLLITE_CLASS_SQL_ERROR ('FourClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_3', 'SQL_Proba_3') 1.5080190283322273e-07
      Py_Proba_3  SQL_Proba_3   SQL_Error_3
1008    0.305082     0.305082  1.590027e-07
1009    0.178341     0.178341 -2.090979e-07
1010    0.281377     0.281376  5.616187e-08
1011    0.122372     0.122372  1.666179e-07
1012    0.177545     0.177545  1.170188e-07
1013    0.068082     0.068082  3.812332e-08
1014    0.302675     0.302675 -6.767719e-08
1015    0.195281     0.195281 -9.147664e-08
1016    0.349690     0.349690 -2.719030e-07
1017    0.234169     0.234169  1.243641e-07
1018    0.217750     0.217750 -8.727843e-08
1019    0.203066     0.203066 -9.112872e-08
1020    0.280519     0.280519  6.039014e-08
1021    0.281571     0.281571  4.395695e-07
1022    0.218516     0.218516  1.564194e-07
1023    0.235492     0.235493 -1.649145e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('FourClass_10_original', 'RidgeClassifier', 'sqlite', 'Success')
      Py_Decision  SQL_Decision
1008            0             0
1009            1             1
1010            0             0
1011            2             2
1012            1             1
1013            2             2
1014            1             1
1015            2             2
1016            3             3
1017            2             2
1018            2             2
1019            2             2
1020            0             0
1021            0             0
1022            1             1
1023            2             2
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
