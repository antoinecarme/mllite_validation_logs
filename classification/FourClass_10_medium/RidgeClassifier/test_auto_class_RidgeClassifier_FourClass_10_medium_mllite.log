          X_0       X_1       X_2  ...       X_8       X_9  target
0   -1.104915  0.852920  0.507679  ... -1.472978 -1.793182       0
1    1.845877 -1.230132  0.868872  ...  0.362403 -0.619445       3
2   -2.837179  1.477195  0.565303  ...  1.102744  1.483759       1
3   -0.817915  0.349464 -0.778337  ... -0.344547 -0.450057       3
4    2.867865 -1.912016  0.005109  ... -0.616466 -0.572385       0
..        ...       ...       ...  ...       ...       ...     ...
507  2.438772 -1.661028 -1.497360  ...  0.591629 -0.673836       2
508  2.240772 -0.702349  0.668354  ...  1.042002 -1.470823       1
509 -1.085291  0.783440 -0.493113  ...  1.430318 -0.063795       1
510  0.377241 -1.091754  0.032081  ...  1.357257 -0.465549       0
511 -0.376689  1.158867 -0.352004  ...  1.521553  1.011941       1

[512 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-1.10491490e+00  8.52919877e-01  5.07678568e-01 -3.81407499e-01
  -6.32111073e-01  6.43055558e-01  1.64998901e+00  4.79870588e-01
  -1.47297835e+00 -1.79318225e+00]
 [ 1.84587657e+00 -1.23013234e+00  8.68871808e-01 -1.36471283e+00
   1.38019109e+00 -6.07883871e-01 -4.83270741e+00 -3.81645823e+00
   3.62403333e-01 -6.19445145e-01]
 [-2.83717918e+00  1.47719467e+00  5.65303147e-01  1.38211691e+00
   1.26869273e+00 -1.04379274e-01  2.91604996e-01 -1.22561082e-02
   1.10274434e+00  1.48375893e+00]
 [-8.17914605e-01  3.49463820e-01 -7.78337240e-01  3.11694108e-02
   1.09836125e+00 -2.34135496e-03 -4.48572785e-01 -1.05435896e+00
  -3.44547480e-01 -4.50056911e-01]
 [ 2.86786485e+00 -1.91201603e+00  5.10907173e-03 -8.97717237e-01
  -4.13689524e-01  1.13818514e+00 -1.69676435e+00 -1.53572273e+00
  -6.16465807e-01 -5.72385132e-01]] [0 3 1 3 0]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 6 6
('OPERATION_END_ELAPSED', 0.01, 'TRAINING')
{ ,   }
{ ,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.476570,
			"coeffs" : [ -0.067196, -0.019410, 0.027532, 0.096525, 0.018254, -0.055140, -0.010960, -0.117981, 0.005894, -0.025425 ]
		},
		"class_1" : {
			"intercept" : -0.449453,
			"coeffs" : [ 0.087666, 0.032008, -0.001338, -0.056594, 0.015120, 0.008463, -0.010617, 0.258524, 0.177087, 0.011738 ]
		},
		"class_2" : {
			"intercept" : -0.568765,
			"coeffs" : [ 0.057067, 0.013617, -0.005852, -0.151622, -0.068328, 0.002755, 0.042741, 0.016814, -0.188192, -0.017104 ]
		},
		"class_3" : {
			"intercept" : -0.505214,
			"coeffs" : [ -0.077513, -0.026181, -0.020342, 0.111688, 0.034954, 0.043922, -0.021144, -0.157382, 0.005228, 0.030790 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_medium.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1, 2, 3 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.476570,
			"coeffs" : [ -0.067196, -0.019410, 0.027532, 0.096525, 0.018254, -0.055140, -0.010960, -0.117981, 0.005894, -0.025425 ]
		},
		"class_1" : {
			"intercept" : -0.449453,
			"coeffs" : [ 0.087666, 0.032008, -0.001338, -0.056594, 0.015120, 0.008463, -0.010617, 0.258524, 0.177087, 0.011738 ]
		},
		"class_2" : {
			"intercept" : -0.568765,
			"coeffs" : [ 0.057067, 0.013617, -0.005852, -0.151622, -0.068328, 0.002755, 0.042741, 0.016814, -0.188192, -0.017104 ]
		},
		"class_3" : {
			"intercept" : -0.505214,
			"coeffs" : [ -0.077513, -0.026181, -0.020342, 0.111688, 0.034954, 0.043922, -0.021144, -0.157382, 0.005228, 0.030790 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1, 2, 3 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 512
	},
	"equations" : 	{
		"class_0" : 	{
			"coeffs" : [ -0.067196, -0.01941, 0.027532, 0.096525, 0.018254, -0.05514, -0.01096, -0.117981, 0.005894, -0.025425 ],
			"intercept" : -0.47657
		},
		"class_1" : 	{
			"coeffs" : [ 0.087666, 0.032008, -0.001338, -0.056594, 0.01512, 0.008463, -0.010617, 0.258524, 0.177087, 0.011738 ],
			"intercept" : -0.449453
		},
		"class_2" : 	{
			"coeffs" : [ 0.057067, 0.013617, -0.005852, -0.151622, -0.068328, 0.002755, 0.042741, 0.016814, -0.188192, -0.017104 ],
			"intercept" : -0.568765
		},
		"class_3" : 	{
			"coeffs" : [ -0.077513, -0.026181, -0.020342, 0.111688, 0.034954, 0.043922, -0.021144, -0.157382, 0.005228, 0.03079 ],
			"intercept" : -0.505214
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.2373 0.204  0.3514 0.2072]
 [0.3401 0.124  0.187  0.3489]
 [0.3185 0.2277 0.1102 0.3435]
 ...
 [0.2302 0.4001 0.1387 0.2311]
 [0.3451 0.2535 0.1094 0.2921]
 [0.1891 0.4633 0.185  0.1625]]
(512, 4)
(512, 4) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_medium', 'size': 512, 'accuracy': 0.552734375, 'auc': 0.8024224009332532}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_medium.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'FourClass_10_medium', 'training_time_in_sec': 0.01, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_FourClass_10_medium.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.476570 + -0.067196 * X_0 + -0.019410 * X_1 + 0.027532 * X_2 + 0.096525 * X_3 + 0.018254 * X_4 + -0.055140 * X_5 + -0.010960 * X_6 + -0.117981 * X_7 + 0.005894 * X_8 + -0.025425 * X_9 AS "Score_0", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "LogProba_0",
   -0.449453 + 0.087666 * X_0 + 0.032008 * X_1 + -0.001338 * X_2 + -0.056594 * X_3 + 0.015120 * X_4 + 0.008463 * X_5 + -0.010617 * X_6 + 0.258524 * X_7 + 0.177087 * X_8 + 0.011738 * X_9 AS "Score_1", CAST(NULL AS FLOA
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
   WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2"
   WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
          X_0       X_1       X_2       X_3  ...       X_7       X_8       X_9  KEY
0   -1.104915  0.852920  0.507679 -0.381407  ...  0.479871 -1.472978 -1.793182    0
1    1.845877 -1.230132  0.868872 -1.364713  ... -3.816458  0.362403 -0.619445    1
2   -2.837179  1.477195  0.565303  1.382117  ... -0.012256  1.102744  1.483759    2
3   -0.817915  0.349464 -0.778337  0.031169  ... -1.054359 -0.344547 -0.450057    3
4    2.867865 -1.912016  0.005109 -0.897717  ... -1.535723 -0.616466 -0.572385    4
..        ...       ...       ...       ...  ...       ...       ...       ...  ...
507  2.438772 -1.661028 -1.497360 -0.075190  ... -0.360560  0.591629 -0.673836  507
508  2.240772 -0.702349  0.668354 -1.061221  ...  1.595941  1.042002 -1.470823  508
509 -1.085291  0.783440 -0.493113  0.767185  ...  1.308570  1.430318 -0.063795  509
510  0.377241 -1.091754  0.032081  2.033396  ... -0.311330  1.357257 -0.465549  510
511 -0.376689  1.158867 -0.352004 -1.122018  ...  1.244896  1.521553  1.011941  511

[512 rows x 11 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
     index   Score_0   Proba_0  ...  LogProba_3  Decision  DecisionProba
0        0 -0.526503  0.237312  ...   -1.573876         2       0.351412
1        1 -0.104702  0.340069  ...   -1.052900         3       0.348924
2        2 -0.169683  0.318524  ...   -1.068502         3       0.343523
3        3 -0.287912  0.299902  ...   -1.149984         3       0.316642
4        4 -0.578287  0.227765  ...   -1.386718         2       0.320668
..     ...       ...       ...  ...         ...       ...            ...
507    507 -0.522224  0.242172  ...   -1.497945         1       0.311012
508    508 -0.801158  0.157249  ...   -2.080031         1       0.517027
509    509 -0.512498  0.230182  ...   -1.465060         1       0.400055
510    510 -0.093902  0.345079  ...   -1.230725         0       0.345079
511    511 -0.680533  0.189147  ...   -1.816777         1       0.463309

[512 rows x 15 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Score_2', 'Proba_2', 'LogProba_2', 'Score_3', 'Proba_3',
       'LogProba_3', 'Decision', 'DecisionProba'],
      dtype='object')
     index   Score_0  SQL_Proba_0  ...  Py_Proba_2  Py_Proba_3  Py_Decision
496    496 -0.648285     0.208531  ...    0.366654    0.193433            2
497    497 -0.973733     0.136806  ...    0.254045    0.144192            1
498    498 -0.537942     0.237173  ...    0.260464    0.310143            3
499    499 -0.367707     0.278757  ...    0.183903    0.215781            1
500    500 -0.127355     0.332168  ...    0.122333    0.355882            3
501    501 -0.390814     0.278195  ...    0.247146    0.231294            0
502    502 -0.220798     0.309740  ...    0.155834    0.362000            3
503    503 -0.502784     0.239499  ...    0.350924    0.253297            2
504    504 -0.368135     0.278596  ...    0.254041    0.299852            3
505    505 -0.213732     0.299970  ...    0.326373    0.279503            2
506    506 -0.569181     0.230099  ...    0.324870    0.230094            2
507    507 -0.522224     0.242172  ...    0.223228    0.223589            1
508    508 -0.801158     0.157249  ...    0.200798    0.124926            1
509    509 -0.512498     0.230182  ...    0.138699    0.231064            1
510    510 -0.093902     0.345079  ...    0.109353    0.292081            0
511    511 -0.680533     0.189147  ...    0.184996    0.162549            1

[16 rows x 20 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
