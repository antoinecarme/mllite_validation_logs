WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9", CAST("ADS"."X_10" AS FLOAT) AS "X_10", CAST("ADS"."X_11" AS FLOAT) AS "X_11", CAST("ADS"."X_12" AS FLOAT) AS "X_12", CAST("ADS"."X_13" AS FLOAT) AS "X_13", CAST("ADS"."X_14" AS FLOAT) AS "X_14", CAST("ADS"."X_15" AS FLOAT) AS "X_15", CAST("ADS"."X_16" AS FLOAT) AS "X_16", CAST("ADS"."X_17" AS FLOAT) AS "X_17", CAST("ADS"."X_18" AS FLOAT) AS "X_18", CAST("ADS"."X_19" AS FLOAT) AS "X_19", CAST("ADS"."X_20" AS FLOAT) AS "X_20", CAST("ADS"."X_21" AS FLOAT) AS "X_21", CAST("ADS"."X_22" AS FLOAT) AS "X_22", CAST("ADS"."X_23" AS FLOAT) AS "X_23", CAST("ADS"."X_24" AS FLOAT) AS "X_24", CAST("ADS"."X_25" AS FLOAT) AS "X_25", CAST("ADS"."X_26" AS FLOAT) AS "X_26", CAST("ADS"."X_27" AS FLOAT) AS "X_27", CAST("ADS"."X_28" AS FLOAT) AS "X_28", CAST("ADS"."X_29" AS FLOAT) AS "X_29", CAST("ADS"."X_30" AS FLOAT) AS "X_30", CAST("ADS"."X_31" AS FLOAT) AS "X_31", CAST("ADS"."X_32" AS FLOAT) AS "X_32", CAST("ADS"."X_33" AS FLOAT) AS "X_33", CAST("ADS"."X_34" AS FLOAT) AS "X_34", CAST("ADS"."X_35" AS FLOAT) AS "X_35", CAST("ADS"."X_36" AS FLOAT) AS "X_36", CAST("ADS"."X_37" AS FLOAT) AS "X_37", CAST("ADS"."X_38" AS FLOAT) AS "X_38", CAST("ADS"."X_39" AS FLOAT) AS "X_39", CAST("ADS"."X_40" AS FLOAT) AS "X_40", CAST("ADS"."X_41" AS FLOAT) AS "X_41", CAST("ADS"."X_42" AS FLOAT) AS "X_42", CAST("ADS"."X_43" AS FLOAT) AS "X_43", CAST("ADS"."X_44" AS FLOAT) AS "X_44", CAST("ADS"."X_45" AS FLOAT) AS "X_45", CAST("ADS"."X_46" AS FLOAT) AS "X_46", CAST("ADS"."X_47" AS FLOAT) AS "X_47", CAST("ADS"."X_48" AS FLOAT) AS "X_48", CAST("ADS"."X_49" AS FLOAT) AS "X_49", CAST("ADS"."X_50" AS FLOAT) AS "X_50", CAST("ADS"."X_51" AS FLOAT) AS "X_51", CAST("ADS"."X_52" AS FLOAT) AS "X_52", CAST("ADS"."X_53" AS FLOAT) AS "X_53", CAST("ADS"."X_54" AS FLOAT) AS "X_54", CAST("ADS"."X_55" AS FLOAT) AS "X_55", CAST("ADS"."X_56" AS FLOAT) AS "X_56", CAST("ADS"."X_57" AS FLOAT) AS "X_57", CAST("ADS"."X_58" AS FLOAT) AS "X_58", CAST("ADS"."X_59" AS FLOAT) AS "X_59", CAST("ADS"."X_60" AS FLOAT) AS "X_60", CAST("ADS"."X_61" AS FLOAT) AS "X_61", CAST("ADS"."X_62" AS FLOAT) AS "X_62", CAST("ADS"."X_63" AS FLOAT) AS "X_63"
  FROM "digits_sampled" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -10.667813 + 0.000000 * t."X_0" + 18.878035 * t."X_1" + 0.192032 * t."X_2" + 1.871967 * t."X_3" + -1.046212 * t."X_4" + 0.291769 * t."X_5" + 0.712913 * t."X_6" + 2.818235 * t."X_7" + -1.773363 * t."X_8" + -4.480782 * t."X_9" + -1.351513 * t."X_10" + -1.620578 * t."X_11" + -0.060384 * t."X_12" + 0.413980 * t."X_13" + -1.700472 * t."X_14" + 9.890595 * t."X_15" + 76.507950 * t."X_16" + 6.866550 * t."X_17" + 1.065525 * t."X_18" + 1.011530 * t."X_19" + -0.777025 * t."X_20" + 2.728797 * t."X_21" + 2.607774 * t."X_22" + -17.245144 * t."X_23" + 0.000000 * t."X_24" + 0.786586 * t."X_25" + -5.046306 * t."X_26" + 0.568396 * t."X_27" + 0.249118 * t."X_28" + -1.072366 * t."X_29" + -4.409932 * t."X_30" + 1577.326538 * t."X_31" + 0.000000 * t."X_32" + -7.192228 * t."X_33" + 12.296519 * t."X_34" + -5.600072 * t."X_35" + 4.273569 * t."X_36" + -0.591655 * t."X_37" + 2.165971 * t."X_38" + 0.000000 * t."X_39" + 10.916391 * t."X_40" + 2.415610 * t."X_41" + -5.041207 * t."X_42" + 4.313570 * t."X_43" + -7.328846 * t."X_44" + -0.478168 * t."X_45" + -2.691320 * t."X_46" + 9.187344 * t."X_47" + -206.402161 * t."X_48" + 2.657359 * t."X_49" + 0.889673 * t."X_50" + -1.789968 * t."X_51" + 2.955085 * t."X_52" + -1.961274 * t."X_53" + 1.353789 * t."X_54" + -3.920896 * t."X_55" + 576.134399 * t."X_56" + -11.461825 * t."X_57" + -0.176901 * t."X_58" + -0.481992 * t."X_59" + 4.563602 * t."X_60" + -2.531892 * t."X_61" + 0.720342 * t."X_62" + 2.002728 * t."X_63" AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   -33.911686 + 0.000000 * t."X_0" + 1.173197 * t."X_1" + -0.515795 * t."X_2" + 0.081601 * t."X_3" + -0.253098 * t."X_4" + 0.311827 * t."X_5" + 0.433083 * t."X_6" + -0.662148 * t."X_7" + 4.880829 * t."X_8" + 0.411749 * t."X_9" + 0.802929 * t."X_10" + -0.562338 * t."X_11" + 0.281880 * t."X_12" + -0.068569 * t."X_13" + -1.077133 * t."X_14" + 4.977063 * t."X_15" + -15.847053 * t."X_16" + -1.187354 * t."X_17" + 0.176881 * t."X_18" + -0.081438 * t."X_19" + -0.259058 * t."X_20" + 0.522505 * t."X_21" + 1.230039 * t."X_22" + -7.836740 * t."X_23" + 0.000000 * t."X_24" + 0.804751 * t."X_25" + -0.909328 * t."X_26" + -0.017041 * t."X_27" + 0.682027 * t."X_28" + -0.573136 * t."X_29" + -0.373929 * t."X_30" + 1357.385254 * t."X_31" + 0.000000 * t."X_32" + -1.053325 * t."X_33" + 2.476892 * t."X_34" + -0.306835 * t."X_35" + -0.696973 * t."X_36" + 0.537591 * t."X_37" + 0.162086 * t."X_38" + 0.000000 * t."X_39" + -7.481501 * t."X_40" + 0.922374 * t."X_41" + -1.187711 * t."X_42" + 0.131556 * t."X_43" + 1.881319 * t."X_44" + -0.525198 * t."X_45" + 0.905857 * t."X_46" + -2.107225 * t."X_47" + -169.250549 * t."X_48" + -0.722720 * t."X_49" + 0.560776 * t."X_50" + 0.433102 * t."X_51" + -0.587997 * t."X_52" + 0.590716 * t."X_53" + -0.557719 * t."X_54" + -1.664496 * t."X_55" + 518.701904 * t."X_56" + 2.036465 * t."X_57" + 0.535303 * t."X_58" + -0.492430 * t."X_59" + 1.216034 * t."X_60" + -0.313157 * t."X_61" + 0.568025 * t."X_62" + 0.182152 * t."X_63" AS "Score_1",
   CAST(NULL AS FLOAT) AS "Proba_1",
   CAST(NULL AS FLOAT) AS "LogProba_1",
   -14.394427 + 0.000000 * t."X_0" + -32.244511 * t."X_1" + -1.201782 * t."X_2" + -4.725904 * t."X_3" + -0.420395 * t."X_4" + 1.974438 * t."X_5" + -0.164826 * t."X_6" + -1.391617 * t."X_7" + -21.462685 * t."X_8" + 2.502654 * t."X_9" + 1.063418 * t."X_10" + 1.613957 * t."X_11" + -1.740077 * t."X_12" + -0.338277 * t."X_13" + 0.155853 * t."X_14" + -6.500203 * t."X_15" + -4.509408 * t."X_16" + -6.800668 * t."X_17" + -2.317351 * t."X_18" + -1.939696 * t."X_19" + 2.770518 * t."X_20" + -4.562330 * t."X_21" + -6.898694 * t."X_22" + 27.174452 * t."X_23" + 0.000000 * t."X_24" + -2.943148 * t."X_25" + 9.133604 * t."X_26" + -1.289084 * t."X_27" + -1.642485 * t."X_28" + 2.846350 * t."X_29" + 8.905546 * t."X_30" + -2433.064941 * t."X_31" + 0.000000 * t."X_32" + 15.516557 * t."X_33" + -25.460964 * t."X_34" + 10.186348 * t."X_35" + -3.981262 * t."X_36" + -0.582246 * t."X_37" + -2.230048 * t."X_38" + 0.000000 * t."X_39" + 6.435280 * t."X_40" + -10.125417 * t."X_41" + 13.285189 * t."X_42" + -9.769486 * t."X_43" + 6.536068 * t."X_44" + 3.646523 * t."X_45" + 0.113915 * t."X_46" + -7.728550 * t."X_47" + 320.335968 * t."X_48" + -3.292485 * t."X_49" + -7.162904 * t."X_50" + 10.990226 * t."X_51" + -3.985623 * t."X_52" + -2.399631 * t."X_53" + -0.696849 * t."X_54" + 15.349003 * t."X_55" + -905.522888 * t."X_56" + -0.484834 * t."X_57" + 8.745758 * t."X_58" + -1.904263 * t."X_59" + 5.134812 * t."X_60" + 2.494293 * t."X_61" + -3.094534 * t."X_62" + -9.220943 * t."X_63" AS "Score_2",
   CAST(NULL AS FLOAT) AS "Proba_2",
   CAST(NULL AS FLOAT) AS "LogProba_2",
   -2.590875 + 0.000000 * t."X_0" + -12.161092 * t."X_1" + -0.592004 * t."X_2" + -1.292781 * t."X_3" + -0.205691 * t."X_4" + 0.942817 * t."X_5" + -0.286023 * t."X_6" + -0.997440 * t."X_7" + -8.432846 * t."X_8" + 1.492157 * t."X_9" + 0.554168 * t."X_10" + 1.163090 * t."X_11" + -0.495499 * t."X_12" + 0.070734 * t."X_13" + -0.034004 * t."X_14" + -2.009450 * t."X_15" + 4.103448 * t."X_16" + -3.730971 * t."X_17" + -1.005838 * t."X_18" + -0.869537 * t."X_19" + 1.198177 * t."X_20" + -1.837383 * t."X_21" + -2.844716 * t."X_22" + 9.269424 * t."X_23" + 0.000000 * t."X_24" + -0.544126 * t."X_25" + 3.652635 * t."X_26" + -0.222804 * t."X_27" + -1.101771 * t."X_28" + 1.130700 * t."X_29" + 3.491622 * t."X_30" + 808.572998 * t."X_31" + 0.000000 * t."X_32" + 5.416847 * t."X_33" + -10.091775 * t."X_34" + 3.975989 * t."X_35" + -1.206217 * t."X_36" + -0.277982 * t."X_37" + -0.927022 * t."X_38" + 0.000000 * t."X_39" + 1.087562 * t."X_40" + -3.339087 * t."X_41" + 5.031242 * t."X_42" + -3.592779 * t."X_43" + 2.401041 * t."X_44" + 1.163811 * t."X_45" + -0.010781 * t."X_46" + -1.583536 * t."X_47" + -92.147499 * t."X_48" + -1.994089 * t."X_49" + -2.539665 * t."X_50" + 3.005401 * t."X_51" + -1.653989 * t."X_52" + -0.710209 * t."X_53" + 0.105154 * t."X_54" + 4.908568 * t."X_55" + 303.928589 * t."X_56" + 1.025597 * t."X_57" + 3.048303 * t."X_58" + -1.062057 * t."X_59" + 2.285363 * t."X_60" + -0.002886 * t."X_61" + -0.664727 * t."X_62" + -2.876130 * t."X_63" AS "Score_3",
   CAST(NULL AS FLOAT) AS "Proba_3",
   CAST(NULL AS FLOAT) AS "LogProba_3",
   -82.257477 + 0.000000 * t."X_0" + 28.043184 * t."X_1" + 0.454451 * t."X_2" + 4.270342 * t."X_3" + -1.412622 * t."X_4" + 0.098120 * t."X_5" + 1.434203 * t."X_6" + -0.832500 * t."X_7" + -0.184408 * t."X_8" + 2.074442 * t."X_9" + 0.004449 * t."X_10" + -2.250694 * t."X_11" + 1.470554 * t."X_12" + 1.207288 * t."X_13" + -3.920323 * t."X_14" + 24.685867 * t."X_15" + 32.315861 * t."X_16" + 1.852939 * t."X_17" + 2.586710 * t."X_18" + 1.147580 * t."X_19" + -2.499784 * t."X_20" + 4.996386 * t."X_21" + 7.778790 * t."X_22" + -46.276043 * t."X_23" + 0.000000 * t."X_24" + 6.106187 * t."X_25" + -10.199819 * t."X_26" + 1.373385 * t."X_27" + 2.284433 * t."X_28" + -3.280387 * t."X_29" + -7.955536 * t."X_30" + -10166.122070 * t."X_31" + 0.000000 * t."X_32" + -15.118145 * t."X_33" + 25.636429 * t."X_34" + -9.114505 * t."X_35" + 3.096729 * t."X_36" + 1.340217 * t."X_37" + 2.604433 * t."X_38" + 0.000000 * t."X_39" + -15.753454 * t."X_40" + 9.249578 * t."X_41" + -12.498834 * t."X_42" + 8.670420 * t."X_43" + -3.030735 * t."X_44" + -3.686673 * t."X_45" + 1.450085 * t."X_46" + 7.355199 * t."X_47" + 1260.645996 * t."X_48" + 1.580166 * t."X_49" + 5.749480 * t."X_50" + -6.817461 * t."X_51" + 1.940456 * t."X_52" + 2.048951 * t."X_53" + -0.380465 * t."X_54" + -15.137831 * t."X_55" + -3818.909912 * t."X_56" + -0.938026 * t."X_57" + -4.714076 * t."X_58" + -1.266312 * t."X_59" + 3.893996 * t."X_60" + -6.005783 * t."X_61" + 5.429273 * t."X_62" + 6.830184 * t."X_63" AS "Score_4",
   CAST(NULL AS FLOAT) AS "Proba_4",
   CAST(NULL AS FLOAT) AS "LogProba_4",
   49.009472 + 0.000000 * t."X_0" + 13.318373 * t."X_1" + 4.547533 * t."X_2" + 1.844990 * t."X_3" + 1.754928 * t."X_4" + -2.438678 * t."X_5" + -1.603781 * t."X_6" + 1.893367 * t."X_7" + -0.142788 * t."X_8" + -4.870926 * t."X_9" + -1.789140 * t."X_10" + 0.746938 * t."X_11" + 0.285075 * t."X_12" + -0.469964 * t."X_13" + 4.558456 * t."X_14" + -10.495205 * t."X_15" + -25.526592 * t."X_16" + 10.697598 * t."X_17" + 0.091182 * t."X_18" + 0.964307 * t."X_19" + -1.571653 * t."X_20" + 0.387776 * t."X_21" + -0.186876 * t."X_22" + 10.817783 * t."X_23" + 0.000000 * t."X_24" + -3.584306 * t."X_25" + -2.511770 * t."X_26" + -0.373407 * t."X_27" + 1.474817 * t."X_28" + -0.129029 * t."X_29" + -2.952621 * t."X_30" + 1921.615723 * t."X_31" + 0.000000 * t."X_32" + -2.980677 * t."X_33" + 7.580942 * t."X_34" + -3.531459 * t."X_35" + 0.324863 * t."X_36" + 0.438369 * t."X_37" + -0.112682 * t."X_38" + 0.000000 * t."X_39" + 9.695226 * t."X_40" + 1.709250 * t."X_41" + -4.163080 * t."X_42" + 3.618037 * t."X_43" + -1.493612 * t."X_44" + -1.275249 * t."X_45" + 1.102586 * t."X_46" + -4.082738 * t."X_47" + -252.766037 * t."X_48" + 4.266489 * t."X_49" + 4.326984 * t."X_50" + -6.442471 * t."X_51" + 2.409524 * t."X_52" + 1.507828 * t."X_53" + -0.927015 * t."X_54" + -3.601047 * t."X_55" + 740.013672 * t."X_56" + -2.494922 * t."X_57" + -9.310136 * t."X_58" + 3.230072 * t."X_59" + -9.650678 * t."X_60" + 2.918875 * t."X_61" + -0.107306 * t."X_62" + 1.923654 * t."X_63" AS "Score_5",
   CAST(NULL AS FLOAT) AS "Proba_5",
   CAST(NULL AS FLOAT) AS "LogProba_5",
   -85.337715 + 0.000000 * t."X_0" + 23.245731 * t."X_1" + 1.098491 * t."X_2" + 1.951160 * t."X_3" + -2.016117 * t."X_4" + 0.675276 * t."X_5" + 2.724201 * t."X_6" + 0.594328 * t."X_7" + -0.579546 * t."X_8" + 1.470563 * t."X_9" + -1.049762 * t."X_10" + -3.775181 * t."X_11" + 0.539371 * t."X_12" + 1.076496 * t."X_13" + -5.465947 * t."X_14" + 26.600313 * t."X_15" + 73.166954 * t."X_16" + 1.861428 * t."X_17" + 3.244049 * t."X_18" + 1.498196 * t."X_19" + -1.478031 * t."X_20" + 5.308688 * t."X_21" + 7.788473 * t."X_22" + -47.309383 * t."X_23" + 0.000000 * t."X_24" + 5.049487 * t."X_25" + -9.745840 * t."X_26" + 1.181336 * t."X_27" + 1.292758 * t."X_28" + -2.786190 * t."X_29" + -7.548892 * t."X_30" + 1470.493530 * t."X_31" + 0.000000 * t."X_32" + -14.017123 * t."X_33" + 24.083042 * t."X_34" + -8.249711 * t."X_35" + 4.975583 * t."X_36" + -0.054563 * t."X_37" + 3.822124 * t."X_38" + 0.000000 * t."X_39" + -8.965087 * t."X_40" + 8.447219 * t."X_41" + -10.998994 * t."X_42" + 6.900334 * t."X_43" + -7.544169 * t."X_44" + -1.603605 * t."X_45" + -1.925471 * t."X_46" + 10.871085 * t."X_47" + -196.364944 * t."X_48" + 1.225648 * t."X_49" + 2.307867 * t."X_50" + -1.148726 * t."X_51" + 2.158243 * t."X_52" + -0.913464 * t."X_53" + 0.387066 * t."X_54" + -10.739718 * t."X_55" + 552.434326 * t."X_56" + -8.093278 * t."X_57" + -1.110285 * t."X_58" + -0.915674 * t."X_59" + 8.558196 * t."X_60" + -5.006227 * t."X_61" + 3.253439 * t."X_62" + 4.662748 * t."X_63" AS "Score_6",
   CAST(NULL AS FLOAT) AS "Proba_6",
   CAST(NULL AS FLOAT) AS "LogProba_6",
   188.409332 + 0.000000 * t."X_0" + -16.451387 * t."X_1" + 3.639192 * t."X_2" + -2.042408 * t."X_3" + 5.468720 * t."X_4" + -6.235234 * t."X_5" + -0.431727 * t."X_6" + -1.187223 * t."X_7" + 76.185326 * t."X_8" + 7.460367 * t."X_9" + -1.393878 * t."X_10" + 0.273215 * t."X_11" + 0.714094 * t."X_12" + -1.842325 * t."X_13" + 5.889702 * t."X_14" + -38.613403 * t."X_15" + -191.460785 * t."X_16" + -11.088870 * t."X_17" + 2.252155 * t."X_18" + -0.735452 * t."X_19" + -0.266861 * t."X_20" + -1.143004 * t."X_21" + 2.415701 * t."X_22" + 31.140909 * t."X_23" + 0.000000 * t."X_24" + 3.246598 * t."X_25" + 2.866986 * t."X_26" + 1.865722 * t."X_27" + -0.488482 * t."X_28" + -1.076335 * t."X_29" + 0.393943 * t."X_30" + 1560.153442 * t."X_31" + 0.000000 * t."X_32" + 0.822959 * t."X_33" + -4.693960 * t."X_34" + 0.074321 * t."X_35" + -3.740636 * t."X_36" + -0.087165 * t."X_37" + -1.681742 * t."X_38" + 0.000000 * t."X_39" + -8.440630 * t."X_40" + 4.530141 * t."X_41" + -0.199049 * t."X_42" + -0.052917 * t."X_43" + 2.023525 * t."X_44" + -0.594884 * t."X_45" + 1.243683 * t."X_46" + -10.574892 * t."X_47" + -205.377899 * t."X_48" + 0.232686 * t."X_49" + 2.400839 * t."X_50" + -4.957135 * t."X_51" + 1.621309 * t."X_52" + 5.487844 * t."X_53" + -0.117468 * t."X_54" + -4.121412 * t."X_55" + 605.132202 * t."X_56" + 27.593460 * t."X_57" + -11.010762 * t."X_58" + 7.291575 * t."X_59" + -26.839930 * t."X_60" + 10.028391 * t."X_61" + -3.160353 * t."X_62" + 5.555415 * t."X_63" AS "Score_7",
   CAST(NULL AS FLOAT) AS "Proba_7",
   CAST(NULL AS FLOAT) AS "LogProba_7",
   -22.763208 + 0.000000 * t."X_0" + -5.593102 * t."X_1" + -1.830008 * t."X_2" + -0.759108 * t."X_3" + -0.629718 * t."X_4" + 1.239974 * t."X_5" + -0.762677 * t."X_6" + -0.957695 * t."X_7" + -20.866241 * t."X_8" + -1.533241 * t."X_9" + 1.168286 * t."X_10" + 1.131966 * t."X_11" + -0.110895 * t."X_12" + 0.239520 * t."X_13" + 0.341589 * t."X_14" + 0.455638 * t."X_15" + 8.388580 * t."X_16" + 1.597641 * t."X_17" + -1.748723 * t."X_18" + 0.021605 * t."X_19" + 0.496891 * t."X_20" + -1.896886 * t."X_21" + -3.191045 * t."X_22" + 10.134085 * t."X_23" + 0.000000 * t."X_24" + -3.137089 * t."X_25" + 2.911709 * t."X_26" + -1.221482 * t."X_27" + -0.210801 * t."X_28" + 1.558650 * t."X_29" + 2.576045 * t."X_30" + 1749.572021 * t."X_31" + 0.000000 * t."X_32" + 5.589538 * t."X_33" + -7.934243 * t."X_34" + 3.986135 * t."X_35" + -1.594232 * t."X_36" + 0.279312 * t."X_37" + -1.300726 * t."X_38" + 0.000000 * t."X_39" + -0.174316 * t."X_40" + -3.538996 * t."X_41" + 3.794462 * t."X_42" + -2.766580 * t."X_43" + 3.409463 * t."X_44" + 0.537252 * t."X_45" + 0.961160 * t."X_46" + -1.344591 * t."X_47" + -210.489319 * t."X_48" + -1.121194 * t."X_49" + -0.999933 * t."X_50" + 1.861899 * t."X_51" + -2.277020 * t."X_52" + -0.146761 * t."X_53" + -0.385129 * t."X_54" + 4.953084 * t."X_55" + 652.039917 * t."X_56" + -1.423302 * t."X_57" + 3.113440 * t."X_58" + -1.083606 * t."X_59" + 3.273208 * t."X_60" + -1.337932 * t."X_61" + 0.053807 * t."X_62" + -2.594171 * t."X_63" AS "Score_8",
   CAST(NULL AS FLOAT) AS "Proba_8",
   CAST(NULL AS FLOAT) AS "LogProba_8",
   6.504285 + 0.000000 * t."X_0" + -18.208424 * t."X_1" + -5.792114 * t."X_2" + -1.199858 * t."X_3" + -1.239797 * t."X_4" + 3.139692 * t."X_5" + -2.055370 * t."X_6" + 0.722693 * t."X_7" + -27.624329 * t."X_8" + -4.527001 * t."X_9" + 1.991044 * t."X_10" + 3.279627 * t."X_11" + -0.884119 * t."X_12" + -0.288884 * t."X_13" + 1.252282 * t."X_14" + -8.991222 * t."X_15" + 42.861084 * t."X_16" + -0.068266 * t."X_17" + -4.344595 * t."X_18" + -1.017094 * t."X_19" + 2.386824 * t."X_20" + -4.504554 * t."X_21" + -8.699449 * t."X_22" + 30.130688 * t."X_23" + 0.000000 * t."X_24" + -5.784959 * t."X_25" + 9.848128 * t."X_26" + -1.865023 * t."X_27" + -2.539611 * t."X_28" + 3.381747 * t."X_29" + 7.873751 * t."X_30" + 2154.075439 * t."X_31" + 0.000000 * t."X_32" + 13.015606 * t."X_33" + -23.892878 * t."X_34" + 8.579793 * t."X_35" + -1.451425 * t."X_36" + -1.001879 * t."X_37" + -2.502397 * t."X_38" + 0.000000 * t."X_39" + 12.680546 * t."X_40" + -10.270678 * t."X_41" + 11.977980 * t."X_42" + -7.452156 * t."X_43" + 3.145952 * t."X_44" + 2.816191 * t."X_45" + -1.149713 * t."X_46" + 0.007892 * t."X_47" + -248.184753 * t."X_48" + -2.831855 * t."X_49" + -5.533118 * t."X_50" + 4.865133 * t."X_51" + -2.579990 * t."X_52" + -3.503999 * t."X_53" + 1.218635 * t."X_54" + 13.974747 * t."X_55" + 776.051208 * t."X_56" + -5.759354 * t."X_57" + 10.879360 * t."X_58" + -3.315315 * t."X_59" + 7.565400 * t."X_60" + -0.243685 * t."X_61" + -2.997968 * t."X_62" + -6.465641 * t."X_63" AS "Score_9",
   CAST(NULL AS FLOAT) AS "Proba_9",
   CAST(NULL AS FLOAT) AS "LogProba_9"
  FROM model_input AS t
 ),
soft_max_orig_cte AS 
( SELECT t."index" AS "index", 
   t."Score_0" AS "Score_0",
   t."Proba_0" AS "Proba_0",
   t."LogProba_0" AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Proba_1" AS "Proba_1",
   t."LogProba_1" AS "LogProba_1",
   t."Score_2" AS "Score_2",
   t."Proba_2" AS "Proba_2",
   t."LogProba_2" AS "LogProba_2",
   t."Score_3" AS "Score_3",
   t."Proba_3" AS "Proba_3",
   t."LogProba_3" AS "LogProba_3",
   t."Score_4" AS "Score_4",
   t."Proba_4" AS "Proba_4",
   t."LogProba_4" AS "LogProba_4",
   t."Score_5" AS "Score_5",
   t."Proba_5" AS "Proba_5",
   t."LogProba_5" AS "LogProba_5",
   t."Score_6" AS "Score_6",
   t."Proba_6" AS "Proba_6",
   t."LogProba_6" AS "LogProba_6",
   t."Score_7" AS "Score_7",
   t."Proba_7" AS "Proba_7",
   t."LogProba_7" AS "LogProba_7",
   t."Score_8" AS "Score_8",
   t."Proba_8" AS "Proba_8",
   t."LogProba_8" AS "LogProba_8",
   t."Score_9" AS "Score_9",
   t."Proba_9" AS "Proba_9",
   t."LogProba_9" AS "LogProba_9",
   CAST(NULL AS BIGINT) AS "Decision",
   CAST(NULL AS FLOAT) AS "DecisionProba",
   GREATEST( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7", t."Score_8", t."Score_9" ) AS "Greatest_Score"
  FROM
    model_scores_cte AS t
),
soft_max_cte_with_exp_deltas AS 
( SELECT t1."index" as "index",
    t1."Proba_0" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_0" AS "Exp_Score_0",
    t1."Proba_1" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_1" AS "Exp_Score_1",
    t1."Proba_2" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_2" AS "Exp_Score_2",
    t1."Proba_3" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_3" AS "Exp_Score_3",
    t1."Proba_4" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_4" AS "Exp_Score_4",
    t1."Proba_5" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_5" AS "Exp_Score_5",
    t1."Proba_6" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_6" AS "Exp_Score_6",
    t1."Proba_7" AS "Proba_7",
    t1."Score_7" AS "Score_7",
    t1."Exp_Score_7" AS "Exp_Score_7",
    t1."Proba_8" AS "Proba_8",
    t1."Score_8" AS "Score_8",
    t1."Exp_Score_8" AS "Exp_Score_8",
    t1."Proba_9" AS "Proba_9",
    t1."Score_9" AS "Score_9",
    t1."Exp_Score_9" AS "Exp_Score_9",
    ( t1."Exp_Score_0" + t1."Exp_Score_1" + t1."Exp_Score_2" + t1."Exp_Score_3" + t1."Exp_Score_4" + t1."Exp_Score_5" + t1."Exp_Score_6" + t1."Exp_Score_7" + t1."Exp_Score_8" + t1."Exp_Score_9" ) AS "Sum_Exp"
  FROM
   ( SELECT t."index" as "index",
        t."Proba_0" AS "Proba_0",
        t."Score_0" AS "Score_0",
        t."Proba_1" AS "Proba_1",
        t."Score_1" AS "Score_1",
        t."Proba_2" AS "Proba_2",
        t."Score_2" AS "Score_2",
        t."Proba_3" AS "Proba_3",
        t."Score_3" AS "Score_3",
        t."Proba_4" AS "Proba_4",
        t."Score_4" AS "Score_4",
        t."Proba_5" AS "Proba_5",
        t."Score_5" AS "Score_5",
        t."Proba_6" AS "Proba_6",
        t."Score_6" AS "Score_6",
        t."Proba_7" AS "Proba_7",
        t."Score_7" AS "Score_7",
        t."Proba_8" AS "Proba_8",
        t."Score_8" AS "Score_8",
        t."Proba_9" AS "Proba_9",
        t."Score_9" AS "Score_9",
        EXP(t."Score_0" - t."Greatest_Score") as "Exp_Score_0",
        EXP(t."Score_1" - t."Greatest_Score") as "Exp_Score_1",
        EXP(t."Score_2" - t."Greatest_Score") as "Exp_Score_2",
        EXP(t."Score_3" - t."Greatest_Score") as "Exp_Score_3",
        EXP(t."Score_4" - t."Greatest_Score") as "Exp_Score_4",
        EXP(t."Score_5" - t."Greatest_Score") as "Exp_Score_5",
        EXP(t."Score_6" - t."Greatest_Score") as "Exp_Score_6",
        EXP(t."Score_7" - t."Greatest_Score") as "Exp_Score_7",
        EXP(t."Score_8" - t."Greatest_Score") as "Exp_Score_8",
        EXP(t."Score_9" - t."Greatest_Score") as "Exp_Score_9"
    FROM
       soft_max_orig_cte AS t
  ) AS t1
),
soft_max_cte AS 
( SELECT t1."index" AS "index",
    t1."Exp_Score_0" / t1."Sum_Exp" AS "Proba_0",
    t1."Score_0" AS "Score_0",
    t1."Exp_Score_1" / t1."Sum_Exp" AS "Proba_1",
    t1."Score_1" AS "Score_1",
    t1."Exp_Score_2" / t1."Sum_Exp" AS "Proba_2",
    t1."Score_2" AS "Score_2",
    t1."Exp_Score_3" / t1."Sum_Exp" AS "Proba_3",
    t1."Score_3" AS "Score_3",
    t1."Exp_Score_4" / t1."Sum_Exp" AS "Proba_4",
    t1."Score_4" AS "Score_4",
    t1."Exp_Score_5" / t1."Sum_Exp" AS "Proba_5",
    t1."Score_5" AS "Score_5",
    t1."Exp_Score_6" / t1."Sum_Exp" AS "Proba_6",
    t1."Score_6" AS "Score_6",
    t1."Exp_Score_7" / t1."Sum_Exp" AS "Proba_7",
    t1."Score_7" AS "Score_7",
    t1."Exp_Score_8" / t1."Sum_Exp" AS "Proba_8",
    t1."Score_8" AS "Score_8",
    t1."Exp_Score_9" / t1."Sum_Exp" AS "Proba_9",
    t1."Score_9" AS "Score_9"
 FROM 
   soft_max_cte_with_exp_deltas as t1
),
arg_max_cte_with_max_proba AS 
( SELECT t."index" AS "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    t."Proba_8" AS "Proba_8",
    t."Score_8" AS "Score_8",
    t."Proba_9" AS "Proba_9",
    t."Score_9" AS "Score_9",
    GREATEST( t."Proba_0", t."Proba_1", t."Proba_2", t."Proba_3", t."Proba_4", t."Proba_5", t."Proba_6", t."Proba_7", t."Proba_8", t."Proba_9" ) AS "Max_Proba",
    GREATEST( t."Score_0", t."Score_1", t."Score_2", t."Score_3", t."Score_4", t."Score_5", t."Score_6", t."Score_7", t."Score_8", t."Score_9" ) AS "Max_Score"
  FROM
     "soft_max_cte" AS t
),
arg_max_cte_with_max_proba_idx AS 
( SELECT t."index" as "index",
    t."Proba_0" AS "Proba_0",
    t."Score_0" AS "Score_0",
    t."Proba_1" AS "Proba_1",
    t."Score_1" AS "Score_1",
    t."Proba_2" AS "Proba_2",
    t."Score_2" AS "Score_2",
    t."Proba_3" AS "Proba_3",
    t."Score_3" AS "Score_3",
    t."Proba_4" AS "Proba_4",
    t."Score_4" AS "Score_4",
    t."Proba_5" AS "Proba_5",
    t."Score_5" AS "Score_5",
    t."Proba_6" AS "Proba_6",
    t."Score_6" AS "Score_6",
    t."Proba_7" AS "Proba_7",
    t."Score_7" AS "Score_7",
    t."Proba_8" AS "Proba_8",
    t."Score_8" AS "Score_8",
    t."Proba_9" AS "Proba_9",
    t."Score_9" AS "Score_9",
    CASE WHEN(t."Proba_0" = t."Max_Proba") THEN 0 else NULL END AS "max_idx_0",
    CASE WHEN(t."Proba_1" = t."Max_Proba") THEN 1 else NULL END AS "max_idx_1",
    CASE WHEN(t."Proba_2" = t."Max_Proba") THEN 2 else NULL END AS "max_idx_2",
    CASE WHEN(t."Proba_3" = t."Max_Proba") THEN 3 else NULL END AS "max_idx_3",
    CASE WHEN(t."Proba_4" = t."Max_Proba") THEN 4 else NULL END AS "max_idx_4",
    CASE WHEN(t."Proba_5" = t."Max_Proba") THEN 5 else NULL END AS "max_idx_5",
    CASE WHEN(t."Proba_6" = t."Max_Proba") THEN 6 else NULL END AS "max_idx_6",
    CASE WHEN(t."Proba_7" = t."Max_Proba") THEN 7 else NULL END AS "max_idx_7",
    CASE WHEN(t."Proba_8" = t."Max_Proba") THEN 8 else NULL END AS "max_idx_8",
    CASE WHEN(t."Proba_9" = t."Max_Proba") THEN 9 else NULL END AS "max_idx_9",
    t."Max_Proba" AS "Max_Proba",
    t."Max_Score" AS "Max_Score"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Proba_2" AS "Proba_2",
     t."Score_2" AS "Score_2",
     t."Proba_3" AS "Proba_3",
     t."Score_3" AS "Score_3",
     t."Proba_4" AS "Proba_4",
     t."Score_4" AS "Score_4",
     t."Proba_5" AS "Proba_5",
     t."Score_5" AS "Score_5",
     t."Proba_6" AS "Proba_6",
     t."Score_6" AS "Score_6",
     t."Proba_7" AS "Proba_7",
     t."Score_7" AS "Score_7",
     t."Proba_8" AS "Proba_8",
     t."Score_8" AS "Score_8",
     t."Proba_9" AS "Proba_9",
     t."Score_9" AS "Score_9",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1", t."max_idx_2", t."max_idx_3", t."max_idx_4", t."max_idx_5", t."max_idx_6", t."max_idx_7", t."max_idx_8", t."max_idx_9" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."Score_3" AS "Score_3",
  arg_max_cte."Proba_3" AS "Proba_3",
  CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN LN( arg_max_cte."Proba_3" ) ELSE -1.79769313486231e+308 END AS "LogProba_3",
  arg_max_cte."Score_4" AS "Score_4",
  arg_max_cte."Proba_4" AS "Proba_4",
  CASE WHEN (arg_max_cte."Proba_4" IS NULL OR arg_max_cte."Proba_4" > 0.0) THEN LN( arg_max_cte."Proba_4" ) ELSE -1.79769313486231e+308 END AS "LogProba_4",
  arg_max_cte."Score_5" AS "Score_5",
  arg_max_cte."Proba_5" AS "Proba_5",
  CASE WHEN (arg_max_cte."Proba_5" IS NULL OR arg_max_cte."Proba_5" > 0.0) THEN LN( arg_max_cte."Proba_5" ) ELSE -1.79769313486231e+308 END AS "LogProba_5",
  arg_max_cte."Score_6" AS "Score_6",
  arg_max_cte."Proba_6" AS "Proba_6",
  CASE WHEN (arg_max_cte."Proba_6" IS NULL OR arg_max_cte."Proba_6" > 0.0) THEN LN( arg_max_cte."Proba_6" ) ELSE -1.79769313486231e+308 END AS "LogProba_6",
  arg_max_cte."Score_7" AS "Score_7",
  arg_max_cte."Proba_7" AS "Proba_7",
  CASE WHEN (arg_max_cte."Proba_7" IS NULL OR arg_max_cte."Proba_7" > 0.0) THEN LN( arg_max_cte."Proba_7" ) ELSE -1.79769313486231e+308 END AS "LogProba_7",
  arg_max_cte."Score_8" AS "Score_8",
  arg_max_cte."Proba_8" AS "Proba_8",
  CASE WHEN (arg_max_cte."Proba_8" IS NULL OR arg_max_cte."Proba_8" > 0.0) THEN LN( arg_max_cte."Proba_8" ) ELSE -1.79769313486231e+308 END AS "LogProba_8",
  arg_max_cte."Score_9" AS "Score_9",
  arg_max_cte."Proba_9" AS "Proba_9",
  CASE WHEN (arg_max_cte."Proba_9" IS NULL OR arg_max_cte."Proba_9" > 0.0) THEN LN( arg_max_cte."Proba_9" ) ELSE -1.79769313486231e+308 END AS "LogProba_9",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte