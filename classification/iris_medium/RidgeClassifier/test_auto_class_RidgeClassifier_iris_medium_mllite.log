     sepal length (cm)  sepal width (cm)  ...  petal width (cm)  target
0                  5.1               3.5  ...               0.2       0
1                  4.9               3.0  ...               0.2       0
2                  4.7               3.2  ...               0.2       0
3                  4.6               3.1  ...               0.2       0
4                  5.0               3.6  ...               0.2       0
..                 ...               ...  ...               ...     ...
145                6.7               3.0  ...               2.3       2
146                6.3               2.5  ...               1.9       2
147                6.5               3.0  ...               2.0       2
148                6.2               3.4  ...               2.3       2
149                5.9               3.0  ...               1.8       2

[150 rows x 5 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[5.1 3.5 1.4 0.2]
 [4.9 3.  1.4 0.2]
 [4.7 3.2 1.3 0.2]
 [4.6 3.1 1.5 0.2]
 [5.  3.6 1.4 0.2]] [0 0 0 0 0]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 5
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 2 5
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 5
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 5
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 5 5
('OPERATION_END_ELAPSED', 0.009, 'TRAINING')
{ ,   }
{ ,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 150, "dataset_features" : 4 },
	"classes" : [ 0, 1, 2 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.722604,
			"coeffs" : [ 0.079178, 0.527384, -0.382754, -0.206277 ]
		},
		"class_1" : {
			"intercept" : 2.144600,
			"coeffs" : [ 0.019623, -0.941850, 0.334453, -0.808719 ]
		},
		"class_2" : {
			"intercept" : -2.421992,
			"coeffs" : [ -0.098799, 0.414462, 0.048296, 1.015004 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_iris_medium.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 150, "dataset_features" : 4 },
	"classes" : [ 0, 1, 2 ],
	"equations" : {
		"class_0" : {
			"intercept" : -0.722604,
			"coeffs" : [ 0.079178, 0.527384, -0.382754, -0.206277 ]
		},
		"class_1" : {
			"intercept" : 2.144600,
			"coeffs" : [ 0.019623, -0.941850, 0.334453, -0.808719 ]
		},
		"class_2" : {
			"intercept" : -2.421992,
			"coeffs" : [ -0.098799, 0.414462, 0.048296, 1.015004 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1, 2 ],
	"dataset" : 	{
		"dataset_features" : 4,
		"dataset_rows" : 150
	},
	"equations" : 	{
		"class_0" : 	{
			"coeffs" : [ 0.079178, 0.527384, -0.382754, -0.206277 ],
			"intercept" : -0.722604
		},
		"class_1" : 	{
			"coeffs" : [ 0.019623, -0.94185, 0.334453, -0.808719 ],
			"intercept" : 2.1446
		},
		"class_2" : 	{
			"coeffs" : [ -0.098799, 0.414462, 0.048296, 1.015004 ],
			"intercept" : -2.421992
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.7695 0.1412 0.0892]
 [0.6603 0.2557 0.084 ]
 [0.7167 0.1949 0.0884]
 [0.6648 0.2431 0.092 ]
 [0.7836 0.1249 0.0915]
 [0.7919 0.0872 0.1209]
 [0.7402 0.1526 0.1072]
 [0.7383 0.1697 0.092 ]
 [0.624  0.2883 0.0877]
 [0.6677 0.2547 0.0776]
 [0.7958 0.1149 0.0893]
 [0.7222 0.1804 0.0974]
 [0.6543 0.2707 0.0749]
 [0.6879 0.2364 0.0757]
 [0.8606 0.063  0.0764]
 [0.8544 0.0384 0.1072]
 [0.8257 0.0683 0.1061]
 [0.767  0.1325 0.1005]
 [0.792  0.1054 0.1026]
 [0.7989 0.0955 0.1056]
 [0.7218 0.1869 0.0913]
 [0.7804 0.1017 0.1179]
 [0.8143 0.0998 0.0859]
 [0.6899 0.1758 0.1343]
 [0.6834 0.2117 0.1049]
 [0.6327 0.2811 0.0861]
 [0.722  0.158  0.1199]
 [0.7605 0.1491 0.0904]
 [0.7538 0.1593 0.0868]
 [0.6768 0.2282 0.095 ]
 [0.6546 0.2541 0.0913]
 [0.7423 0.1477 0.11  ]
 [0.8442 0.0728 0.083 ]
 [0.8592 0.0551 0.0857]
 [0.6709 0.241  0.0881]
 [0.735  0.1827 0.0823]
 [0.7872 0.1313 0.0814]
 [0.784  0.1335 0.0824]
 [0.6647 0.2468 0.0885]
 [0.7403 0.1691 0.0906]
 [0.7755 0.1255 0.0991]
 [0.4691 0.4559 0.075 ]
 [0.7108 0.1967 0.0925]
 [0.7261 0.1216 0.1523]
 [0.7534 0.1129 0.1337]
 [0.6609 0.2424 0.0966]
 [0.7946 0.1083 0.0971]
 [0.7018 0.2062 0.092 ]
 [0.794  0.1153 0.0907]
 [0.7308 0.181  0.0882]
 [0.2595 0.342  0.3985]
 [0.2573 0.2868 0.4559]
 [0.2166 0.3615 0.4219]
 [0.1686 0.5863 0.2451]
 [0.1983 0.4248 0.3769]
 [0.1999 0.4715 0.3287]
 [0.2354 0.2476 0.517 ]
 [0.2454 0.5535 0.2011]
 [0.2212 0.4588 0.32  ]
 [0.2321 0.3999 0.368 ]
 [0.152  0.7083 0.1396]
 [0.2511 0.3119 0.437 ]
 [0.1512 0.7079 0.1409]
 [0.199  0.43   0.3711]
 [0.3128 0.336  0.3512]
 [0.2708 0.3394 0.3899]
 [0.2147 0.3367 0.4486]
 [0.2275 0.5556 0.2169]
 [0.1257 0.616  0.2583]
 [0.2104 0.5692 0.2204]
 [0.1863 0.2214 0.5923]
 [0.2602 0.4187 0.3212]
 [0.1334 0.5572 0.3094]
 [0.1886 0.5327 0.2787]
 [0.2494 0.4221 0.3285]
 [0.2536 0.3704 0.376 ]
 [0.188  0.485  0.3269]
 [0.1791 0.3337 0.4872]
 [0.2109 0.374  0.415 ]
 [0.2771 0.5129 0.21  ]
 [0.2014 0.5907 0.2079]
 [0.2094 0.6073 0.1833]
 [0.2505 0.4699 0.2796]
 [0.1353 0.4661 0.3986]
 [0.2105 0.3339 0.4556]
 [0.2563 0.2052 0.5385]
 [0.2318 0.3392 0.4291]
 [0.1446 0.6387 0.2166]
 [0.2699 0.3583 0.3718]
 [0.1995 0.517  0.2835]
 [0.1772 0.561  0.2618]
 [0.2221 0.3857 0.3922]
 [0.2216 0.5172 0.2612]
 [0.2267 0.5887 0.1846]
 [0.2126 0.4712 0.3162]
 [0.2662 0.4009 0.3329]
 [0.2456 0.4034 0.3509]
 [0.2453 0.42   0.3347]
 [0.3088 0.4513 0.2398]
 [0.2407 0.4262 0.3331]
 [0.0709 0.1102 0.8189]
 [0.1203 0.35   0.5297]
 [0.1019 0.2778 0.6202]
 [0.1173 0.3754 0.5072]
 [0.0925 0.2292 0.6783]
 [0.0775 0.3389 0.5836]
 [0.1385 0.4186 0.4429]
 [0.092  0.4581 0.45  ]
 [0.0828 0.5372 0.38  ]
 [0.0837 0.0852 0.831 ]
 [0.156  0.1966 0.6474]
 [0.1169 0.3788 0.5043]
 [0.1178 0.2455 0.6367]
 [0.1064 0.366  0.5277]
 [0.0919 0.1709 0.7372]
 [0.1128 0.1378 0.7494]
 [0.1335 0.3392 0.5274]
 [0.0968 0.1314 0.7718]
 [0.048  0.4126 0.5394]
 [0.0931 0.6609 0.246 ]
 [0.102  0.1612 0.7368]
 [0.129  0.2676 0.6034]
 [0.0683 0.4543 0.4774]
 [0.1456 0.3783 0.4761]
 [0.1197 0.1864 0.6939]
 [0.1277 0.3321 0.5403]
 [0.1599 0.3359 0.5042]
 [0.1675 0.2836 0.5489]
 [0.0974 0.2994 0.6032]
 [0.133  0.4534 0.4136]
 [0.0933 0.4365 0.4702]
 [0.1331 0.1623 0.7046]
 [0.0918 0.2657 0.6425]
 [0.1528 0.474  0.3733]
 [0.0976 0.6249 0.2775]
 [0.0885 0.2381 0.6734]
 [0.0946 0.1012 0.8043]
 [0.1392 0.3072 0.5536]
 [0.173  0.2742 0.5527]
 [0.13   0.2164 0.6536]
 [0.0925 0.1501 0.7575]
 [0.1277 0.152  0.7203]
 [0.1203 0.35   0.5297]
 [0.0922 0.1691 0.7387]
 [0.0857 0.1048 0.8095]
 [0.1154 0.1728 0.7118]
 [0.118  0.4162 0.4657]
 [0.1379 0.2506 0.6115]
 [0.1109 0.1098 0.7793]
 [0.1498 0.2961 0.5542]]
(150, 3)
(150, 3) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'iris_medium', 'size': 150, 'accuracy': 0.8466666666666667, 'auc': 0.9523999999999999}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_iris_medium.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'iris_medium', 'training_time_in_sec': 0.009, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_iris_medium.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.722604 + 0.079178 * X_0 + 0.527384 * X_1 + -0.382754 * X_2 + -0.206277 * X_3 AS "Score_0", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "LogProba_0",
   2.144600 + 0.019623 * X_0 + -0.941850 * X_1 + 0.334453 * X_2 + -0.808719 * X_3 AS "Score_1", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_1",
   -2.421992 + -0.098799 * X_0 + 0.414462 * X_1 + 0.048296 * X_2 + 1.015004 * X_3 AS "Score_2", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "LogProba_2"
  FROM model_input
 )
,
soft_max_orig_cte AS 
 (SELECT t."index" AS "index", 
   t."Score_0" AS "Score_0",
   t."Proba_0" AS "Proba_0",
   t."LogProba_0" AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Proba_
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
x_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."Score_2" AS "Score_2",
  arg_max_cte."Proba_2" AS "Proba_2",
  CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN LN( arg_max_cte."Proba_2" ) ELSE -1.79769313486231e+308 END AS "LogProba_2",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
   WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
     X_0  X_1  X_2  X_3  KEY
0    5.1  3.5  1.4  0.2    0
1    4.9  3.0  1.4  0.2    1
2    4.7  3.2  1.3  0.2    2
3    4.6  3.1  1.5  0.2    3
4    5.0  3.6  1.4  0.2    4
..   ...  ...  ...  ...  ...
145  6.7  3.0  5.2  2.3  145
146  6.3  2.5  5.0  1.9  146
147  6.5  3.0  5.2  2.0  147
148  6.2  3.4  5.4  2.3  148
149  5.9  3.0  5.1  1.8  149

[150 rows x 5 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
     index   Score_0   Proba_0  ...  LogProba_2  Decision  DecisionProba
0        0  0.949937  0.769522  ...   -2.416557         0       0.769522
1        1  0.670409  0.660340  ...   -2.477516         0       0.660340
2        2  0.798326  0.716717  ...   -2.425683         0       0.716717
3        3  0.661119  0.664849  ...   -2.385505         0       0.664849
4        4  0.994757  0.783619  ...   -2.391898         0       0.783619
..     ...       ...       ...  ...         ...       ...            ...
145    145 -1.074717  0.115354  ...   -0.339945         2       0.711809
146    146 -1.211019  0.118027  ...   -0.764110         2       0.465748
147    147 -1.028670  0.137943  ...   -0.491898         2       0.611465
148    148 -0.979903  0.110896  ...   -0.249326         2       0.779326
149    149 -0.996646  0.149763  ...   -0.590260         2       0.554183

[150 rows x 12 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Score_2', 'Proba_2', 'LogProba_2', 'Decision',
       'DecisionProba'],
      dtype='object')
     index   Score_0  SQL_Proba_0  ...  Py_Proba_1  Py_Proba_2  Py_Decision
134    134 -1.300630     0.097589  ...    0.624917    0.277493            1
135    135 -1.340018     0.088462  ...    0.238136    0.673402            2
136    136 -1.069164     0.094589  ...    0.101155    0.804256            2
137    137 -1.057420     0.139193  ...    0.307209    0.553598            2
138    138 -0.873902     0.173045  ...    0.274218    0.552737            2
139    139 -1.041439     0.130012  ...    0.216386    0.653602            2
140    140 -1.195708     0.092474  ...    0.150053    0.757473            2
141    141 -0.967868     0.127724  ...    0.151966    0.720310            2
142    142 -1.183406     0.120304  ...    0.350020    0.529676            2
143    143 -1.229250     0.092184  ...    0.169079    0.738737            2
144    144 -1.149134     0.085685  ...    0.104833    0.809481            2
145    145 -1.074717     0.115354  ...    0.172837    0.711809            2
146    146 -1.211019     0.118027  ...    0.416225    0.465748            2
147    147 -1.028670     0.137943  ...    0.250592    0.611465            2
148    148 -0.979903     0.110896  ...    0.109778    0.779326            2
149    149 -0.996646     0.149763  ...    0.296054    0.554183            2

[16 rows x 16 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
