          X_0       X_1       X_2  ...       X_8       X_9  target
0   -0.044962  1.210300  0.837871  ... -0.036524  0.927011       0
1   -0.899949  1.417506  0.234098  ...  1.065277 -0.527426       1
2    0.210234  0.615278 -0.232967  ... -0.159713  0.429757       0
3    1.372308 -0.697183  1.020035  ... -0.034774 -1.017369       1
4    0.739356  0.040085 -0.293706  ... -0.883563  0.285353       1
..        ...       ...       ...  ...       ...       ...     ...
507 -1.371079 -0.448472  2.455614  ... -0.836368  0.570578       1
508  1.140010 -0.836796  0.169285  ... -0.338076  1.167627       1
509  1.632208 -2.034283  0.818088  ... -0.256977  0.896508       0
510 -3.195565  1.571081 -0.291694  ...  0.663319 -0.701417       0
511  0.095037 -0.527445  0.090365  ... -0.948822  0.514737       1

[512 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-0.04496161  1.2103002   0.83787066  0.0368216   0.9801959   0.28167102
   0.77735424  0.49240956 -0.03652414  0.927011  ]
 [-0.8999486   1.4175057   0.23409756  0.05489743  0.9185508  -0.756675
  -0.02763553  0.20107657  1.0652769  -0.5274255 ]
 [ 0.21023437  0.6152782  -0.23296675  2.4819782   1.2316058  -2.0273561
  -0.7873507   0.38282165 -0.15971345  0.42975688]
 [ 1.3723081  -0.69718254  1.0200353  -0.1598945   0.9574759   0.64849085
   1.0359191   0.16233616 -0.03477355 -1.0173686 ]
 [ 0.73935616  0.04008485 -0.29370642 -1.0730926  -0.6452065   0.2920823
  -0.1579546   1.3678225  -0.8835631   0.28535333]] [0 1 0 1 1]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 4
('OPERATION_END_ELAPSED', 0.013, 'TRAINING')
{ "alpha" : 0.0000001,   }
{ "alpha" : 0.0000001,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W13", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.021692,
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.009400, 0.030133 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W13", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.021692,
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.009400, 0.030133 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 512
	},
	"equations" : 	{
		"class_1" : 	{
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.0094, 0.030133 ],
			"intercept" : -0.021692
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W13" },
	"options" :  { "alpha" : 0.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.4232 0.5768]
 [0.5739 0.4261]
 [0.6936 0.3064]
 ...
 [0.4976 0.5024]
 [0.7558 0.2442]
 [0.3115 0.6885]]
(512, 2)
(512,) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_medium', 'size': 512, 'accuracy': 0.8671875, 'auc': 0.9371633478294041}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_medium', 'training_time_in_sec': 0.013, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1_duckdb.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.007846 * t."X_7" + 0.009400 * t."X_8" + 0.030133 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 512 entries, 0 to 511
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     512 non-null    float32
 1   X_1     512 non-null    float32
 2   X_2     512 non-null    float32
 3   X_3     512 non-null    float32
 4   X_4     512 non-null    float32
 5   X_5     512 non-null    float32
 6   X_6     512 non-null    float32
 7   X_7     512 non-null    float32
 8   X_8     512 non-null    float32
 9   X_9     512 non-null    float32
dtypes: float32(10)
memory usage: 24.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -0.044962  1.210300  0.837871  ...  0.492410 -0.036524  0.927011
1     -0.899949  1.417506  0.234098  ...  0.201077  1.065277 -0.527426
2      0.210234  0.615278 -0.232967  ...  0.382822 -0.159713  0.429757
3      1.372308 -0.697183  1.020035  ...  0.162336 -0.034774 -1.017369
4      0.739356  0.040085 -0.293706  ...  1.367823 -0.883563  0.285353
...         ...       ...       ...  ...       ...       ...       ...
507   -1.371079 -0.448472  2.455614  ... -0.899182 -0.836368  0.570578
508    1.140010 -0.836796  0.169285  ... -1.595744 -0.338076  1.167627
509    1.632208 -2.034282  0.818088  ...  0.787438 -0.256977  0.896508
510   -3.195565  1.571081 -0.291694  ...  0.676890  0.663319 -0.701417
511    0.095037 -0.527445  0.090365  ...  1.243205 -0.948822  0.514737

[512 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 512 entries, 0 to 511
Data columns (total 9 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          512 non-null    int64  
 1   Score_0        512 non-null    float64
 2   Proba_0        512 non-null    float64
 3   LogProba_0     512 non-null    float64
 4   Score_1        512 non-null    float64
 5   Proba_1        512 non-null    float64
 6   LogProba_1     512 non-null    float64
 7   Decision       512 non-null    int64  
 8   DecisionProba  512 non-null    float64
dtypes: float64(7), int64(2)
memory usage: 36.1 KB
     index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0        0 -0.154900  0.423163  ...   -0.550196         1       0.576837
1        1  0.148894  0.573901  ...   -0.853085         0       0.573901
2        2  0.408550  0.693620  ...   -1.182930         0       0.693620
3        3 -0.200662  0.400995  ...   -0.512485         1       0.599005
4        4 -0.004018  0.497991  ...   -0.689138         1       0.502009
..     ...       ...       ...  ...         ...       ...            ...
507    507 -0.881894  0.146317  ...   -0.158195         1       0.853683
508    508 -0.557334  0.247002  ...   -0.283692         1       0.752998
509    509 -0.004790  0.497605  ...   -0.688369         1       0.502395
510    510  0.564908  0.755805  ...   -1.409788         0       0.755805
511    511 -0.396444  0.311549  ...   -0.373311         1       0.688451

[512 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
     index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
496    496 -0.629273     0.221224  ...    0.221224    0.778776            1
497    497 -0.258807     0.373410  ...    0.373410    0.626590            1
498    498 -0.600132     0.231428  ...    0.231429    0.768572            1
499    499 -0.809580     0.165321  ...    0.165321    0.834679            1
500    500  0.193852     0.595730  ...    0.595730    0.404270            0
501    501  0.463633     0.716520  ...    0.716520    0.283480            0
502    502  0.355111     0.670450  ...    0.670450    0.329550            0
503    503 -0.332369     0.339676  ...    0.339676    0.660324            1
504    504  0.077374     0.538610  ...    0.538610    0.461390            0
505    505  0.391619     0.686377  ...    0.686378    0.313623            0
506    506  0.096569     0.548135  ...    0.548135    0.451865            0
507    507 -0.881894     0.146317  ...    0.146317    0.853683            1
508    508 -0.557334     0.247002  ...    0.247002    0.752998            1
509    509 -0.004790     0.497605  ...    0.497605    0.502395            1
510    510  0.564908     0.755805  ...    0.755805    0.244195            0
511    511 -0.396444     0.311549  ...    0.311549    0.688451            1

[16 rows x 12 columns]
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb') ('Py_Proba_0', 'SQL_Proba_0') 1.3186514358584254e-07
     Py_Proba_0  SQL_Proba_0   SQL_Error_0
496    0.221224     0.221224 -6.317992e-08
497    0.373410     0.373410  2.053650e-07
498    0.231429     0.231428  1.805992e-07
499    0.165321     0.165321  1.956321e-07
500    0.595730     0.595730 -1.188843e-07
501    0.716520     0.716520 -1.102710e-07
502    0.670450     0.670450 -2.603884e-07
503    0.339676     0.339676  4.235272e-08
504    0.538610     0.538610 -6.921200e-08
505    0.686378     0.686377  1.363426e-07
506    0.548135     0.548135  1.710328e-07
507    0.146317     0.146317  6.189024e-08
508    0.247002     0.247002  2.057726e-07
509    0.497605     0.497605 -1.645299e-08
510    0.755805     0.755805 -1.960104e-07
511    0.311549     0.311549 -2.025942e-07
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb') ('Py_Proba_1', 'SQL_Proba_1') 1.334933746575148e-07
     Py_Proba_1  SQL_Proba_1   SQL_Error_1
496    0.778776     0.778776  4.827876e-08
497    0.626590     0.626590 -2.053650e-07
498    0.768572     0.768572 -1.209946e-07
499    0.834679     0.834679 -1.956321e-07
500    0.404270     0.404270  1.486866e-07
501    0.283480     0.283480  1.400734e-07
502    0.329550     0.329550  3.199930e-07
503    0.660324     0.660324 -7.215504e-08
504    0.461390     0.461390  1.288166e-07
505    0.313623     0.313623 -1.065403e-07
506    0.451865     0.451865 -1.710328e-07
507    0.853683     0.853683 -9.169256e-08
508    0.752998     0.752998 -2.057726e-07
509    0.502395     0.502395 -1.334933e-08
510    0.244195     0.244195  2.258128e-07
511    0.688451     0.688451  2.621989e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('BinaryClass_10_medium', 'RidgeClassifier', 'duckdb', 'Success')
     Py_Decision  SQL_Decision
496            1             1
497            1             1
498            1             1
499            1             1
500            0             0
501            0             0
502            0             0
503            1             1
504            0             0
505            0             0
506            0             0
507            1             1
508            1             1
509            1             1
510            0             0
511            1             1
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1_sqlite.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.007846 * t."X_7" + 0.009400 * t."X_8" + 0.030133 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 512 entries, 0 to 511
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     512 non-null    float32
 1   X_1     512 non-null    float32
 2   X_2     512 non-null    float32
 3   X_3     512 non-null    float32
 4   X_4     512 non-null    float32
 5   X_5     512 non-null    float32
 6   X_6     512 non-null    float32
 7   X_7     512 non-null    float32
 8   X_8     512 non-null    float32
 9   X_9     512 non-null    float32
dtypes: float32(10)
memory usage: 24.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -0.044962  1.210300  0.837871  ...  0.492410 -0.036524  0.927011
1     -0.899949  1.417506  0.234098  ...  0.201077  1.065277 -0.527426
2      0.210234  0.615278 -0.232967  ...  0.382822 -0.159713  0.429757
3      1.372308 -0.697183  1.020035  ...  0.162336 -0.034774 -1.017369
4      0.739356  0.040085 -0.293706  ...  1.367823 -0.883563  0.285353
...         ...       ...       ...  ...       ...       ...       ...
507   -1.371079 -0.448472  2.455614  ... -0.899182 -0.836368  0.570578
508    1.140010 -0.836796  0.169285  ... -1.595744 -0.338076  1.167627
509    1.632208 -2.034282  0.818088  ...  0.787438 -0.256977  0.896508
510   -3.195565  1.571081 -0.291694  ...  0.676890  0.663319 -0.701417
511    0.095037 -0.527445  0.090365  ...  1.243205 -0.948822  0.514737

[512 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 512 entries, 0 to 511
Data columns (total 9 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          512 non-null    int64  
 1   Score_0        512 non-null    float64
 2   Proba_0        512 non-null    float64
 3   LogProba_0     512 non-null    float64
 4   Score_1        512 non-null    float64
 5   Proba_1        512 non-null    float64
 6   LogProba_1     512 non-null    float64
 7   Decision       512 non-null    int64  
 8   DecisionProba  512 non-null    float64
dtypes: float64(7), int64(2)
memory usage: 36.1 KB
     index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0        0 -0.154900  0.423164  ...   -0.550196         1       0.576836
1        1  0.148894  0.573901  ...   -0.853085         0       0.573901
2        2  0.408550  0.693620  ...   -1.182930         0       0.693620
3        3 -0.200662  0.400995  ...   -0.512485         1       0.599005
4        4 -0.004018  0.497991  ...   -0.689138         1       0.502009
..     ...       ...       ...  ...         ...       ...            ...
507    507 -0.881894  0.146317  ...   -0.158195         1       0.853683
508    508 -0.557334  0.247002  ...   -0.283692         1       0.752998
509    509 -0.004790  0.497605  ...   -0.688369         1       0.502395
510    510  0.564908  0.755805  ...   -1.409788         0       0.755805
511    511 -0.396444  0.311549  ...   -0.373311         1       0.688451

[512 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
     index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
496    496 -0.629273     0.221224  ...    0.221224    0.778776            1
497    497 -0.258807     0.373410  ...    0.373410    0.626590            1
498    498 -0.600132     0.231428  ...    0.231429    0.768572            1
499    499 -0.809580     0.165321  ...    0.165321    0.834679            1
500    500  0.193852     0.595730  ...    0.595730    0.404270            0
501    501  0.463633     0.716520  ...    0.716520    0.283480            0
502    502  0.355111     0.670450  ...    0.670450    0.329550            0
503    503 -0.332369     0.339676  ...    0.339676    0.660324            1
504    504  0.077374     0.538610  ...    0.538610    0.461390            0
505    505  0.391619     0.686377  ...    0.686378    0.313623            0
506    506  0.096569     0.548135  ...    0.548135    0.451865            0
507    507 -0.881894     0.146317  ...    0.146317    0.853683            1
508    508 -0.557334     0.247002  ...    0.247002    0.752998            1
509    509 -0.004790     0.497605  ...    0.497605    0.502395            1
510    510  0.564908     0.755805  ...    0.755805    0.244195            0
511    511 -0.396444     0.311549  ...    0.311549    0.688451            1

[16 rows x 12 columns]
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite') ('Py_Proba_0', 'SQL_Proba_0') 1.3126129015867457e-07
     Py_Proba_0  SQL_Proba_0   SQL_Error_0
496    0.221224     0.221224 -6.506080e-08
497    0.373410     0.373410  2.011135e-07
498    0.231429     0.231428  2.030912e-07
499    0.165321     0.165321  1.977413e-07
500    0.595730     0.595730 -1.153601e-07
501    0.716520     0.716520 -1.035925e-07
502    0.670450     0.670450 -2.483180e-07
503    0.339676     0.339676  4.191071e-08
504    0.538610     0.538610 -6.649175e-08
505    0.686378     0.686377  1.410256e-07
506    0.548135     0.548135  1.724046e-07
507    0.146317     0.146317  8.224486e-08
508    0.247002     0.247002  1.914531e-07
509    0.497605     0.497605 -2.234053e-08
510    0.755805     0.755805 -2.007376e-07
511    0.311549     0.311549 -2.003867e-07
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite') ('Py_Proba_1', 'SQL_Proba_1') 1.3262101232036205e-07
     Py_Proba_1  SQL_Proba_1   SQL_Error_1
496    0.778776     0.778776  5.015964e-08
497    0.626590     0.626590 -2.011135e-07
498    0.768572     0.768572 -1.434866e-07
499    0.834679     0.834679 -1.977413e-07
500    0.404270     0.404270  1.451624e-07
501    0.283480     0.283480  1.333948e-07
502    0.329550     0.329550  3.079227e-07
503    0.660324     0.660324 -7.171303e-08
504    0.461390     0.461390  1.260964e-07
505    0.313623     0.313623 -1.112233e-07
506    0.451865     0.451865 -1.724046e-07
507    0.853683     0.853683 -1.120472e-07
508    0.752998     0.752998 -1.914531e-07
509    0.502395     0.502395 -7.461791e-09
510    0.244195     0.244195  2.305399e-07
511    0.688451     0.688451  2.599914e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('BinaryClass_10_medium', 'RidgeClassifier', 'sqlite', 'Success')
     Py_Decision  SQL_Decision
496            1             1
497            1             1
498            1             1
499            1             1
500            0             0
501            0             0
502            0             0
503            1             1
504            0             0
505            0             0
506            0             0
507            1             1
508            1             1
509            1             1
510            0             0
511            1             1
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1_pgsql.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'pgsql')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.007846 * t."X_7" + 0.009400 * t."X_8" + 0.030133 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.021692 + 0.015772 * t."X_0" + 0.031974 * t."X_1" + 0.179656 * t."X_2" + 0.051683 * t."X_3" + -0.177418 * t."X_4" + 0.229475 * t."X_5" + 0.291518 * t."X_6" + -0.
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'pgsql')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_medium', 'RidgeClassifier', 'pgsql')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_medium', 'RidgeClassifier', 'pgsql') 




COPY_TRAINING_DATA_TO_SQLITE_START
