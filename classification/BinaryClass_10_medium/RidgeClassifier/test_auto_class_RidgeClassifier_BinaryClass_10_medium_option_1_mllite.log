          X_0       X_1       X_2  ...       X_8       X_9  target
0   -0.044962  1.210300  0.837871  ... -0.036524  0.927011       0
1   -0.899949  1.417506  0.234098  ...  1.065277 -0.527426       1
2    0.210234  0.615278 -0.232967  ... -0.159713  0.429757       0
3    1.372308 -0.697183  1.020035  ... -0.034774 -1.017369       1
4    0.739356  0.040085 -0.293706  ... -0.883563  0.285353       1
..        ...       ...       ...  ...       ...       ...     ...
507 -1.371079 -0.448472  2.455614  ... -0.836368  0.570578       1
508  1.140010 -0.836796  0.169285  ... -0.338076  1.167627       1
509  1.632208 -2.034283  0.818088  ... -0.256977  0.896508       0
510 -3.195565  1.571081 -0.291694  ...  0.663319 -0.701417       0
511  0.095037 -0.527445  0.090365  ... -0.948822  0.514737       1

[512 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-0.04496161  1.2103002   0.83787066  0.0368216   0.9801959   0.28167102
   0.77735424  0.49240956 -0.03652414  0.927011  ]
 [-0.8999486   1.4175057   0.23409756  0.05489743  0.9185508  -0.756675
  -0.02763553  0.20107657  1.0652769  -0.5274255 ]
 [ 0.21023437  0.6152782  -0.23296675  2.4819782   1.2316058  -2.0273561
  -0.7873507   0.38282165 -0.15971345  0.42975688]
 [ 1.3723081  -0.69718254  1.0200353  -0.1598945   0.9574759   0.64849085
   1.0359191   0.16233616 -0.03477355 -1.0173686 ]
 [ 0.73935616  0.04008485 -0.29370642 -1.0730926  -0.6452065   0.2920823
  -0.1579546   1.3678225  -0.8835631   0.28535333]] [0 1 0 1 1]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 4
('OPERATION_END_ELAPSED', 0.008, 'TRAINING')
{ "alpha" : 0.0000001,   }
{ "alpha" : 0.0000001,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.021692,
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.009400, 0.030133 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 512, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.021692,
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.009400, 0.030133 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 512
	},
	"equations" : 	{
		"class_1" : 	{
			"coeffs" : [ 0.015772, 0.031974, 0.179656, 0.051683, -0.177418, 0.229475, 0.291518, -0.007846, 0.0094, 0.030133 ],
			"intercept" : -0.021692
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 0.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.3499 0.6501]
 [0.6446 0.3554]
 [0.8367 0.1633]
 ...
 [0.4952 0.5048]
 [0.9055 0.0945]
 [0.17   0.83  ]]
(512, 2)
(512,) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_medium', 'size': 512, 'accuracy': 0.8671875, 'auc': 0.9371633478294041}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_medium', 'training_time_in_sec': 0.008, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_medium_option_1.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.021692 + 0.015772 * X_0 + 0.031974 * X_1 + 0.179656 * X_2 + 0.051683 * X_3 + -0.177418 * X_4 + 0.229475 * X_5 + 0.291518 * X_6 + -0.007846 * X_7 + 0.009400 * X_8 + 0.030133 * X_9 AS "Score_1", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_1"
  FROM model_input
 )
,
soft_max_orig_cte AS 
 (SELECT t."index" AS "index", 
   -t."Score_1" AS "Score_0",
   1.0 - t."Proba_1" AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Prob
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
ax."index" AS "index_Score",
     max(union_with_max.class) AS "arg_max_Score"
    FROM union_with_max
    WHERE union_with_max."max_Score" <= union_with_max."Score"
    GROUP BY union_with_max."index"
   ) AS "arg_max_t_Score"
   ON score_max."index" = "arg_max_t_Score"."index_Score"
 )
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
          X_0       X_1       X_2       X_3  ...       X_7       X_8       X_9  KEY
0   -0.044962  1.210300  0.837871  0.036822  ...  0.492410 -0.036524  0.927011    0
1   -0.899949  1.417506  0.234098  0.054897  ...  0.201077  1.065277 -0.527426    1
2    0.210234  0.615278 -0.232967  2.481978  ...  0.382822 -0.159713  0.429757    2
3    1.372308 -0.697183  1.020035 -0.159894  ...  0.162336 -0.034774 -1.017369    3
4    0.739356  0.040085 -0.293706 -1.073093  ...  1.367823 -0.883563  0.285353    4
..        ...       ...       ...       ...  ...       ...       ...       ...  ...
507 -1.371079 -0.448472  2.455614 -0.257140  ... -0.899182 -0.836368  0.570578  507
508  1.140010 -0.836796  0.169285 -0.248971  ... -1.595744 -0.338076  1.167627  508
509  1.632208 -2.034282  0.818088  0.624015  ...  0.787438 -0.256977  0.896508  509
510 -3.195565  1.571081 -0.291694 -1.220009  ...  0.676890  0.663319 -0.701417  510
511  0.095037 -0.527445  0.090365 -2.058599  ...  1.243205 -0.948822  0.514737  511

[512 rows x 11 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
     index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0        0 -0.309800  0.349872  ...   -0.430587         1       0.650128
1        1  0.297787  0.644643  ...   -1.034633         0       0.644643
2        2  0.817100  0.836744  ...   -1.812436         0       0.836744
3        3 -0.401323  0.309460  ...   -0.370281         1       0.690540
4        4 -0.008035  0.495982  ...   -0.685144         1       0.504018
..     ...       ...       ...  ...         ...       ...            ...
507    507 -1.763787  0.028538  ...   -0.028953         1       0.971462
508    508 -1.114667  0.097147  ...   -0.102195         1       0.902853
509    509 -0.009580  0.495210  ...   -0.683613         1       0.504790
510    510  1.129816  0.905478  ...   -2.358925         0       0.905478
511    511 -0.792887  0.169979  ...   -0.186305         1       0.830021

[512 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
     index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
496    496 -1.258545     0.074669  ...    0.074669    0.925331            1
497    497 -0.517614     0.262072  ...    0.262072    0.737928            1
498    498 -1.200264     0.083132  ...    0.083133    0.916867            1
499    499 -1.619159     0.037749  ...    0.037749    0.962251            1
500    500  0.387704     0.684690  ...    0.684689    0.315311            0
501    501  0.927266     0.864658  ...    0.864658    0.135342            0
502    502  0.710222     0.805408  ...    0.805408    0.194592            0
503    503 -0.664738     0.209246  ...    0.209246    0.790754            1
504    504  0.154748     0.576762  ...    0.576762    0.423238            0
505    505  0.783237     0.827280  ...    0.827281    0.172719            0
506    506  0.193138     0.595386  ...    0.595386    0.404614            0
507    507 -1.763787     0.028538  ...    0.028538    0.971462            1
508    508 -1.114667     0.097147  ...    0.097147    0.902853            1
509    509 -0.009580     0.495210  ...    0.495210    0.504790            1
510    510  1.129816     0.905478  ...    0.905478    0.094522            0
511    511 -0.792887     0.169979  ...    0.169979    0.830021            1

[16 rows x 12 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
