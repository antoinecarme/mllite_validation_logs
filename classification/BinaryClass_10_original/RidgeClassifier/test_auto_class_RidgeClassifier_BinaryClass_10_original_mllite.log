           X_0       X_1       X_2  ...       X_8       X_9  target
0    -0.044962  1.210300  0.837871  ... -0.036524  0.927011       0
1    -0.899949  1.417506  0.234098  ...  1.065277 -0.527426       1
2     0.210234  0.615278 -0.232967  ... -0.159713  0.429757       0
3     1.372308 -0.697183  1.020035  ... -0.034774 -1.017369       1
4     0.739356  0.040085 -0.293706  ... -0.883563  0.285353       1
...        ...       ...       ...  ...       ...       ...     ...
1019 -0.058483 -1.779904 -0.254862  ... -0.153581 -0.985507       0
1020  1.255606 -0.013681  0.449152  ...  0.378835 -1.298635       1
1021 -0.089580  1.652395  2.166799  ...  1.468157  0.495584       1
1022  0.068715  0.881708 -0.127262  ...  0.086143  0.694782       0
1023 -0.813953 -0.452211 -1.339893  ...  1.326070  0.079805       0

[1024 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-0.04496161  1.2103002   0.83787066  0.0368216   0.9801959   0.28167102
   0.77735424  0.49240956 -0.03652414  0.927011  ]
 [-0.8999486   1.4175057   0.23409756  0.05489743  0.9185508  -0.756675
  -0.02763553  0.20107657  1.0652769  -0.5274255 ]
 [ 0.21023437  0.6152782  -0.23296675  2.4819782   1.2316058  -2.0273561
  -0.7873507   0.38282165 -0.15971345  0.42975688]
 [ 1.3723081  -0.69718254  1.0200353  -0.1598945   0.9574759   0.64849085
   1.0359191   0.16233616 -0.03477355 -1.0173686 ]
 [ 0.73935616  0.04008485 -0.29370642 -1.0730926  -0.6452065   0.2920823
  -0.1579546   1.3678225  -0.8835631   0.28535333]] [0 1 0 1 1]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 4
('OPERATION_END_ELAPSED', 0.008, 'TRAINING')
{ ,   }
{ ,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013403,
			"coeffs" : [ 0.003408, 0.010715, 0.157312, 0.012400, -0.156103, 0.282819, 0.226460, -0.009617, 0.025241, -0.006661 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier None
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { ,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 1.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013403,
			"coeffs" : [ 0.003408, 0.010715, 0.157312, 0.012400, -0.156103, 0.282819, 0.226460, -0.009617, 0.025241, -0.006661 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 1024
	},
	"equations" : 	{
		"class_1" : 	{
			"coeffs" : [ 0.003408, 0.010715, 0.157312, 0.0124, -0.156103, 0.282819, 0.22646, -0.009617, 0.025241, -0.006661 ],
			"intercept" : -0.013403
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 1.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.3905 0.6095]
 [0.6452 0.3548]
 [0.8736 0.1264]
 ...
 [0.046  0.954 ]
 [0.8671 0.1329]
 [0.8215 0.1785]]
(1024, 2)
(1024,) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'BinaryClass_10_original', 'size': 1024, 'accuracy': 0.8525390625, 'auc': 0.9299868756390495}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': None, 'dataset': 'BinaryClass_10_original', 'training_time_in_sec': 0.008, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.013403 + 0.003408 * X_0 + 0.010715 * X_1 + 0.157312 * X_2 + 0.012400 * X_3 + -0.156103 * X_4 + 0.282819 * X_5 + 0.226460 * X_6 + -0.009617 * X_7 + 0.025241 * X_8 + -0.006661 * X_9 AS "Score_1", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_1"
  FROM model_input
 )
,
soft_max_orig_cte AS 
 (SELECT t."index" AS "index", 
   -t."Score_1" AS "Score_0",
   1.0 - t."Proba_1" AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Pro
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
ax."index" AS "index_Score",
     max(union_with_max.class) AS "arg_max_Score"
    FROM union_with_max
    WHERE union_with_max."max_Score" <= union_with_max."Score"
    GROUP BY union_with_max."index"
   ) AS "arg_max_t_Score"
   ON score_max."index" = "arg_max_t_Score"."index_Score"
 )
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
           X_0       X_1       X_2  ...       X_8       X_9   KEY
0    -0.044962  1.210300  0.837871  ... -0.036524  0.927011     0
1    -0.899949  1.417506  0.234098  ...  1.065277 -0.527426     1
2     0.210234  0.615278 -0.232967  ... -0.159713  0.429757     2
3     1.372308 -0.697183  1.020035  ... -0.034774 -1.017369     3
4     0.739356  0.040085 -0.293706  ... -0.883563  0.285353     4
...        ...       ...       ...  ...       ...       ...   ...
1019 -0.058483 -1.779904 -0.254862  ... -0.153581 -0.985507  1019
1020  1.255606 -0.013681  0.449152  ...  0.378835 -1.298635  1020
1021 -0.089580  1.652395  2.166799  ...  1.468157  0.495584  1021
1022  0.068715  0.881708 -0.127262  ...  0.086143  0.694782  1022
1023 -0.813953 -0.452211 -1.339893  ...  1.326070  0.079805  1023

[1024 rows x 11 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
      index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0         0 -0.222534  0.390534  ...   -0.495172         1       0.609466
1         1  0.298955  0.645178  ...   -1.036139         0       0.645178
2         2  0.966477  0.873576  ...   -2.068114         0       0.873576
3         3 -0.415157  0.303579  ...   -0.361800         1       0.696421
4         4 -0.040234  0.479894  ...   -0.653722         1       0.520106
...     ...       ...       ...  ...         ...       ...            ...
1019   1019  0.045852  0.522910  ...   -0.740050         0       0.522910
1020   1020  0.111813  0.555675  ...   -0.811198         0       0.555675
1021   1021 -1.515453  0.046049  ...   -0.047143         1       0.953951
1022   1022  0.937783  0.867101  ...   -2.018166         0       0.867101
1023   1023  0.763406  0.821539  ...   -1.723387         0       0.821539

[1024 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
1008   1008 -0.064978     0.467557  ...    0.467557    0.532443            1
1009   1009  1.436149     0.946460  ...    0.946460    0.053540            0
1010   1010  0.722819     0.809326  ...    0.809326    0.190674            0
1011   1011 -0.979698     0.123532  ...    0.123532    0.876468            1
1012   1012  1.273620     0.927388  ...    0.927388    0.072612            0
1013   1013 -0.328626     0.341357  ...    0.341357    0.658643            1
1014   1014  1.271752     0.927136  ...    0.927136    0.072864            0
1015   1015 -0.546978     0.250874  ...    0.250874    0.749126            1
1016   1016 -0.831068     0.159475  ...    0.159476    0.840524            1
1017   1017 -0.778430     0.174098  ...    0.174097    0.825903            1
1018   1018 -0.307007     0.351144  ...    0.351144    0.648856            1
1019   1019  0.045852     0.522910  ...    0.522910    0.477090            0
1020   1020  0.111813     0.555675  ...    0.555674    0.444326            0
1021   1021 -1.515453     0.046049  ...    0.046049    0.953951            1
1022   1022  0.937783     0.867101  ...    0.867101    0.132899            0
1023   1023  0.763406     0.821539  ...    0.821540    0.178460            0

[16 rows x 12 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
