           X_0       X_1       X_2  ...       X_8       X_9  target
0    -0.044962  1.210300  0.837871  ... -0.036524  0.927011       0
1    -0.899949  1.417506  0.234098  ...  1.065277 -0.527426       1
2     0.210234  0.615278 -0.232967  ... -0.159713  0.429757       0
3     1.372308 -0.697183  1.020035  ... -0.034774 -1.017369       1
4     0.739356  0.040085 -0.293706  ... -0.883563  0.285353       1
...        ...       ...       ...  ...       ...       ...     ...
1019 -0.058483 -1.779904 -0.254862  ... -0.153581 -0.985507       0
1020  1.255606 -0.013681  0.449152  ...  0.378835 -1.298635       1
1021 -0.089580  1.652395  2.166799  ...  1.468157  0.495584       1
1022  0.068715  0.881708 -0.127262  ...  0.086143  0.694782       0
1023 -0.813953 -0.452211 -1.339893  ...  1.326070  0.079805       0

[1024 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-0.04496161  1.2103002   0.83787066  0.0368216   0.9801959   0.28167102
   0.77735424  0.49240956 -0.03652414  0.927011  ]
 [-0.8999486   1.4175057   0.23409756  0.05489743  0.9185508  -0.756675
  -0.02763553  0.20107657  1.0652769  -0.5274255 ]
 [ 0.21023437  0.6152782  -0.23296675  2.4819782   1.2316058  -2.0273561
  -0.7873507   0.38282165 -0.15971345  0.42975688]
 [ 1.3723081  -0.69718254  1.0200353  -0.1598945   0.9574759   0.64849085
   1.0359191   0.16233616 -0.03477355 -1.0173686 ]
 [ 0.73935616  0.04008485 -0.29370642 -1.0730926  -0.6452065   0.2920823
  -0.1579546   1.3678225  -0.8835631   0.28535333]] [0 1 0 1 1]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 4
('OPERATION_END_ELAPSED', 0.009, 'TRAINING')
{ "alpha" : 0.0000001,   }
{ "alpha" : 0.0000001,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W13", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013661,
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W13", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013661,
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 1024
	},
	"equations" : 	{
		"class_1" : 	{
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ],
			"intercept" : -0.013661
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W13" },
	"options" :  { "alpha" : 0.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.4397 0.5603]
 [0.5792 0.4208]
 [0.7359 0.2641]
 ...
 [0.1651 0.8349]
 [0.7309 0.2691]
 [0.6943 0.3057]]
(1024, 2)
(1024,) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_original', 'size': 1024, 'accuracy': 0.8515625, 'auc': 0.9300784409480063}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_original', 'training_time_in_sec': 0.009, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1_duckdb.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0.009627 * t."X_7" + 0.025265 * t."X_8" + -0.006674 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 1024 entries, 0 to 1023
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     1024 non-null   float32
 1   X_1     1024 non-null   float32
 2   X_2     1024 non-null   float32
 3   X_3     1024 non-null   float32
 4   X_4     1024 non-null   float32
 5   X_5     1024 non-null   float32
 6   X_6     1024 non-null   float32
 7   X_7     1024 non-null   float32
 8   X_8     1024 non-null   float32
 9   X_9     1024 non-null   float32
dtypes: float32(10)
memory usage: 48.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -0.044962  1.210300  0.837871  ...  0.492410 -0.036524  0.927011
1     -0.899949  1.417506  0.234098  ...  0.201077  1.065277 -0.527426
2      0.210234  0.615278 -0.232967  ...  0.382822 -0.159713  0.429757
3      1.372308 -0.697183  1.020035  ...  0.162336 -0.034774 -1.017369
4      0.739356  0.040085 -0.293706  ...  1.367823 -0.883563  0.285353
...         ...       ...       ...  ...       ...       ...       ...
1019  -0.058483 -1.779904 -0.254862  ...  0.493898 -0.153581 -0.985507
1020   1.255606 -0.013681  0.449152  ...  0.622254  0.378835 -1.298635
1021  -0.089580  1.652395  2.166799  ... -0.581063  1.468157  0.495584
1022   0.068715  0.881708 -0.127262  ... -1.644819  0.086143  0.694782
1023  -0.813953 -0.452211 -1.339893  ... -0.620387  1.326070  0.079805

[1024 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1024 entries, 0 to 1023
Data columns (total 9 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          1024 non-null   int64  
 1   Score_0        1024 non-null   float64
 2   Proba_0        1024 non-null   float64
 3   LogProba_0     1024 non-null   float64
 4   Score_1        1024 non-null   float64
 5   Proba_1        1024 non-null   float64
 6   LogProba_1     1024 non-null   float64
 7   Decision       1024 non-null   int64  
 8   DecisionProba  1024 non-null   float64
dtypes: float64(7), int64(2)
memory usage: 72.1 KB
      index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0         0 -0.121209  0.439691  ...   -0.579266         1       0.560309
1         1  0.159772  0.579213  ...   -0.865628         0       0.579213
2         2  0.512493  0.735943  ...   -1.331589         0       0.735943
3         3 -0.224961  0.389380  ...   -0.493280         1       0.610620
4         4 -0.021372  0.489316  ...   -0.672004         1       0.510684
...     ...       ...       ...  ...         ...       ...            ...
1019   1019  0.025082  0.512539  ...   -0.718544         0       0.512539
1020   1020  0.056693  0.528316  ...   -0.751446         0       0.528316
1021   1021 -0.810354  0.165107  ...   -0.180452         1       0.834893
1022   1022  0.499681  0.730933  ...   -1.312795         0       0.730933
1023   1023  0.410096  0.694277  ...   -1.185076         0       0.694277

[1024 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
1008   1008 -0.037377     0.481320  ...    0.481320    0.518680            1
1009   1009  0.774781     0.824850  ...    0.824850    0.175150            0
1010   1010  0.387802     0.684732  ...    0.684732    0.315268            0
1011   1011 -0.527524     0.258257  ...    0.258257    0.741743            1
1012   1012  0.680270     0.795847  ...    0.795847    0.204153            0
1013   1013 -0.176751     0.412533  ...    0.412534    0.587466            1
1014   1014  0.679862     0.795715  ...    0.795715    0.204285            0
1015   1015 -0.290187     0.358847  ...    0.358847    0.641153            1
1016   1016 -0.443370     0.291783  ...    0.291783    0.708217            1
1017   1017 -0.418526     0.302156  ...    0.302156    0.697844            1
1018   1018 -0.163839     0.418806  ...    0.418806    0.581194            1
1019   1019  0.025082     0.512539  ...    0.512539    0.487461            0
1020   1020  0.056693     0.528316  ...    0.528316    0.471684            0
1021   1021 -0.810354     0.165107  ...    0.165108    0.834892            1
1022   1022  0.499681     0.730933  ...    0.730933    0.269067            0
1023   1023  0.410096     0.694277  ...    0.694277    0.305723            0

[16 rows x 12 columns]
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_0', 'SQL_Proba_0') 2.1364040035796626e-07
      Py_Proba_0  SQL_Proba_0   SQL_Error_0
1008    0.481320     0.481320  1.476672e-07
1009    0.824850     0.824850 -2.743743e-07
1010    0.684732     0.684732 -6.856248e-08
1011    0.258257     0.258257  4.777417e-07
1012    0.795847     0.795847 -5.805353e-08
1013    0.412534     0.412533  1.632453e-07
1014    0.795715     0.795715 -2.437647e-07
1015    0.358847     0.358847  3.900285e-07
1016    0.291783     0.291783  1.219464e-07
1017    0.302156     0.302156  2.090527e-07
1018    0.418806     0.418806  2.841199e-07
1019    0.512539     0.512539  2.767834e-07
1020    0.528316     0.528316  7.108916e-08
1021    0.165108     0.165107  3.280686e-07
1022    0.730933     0.730933 -1.378751e-08
1023    0.694277     0.694277 -1.542811e-07
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb') ('Py_Proba_1', 'SQL_Proba_1') 2.141374728709724e-07
      Py_Proba_1  SQL_Proba_1   SQL_Error_1
1008    0.518680     0.518680 -1.476672e-07
1009    0.175150     0.175150  1.998685e-07
1010    0.315268     0.315268  9.836480e-08
1011    0.741743     0.741743 -5.075440e-07
1012    0.204153     0.204153  1.027570e-07
1013    0.587466     0.587467 -1.632453e-07
1014    0.204285     0.204285  2.288636e-07
1015    0.641153     0.641153 -4.496331e-07
1016    0.708217     0.708217 -1.517488e-07
1017    0.697844     0.697844 -2.090527e-07
1018    0.581194     0.581194 -3.139222e-07
1019    0.487461     0.487461 -2.767834e-07
1020    0.471684     0.471684 -1.306938e-07
1021    0.834892     0.834893 -3.280686e-07
1022    0.269067     0.269067 -4.581714e-08
1023    0.305723     0.305723  2.138857e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('BinaryClass_10_original', 'RidgeClassifier', 'duckdb', 'Success')
      Py_Decision  SQL_Decision
1008            1             1
1009            0             0
1010            0             0
1011            1             1
1012            0             0
1013            1             1
1014            0             0
1015            1             1
1016            1             1
1017            1             1
1018            1             1
1019            0             0
1020            0             0
1021            1             1
1022            0             0
1023            0             0
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1_sqlite.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0.009627 * t."X_7" + 0.025265 * t."X_8" + -0.006674 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite') 




COPY_TRAINING_DATA_TO_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
Index: 1024 entries, 0 to 1023
Data columns (total 10 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   X_0     1024 non-null   float32
 1   X_1     1024 non-null   float32
 2   X_2     1024 non-null   float32
 3   X_3     1024 non-null   float32
 4   X_4     1024 non-null   float32
 5   X_5     1024 non-null   float32
 6   X_6     1024 non-null   float32
 7   X_7     1024 non-null   float32
 8   X_8     1024 non-null   float32
 9   X_9     1024 non-null   float32
dtypes: float32(10)
memory usage: 48.0 KB
            X_0       X_1       X_2  ...       X_7       X_8       X_9
index                                ...                              
0     -0.044962  1.210300  0.837871  ...  0.492410 -0.036524  0.927011
1     -0.899949  1.417506  0.234098  ...  0.201077  1.065277 -0.527426
2      0.210234  0.615278 -0.232967  ...  0.382822 -0.159713  0.429757
3      1.372308 -0.697183  1.020035  ...  0.162336 -0.034774 -1.017369
4      0.739356  0.040085 -0.293706  ...  1.367823 -0.883563  0.285353
...         ...       ...       ...  ...       ...       ...       ...
1019  -0.058483 -1.779904 -0.254862  ...  0.493898 -0.153581 -0.985507
1020   1.255606 -0.013681  0.449152  ...  0.622254  0.378835 -1.298635
1021  -0.089580  1.652395  2.166799  ... -0.581063  1.468157  0.495584
1022   0.068715  0.881708 -0.127262  ... -1.644819  0.086143  0.694782
1023  -0.813953 -0.452211 -1.339893  ... -0.620387  1.326070  0.079805

[1024 rows x 10 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1024 entries, 0 to 1023
Data columns (total 9 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   index          1024 non-null   int64  
 1   Score_0        1024 non-null   float64
 2   Proba_0        1024 non-null   float64
 3   LogProba_0     1024 non-null   float64
 4   Score_1        1024 non-null   float64
 5   Proba_1        1024 non-null   float64
 6   LogProba_1     1024 non-null   float64
 7   Decision       1024 non-null   int64  
 8   DecisionProba  1024 non-null   float64
dtypes: float64(7), int64(2)
memory usage: 72.1 KB
      index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0         0 -0.121209  0.439691  ...   -0.579266         1       0.560309
1         1  0.159772  0.579213  ...   -0.865628         0       0.579213
2         2  0.512493  0.735943  ...   -1.331589         0       0.735943
3         3 -0.224960  0.389380  ...   -0.493280         1       0.610620
4         4 -0.021372  0.489316  ...   -0.672004         1       0.510684
...     ...       ...       ...  ...         ...       ...            ...
1019   1019  0.025082  0.512539  ...   -0.718544         0       0.512539
1020   1020  0.056693  0.528316  ...   -0.751446         0       0.528316
1021   1021 -0.810354  0.165107  ...   -0.180452         1       0.834893
1022   1022  0.499681  0.730933  ...   -1.312795         0       0.730933
1023   1023  0.410096  0.694277  ...   -1.185076         0       0.694277

[1024 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
1008   1008 -0.037377     0.481320  ...    0.481320    0.518680            1
1009   1009  0.774781     0.824850  ...    0.824850    0.175150            0
1010   1010  0.387802     0.684732  ...    0.684732    0.315268            0
1011   1011 -0.527524     0.258257  ...    0.258257    0.741743            1
1012   1012  0.680270     0.795847  ...    0.795847    0.204153            0
1013   1013 -0.176751     0.412533  ...    0.412534    0.587466            1
1014   1014  0.679862     0.795715  ...    0.795715    0.204285            0
1015   1015 -0.290187     0.358847  ...    0.358847    0.641153            1
1016   1016 -0.443370     0.291783  ...    0.291783    0.708217            1
1017   1017 -0.418526     0.302156  ...    0.302156    0.697844            1
1018   1018 -0.163839     0.418806  ...    0.418806    0.581194            1
1019   1019  0.025082     0.512539  ...    0.512539    0.487461            0
1020   1020  0.056693     0.528316  ...    0.528316    0.471684            0
1021   1021 -0.810354     0.165107  ...    0.165108    0.834892            1
1022   1022  0.499681     0.730933  ...    0.730933    0.269067            0
1023   1023  0.410096     0.694277  ...    0.694277    0.305723            0

[16 rows x 12 columns]
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_0', 'SQL_Proba_0') 2.1288049706771688e-07
      Py_Proba_0  SQL_Proba_0   SQL_Error_0
1008    0.481320     0.481320  1.435766e-07
1009    0.824850     0.824850 -2.556475e-07
1010    0.684732     0.684732 -6.050377e-08
1011    0.258257     0.258257  4.831602e-07
1012    0.795847     0.795847 -4.566336e-08
1013    0.412534     0.412533  1.622337e-07
1014    0.795715     0.795715 -2.459393e-07
1015    0.358847     0.358847  3.759094e-07
1016    0.291783     0.291783  1.304412e-07
1017    0.302156     0.302156  1.863325e-07
1018    0.418806     0.418806  2.842304e-07
1019    0.512539     0.512539  2.763399e-07
1020    0.528316     0.528316  6.575223e-08
1021    0.165108     0.165107  3.314398e-07
1022    0.730933     0.730933 -6.842884e-09
1023    0.694277     0.694277 -1.487415e-07
MLLITE_CLASS_SQL_ERROR ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite') ('Py_Proba_1', 'SQL_Proba_1') 2.1336385294537866e-07
      Py_Proba_1  SQL_Proba_1   SQL_Error_1
1008    0.518680     0.518680 -1.435766e-07
1009    0.175150     0.175150  1.811417e-07
1010    0.315268     0.315268  9.030609e-08
1011    0.741743     0.741743 -5.129626e-07
1012    0.204153     0.204153  9.036684e-08
1013    0.587466     0.587467 -1.622337e-07
1014    0.204285     0.204285  2.310382e-07
1015    0.641153     0.641153 -4.355141e-07
1016    0.708217     0.708217 -1.602435e-07
1017    0.697844     0.697844 -1.863325e-07
1018    0.581194     0.581194 -3.140327e-07
1019    0.487461     0.487461 -2.763399e-07
1020    0.471684     0.471684 -1.253569e-07
1021    0.834892     0.834893 -3.314398e-07
1022    0.269067     0.269067 -5.276176e-08
1023    0.305723     0.305723  2.083462e-07
MLLITE_CLASS_SQL_EXECUTION_STATUS ('BinaryClass_10_original', 'RidgeClassifier', 'sqlite', 'Success')
      Py_Decision  SQL_Decision
1008            1             1
1009            0             0
1010            0             0
1011            1             1
1012            0             0
1013            1             1
1014            0             0
1015            1             1
1016            1             1
1017            1             1
1018            1             1
1019            0             0
1020            0             0
1021            1             1
1022            0             0
1023            0             0
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1_pgsql.sql'



SQL_OUT_PUT_FIRST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'pgsql')
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT t."index" AS "index",
   -0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0.009627 * t."X_7" + 0.025265 * t."X_8" + -0.006674 * t."X_9" ) AS "Score_0",
   CAST(NULL AS FLOAT) AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   0.5 * ( -0.013661 + 0.004375 * t."X_0" + 0.010529 * t."X_1" + 0.317227 * t."X_2" + 0.014715 * t."X_3" + -0.306301 * t."X_4" + 0.172503 * t."X_5" + 0.309628 * t."X_6" + -0
SQL_OUT_PUT_FIRST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'pgsql')
SQL_OUT_PUT_LAST_LINES_START ('BinaryClass_10_original', 'RidgeClassifier', 'pgsql')
"
  FROM
   "arg_max_cte_with_max_proba" AS t
),
arg_max_cte AS 
( SELECT t."index" as "index",
     t."Proba_0" AS "Proba_0",
     t."Score_0" AS "Score_0",
     t."Proba_1" AS "Proba_1",
     t."Score_1" AS "Score_1",
     t."Max_Proba" AS "Max_Proba",
     t."Max_Score" AS "Max_Score",
     COALESCE(  t."max_idx_0", t."max_idx_1" ) AS argmax_class_idx
   FROM
     "arg_max_cte_with_max_proba_idx" AS t
)
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."argmax_class_idx" AS "Decision",
  arg_max_cte."Max_Proba" AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END ('BinaryClass_10_original', 'RidgeClassifier', 'pgsql') 




COPY_TRAINING_DATA_TO_SQLITE_START
