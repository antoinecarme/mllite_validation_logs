           X_0       X_1       X_2  ...       X_8       X_9  target
0    -0.044962  1.210300  0.837871  ... -0.036524  0.927011       0
1    -0.899949  1.417506  0.234098  ...  1.065277 -0.527426       1
2     0.210234  0.615278 -0.232967  ... -0.159713  0.429757       0
3     1.372308 -0.697183  1.020035  ... -0.034774 -1.017369       1
4     0.739356  0.040085 -0.293706  ... -0.883563  0.285353       1
...        ...       ...       ...  ...       ...       ...     ...
1019 -0.058483 -1.779904 -0.254862  ... -0.153581 -0.985507       0
1020  1.255606 -0.013681  0.449152  ...  0.378835 -1.298635       1
1021 -0.089580  1.652395  2.166799  ...  1.468157  0.495584       1
1022  0.068715  0.881708 -0.127262  ...  0.086143  0.694782       0
1023 -0.813953 -0.452211 -1.339893  ...  1.326070  0.079805       0

[1024 rows x 11 columns]
MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
('OPERATION_START', 'TRAINING')
[[-0.04496161  1.2103002   0.83787066  0.0368216   0.9801959   0.28167102
   0.77735424  0.49240956 -0.03652414  0.927011  ]
 [-0.8999486   1.4175057   0.23409756  0.05489743  0.9185508  -0.756675
  -0.02763553  0.20107657  1.0652769  -0.5274255 ]
 [ 0.21023437  0.6152782  -0.23296675  2.4819782   1.2316058  -2.0273561
  -0.7873507   0.38282165 -0.15971345  0.42975688]
 [ 1.3723081  -0.69718254  1.0200353  -0.1598945   0.9574759   0.64849085
   1.0359191   0.16233616 -0.03477355 -1.0173686 ]
 [ 0.73935616  0.04008485 -0.29370642 -1.0730926  -0.6452065   0.2920823
  -0.1579546   1.3678225  -0.8835631   0.28535333]] [0 1 0 1 1]
MLLITE_FIT_USING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 1 4
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 3 4
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 1 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 2 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 3 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 4 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 5 6
PROGRESS_REPORT_ELAPSED_TOTAL 'CHOLESKY_SOLVER' 6 6
PROGRESS_REPORT_ELAPSED_TOTAL 'RIDGE_CLASSIFIER_FIT' 4 4
('OPERATION_END_ELAPSED', 0.012, 'TRAINING')
{ "alpha" : 0.0000001,   }
{ "alpha" : 0.0000001,   }
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013661,
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ]
		}
	}
}
WRITING_JSON_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1.json'

MLLITE_MODEL_SET_OPTIONS RidgeClassifier {"alpha" : 0.0000001}
MLLITE_MODEL_OPTIONS_DEFAULT RidgeClassifier { }
MLLITE_MODEL_OPTIONS_AFTER_SETTING RidgeClassifier { "alpha" : 0.0000001,   }
MLLITE_MODEL_JSON_AFTER_SETTING RidgeClassifier None
MLLITE_RELOADING_MODEL mllite_ridge_class.RidgeClassifier_ff4_il8
{
	"metadata" : { "model" : "Tikhonov_Ridge", "version" : "2024-W12", "signature" : "ff4_il8"},
	"options" : { "alpha" : 0.000000, "random_state" : 1789 },
	"dataset" : { "dataset_rows" : 1024, "dataset_features" : 10 },
	"classes" : [ 0, 1 ],
	"equations" : {
		"class_1" : {
			"intercept" : -0.013661,
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ]
		}
	}
}
BEAUTIFIED_JSON_START
{
	"classes" : [ 0, 1 ],
	"dataset" : 	{
		"dataset_features" : 10,
		"dataset_rows" : 1024
	},
	"equations" : 	{
		"class_1" : 	{
			"coeffs" : [ 0.004375, 0.010529, 0.317227, 0.014715, -0.306301, 0.172503, 0.309628, -0.009627, 0.025265, -0.006674 ],
			"intercept" : -0.013661
		}
	},
	"metadata" :  { "model" : "Tikhonov_Ridge", "signature" : "ff4_il8", "version" : "2024-W12" },
	"options" :  { "alpha" : 0.0, "random_state" : 1789 }
}
BEAUTIFIED_JSON_END
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
('OPERATION_START', 'PREDICT')
('OPERATION_END_ELAPSED', 0.0, 'PREDICT')
[[0.3811 0.6189]
 [0.6545 0.3455]
 [0.8859 0.1141]
 ...
 [0.0376 0.9624]
 [0.8807 0.1193]
 [0.8376 0.1624]]
(1024, 2)
(1024,) float32
MODEL_PERFS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_original', 'size': 1024, 'accuracy': 0.8515625, 'auc': 0.9300784409480063}
WRITING_PERF_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1.perf'

MODEL_PERFS_TIMINGS {'class_name': 'mllite.RidgeClassifier', 'model_name': 'RidgeClassifier', 'options': '{"alpha" : 0.0000001}', 'dataset': 'BinaryClass_10_original', 'training_time_in_sec': 0.012, 'prediction_time_in_sec': 0.0}
WRITING_SQL_CODE 'logs/auto_tests/classification/RidgeClassifier/mllite.RidgeClassifier_BinaryClass_10_original_option_1.sql'



SQL_OUT_PUT_FIRST_LINES_START
WITH model_input AS 
 (SELECT "ADS"."index" AS "index",
    CAST("ADS"."X_0" AS FLOAT) AS "X_0", CAST("ADS"."X_1" AS FLOAT) AS "X_1", CAST("ADS"."X_2" AS FLOAT) AS "X_2", CAST("ADS"."X_3" AS FLOAT) AS "X_3", CAST("ADS"."X_4" AS FLOAT) AS "X_4", CAST("ADS"."X_5" AS FLOAT) AS "X_5", CAST("ADS"."X_6" AS FLOAT) AS "X_6", CAST("ADS"."X_7" AS FLOAT) AS "X_7", CAST("ADS"."X_8" AS FLOAT) AS "X_8", CAST("ADS"."X_9" AS FLOAT) AS "X_9"
  FROM "MLLITE_INPUT_TABLE" AS "ADS" 
 ),
model_scores_cte AS 
 (SELECT model_input."index" AS "index",
   -0.013661 + 0.004375 * X_0 + 0.010529 * X_1 + 0.317227 * X_2 + 0.014715 * X_3 + -0.306301 * X_4 + 0.172503 * X_5 + 0.309628 * X_6 + -0.009627 * X_7 + 0.025265 * X_8 + -0.006674 * X_9 AS "Score_1", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_1"
  FROM model_input
 )
,
soft_max_orig_cte AS 
 (SELECT t."index" AS "index", 
   -t."Score_1" AS "Score_0",
   1.0 - t."Proba_1" AS "Proba_0",
   CAST(NULL AS FLOAT) AS "LogProba_0",
   t."Score_1" AS "Score_1",
   t."Pro
SQL_OUT_PUT_FIRST_LINES_END
SQL_OUT_PUT_LAST_LINES_START
ax."index" AS "index_Score",
     max(union_with_max.class) AS "arg_max_Score"
    FROM union_with_max
    WHERE union_with_max."max_Score" <= union_with_max."Score"
    GROUP BY union_with_max."index"
   ) AS "arg_max_t_Score"
   ON score_max."index" = "arg_max_t_Score"."index_Score"
 )
SELECT arg_max_cte."index" AS "index",
  arg_max_cte."Score_0" AS "Score_0",
  arg_max_cte."Proba_0" AS "Proba_0",
  CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN LN( arg_max_cte."Proba_0" ) ELSE -1.79769313486231e+308 END AS "LogProba_0",
  arg_max_cte."Score_1" AS "Score_1",
  arg_max_cte."Proba_1" AS "Proba_1",
  CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN LN( arg_max_cte."Proba_1" ) ELSE -1.79769313486231e+308 END AS "LogProba_1",
  arg_max_cte."arg_max_Score" AS "Decision",
  CASE
   WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0"
   WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1"
 END AS "DecisionProba"
FROM arg_max_cte
SQL_OUT_PUT_LAST_LINES_END




COPY_TRAINING_DATA_TO_SQLITE_START
           X_0       X_1       X_2  ...       X_8       X_9   KEY
0    -0.044962  1.210300  0.837871  ... -0.036524  0.927011     0
1    -0.899949  1.417506  0.234098  ...  1.065277 -0.527426     1
2     0.210234  0.615278 -0.232967  ... -0.159713  0.429757     2
3     1.372308 -0.697183  1.020035  ... -0.034774 -1.017369     3
4     0.739356  0.040085 -0.293706  ... -0.883563  0.285353     4
...        ...       ...       ...  ...       ...       ...   ...
1019 -0.058483 -1.779904 -0.254862  ... -0.153581 -0.985507  1019
1020  1.255606 -0.013681  0.449152  ...  0.378835 -1.298635  1020
1021 -0.089580  1.652395  2.166799  ...  1.468157  0.495584  1021
1022  0.068715  0.881708 -0.127262  ...  0.086143  0.694782  1022
1023 -0.813953 -0.452211 -1.339893  ...  1.326070  0.079805  1023

[1024 rows x 11 columns]
COPY_TRAINING_DATA_TO_SQLITE_END


PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_START
      index   Score_0   Proba_0  ...  LogProba_1  Decision  DecisionProba
0         0 -0.242417  0.381111  ...   -0.479830         1       0.618889
1         1  0.319543  0.654547  ...   -1.062899         0       0.654547
2         2  1.024986  0.885945  ...   -2.171072         0       0.885945
3         3 -0.449921  0.289083  ...   -0.341200         1       0.710917
4         4 -0.042743  0.478641  ...   -0.651317         1       0.521359
...     ...       ...       ...  ...         ...       ...            ...
1019   1019  0.050165  0.525061  ...   -0.744569         0       0.525061
1020   1020  0.113385  0.556451  ...   -0.812947         0       0.556451
1021   1021 -1.620708  0.037637  ...   -0.038363         1       0.962363
1022   1022  0.999362  0.880663  ...   -2.125804         0       0.880663
1023   1023  0.820191  0.837587  ...   -1.817613         0       0.837587

[1024 rows x 9 columns]
PREDICT_MODEL_ON_TRAINING_DATA_INSIDE_SQLITE_END


COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_START
Index(['index', 'Score_0', 'Proba_0', 'LogProba_0', 'Score_1', 'Proba_1',
       'LogProba_1', 'Decision', 'DecisionProba'],
      dtype='object')
      index   Score_0  SQL_Proba_0  ...  Py_Proba_0  Py_Proba_1  Py_Decision
1008   1008 -0.074754     0.462692  ...    0.462693    0.537307            1
1009   1009  1.549562     0.956857  ...    0.956856    0.043144            0
1010   1010  0.775604     0.825088  ...    0.825088    0.174912            0
1011   1011 -1.055048     0.108119  ...    0.108120    0.891880            1
1012   1012  1.360540     0.938259  ...    0.938259    0.061741            0
1013   1013 -0.353502     0.330261  ...    0.330261    0.669739            1
1014   1014  1.359725     0.938165  ...    0.938164    0.061836            0
1015   1015 -0.580374     0.238531  ...    0.238532    0.761468            1
1016   1016 -0.886740     0.145110  ...    0.145110    0.854890            1
1017   1017 -0.837053     0.157878  ...    0.157878    0.842122            1
1018   1018 -0.327678     0.341784  ...    0.341784    0.658216            1
1019   1019  0.050165     0.525061  ...    0.525062    0.474938            0
1020   1020  0.113385     0.556451  ...    0.556451    0.443549            0
1021   1021 -1.620708     0.037637  ...    0.037637    0.962363            1
1022   1022  0.999362     0.880663  ...    0.880663    0.119337            0
1023   1023  0.820191     0.837587  ...    0.837587    0.162413            0

[16 rows x 12 columns]
COMPARE_SQL_OUTPUT_AND_PYTHON_OUTPUT_END
